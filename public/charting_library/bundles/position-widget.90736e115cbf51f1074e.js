(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[8751],{978251:e=>{e.exports={dialog:"dialog-YZ_qHmON",dialogBody:"dialogBody-YZ_qHmON"}},2475:e=>{e.exports={positionInfo:"positionInfo-oWbWR7tt",title:"title-oWbWR7tt",contentWrapper:"contentWrapper-oWbWR7tt"}},925940:e=>{e.exports={positionPanel:"positionPanel-vffbLvO_"}},35370:e=>{e.exports={positionWidget:"positionWidget-mbUCea4m",separator:"separator-mbUCea4m",brackets:"brackets-mbUCea4m",customFieldsWrapper:"customFieldsWrapper-mbUCea4m",warning:"warning-mbUCea4m",button:"button-mbUCea4m",divider:"divider-mbUCea4m"}},22e3:(e,o,t)=>{"use strict";t.r(o),t.d(o,{closePositionDialog:()=>z,mountPositionPanel:()=>_,showPositionDialog:()=>A,showPositionDrawer:()=>L,unmountPositionPanel:()=>q});var n=t(50959),a=t(632227),l=t(801808),i=t(930894),s=t(533408),r=t(601227),d=t(180185),c=t(918460),m=t(584811),u=t(671945),p=t(650151),b=t(28156),f=t(728232),C=t(570446),g=t(363111),v=t(661851),E=t(204926),w=t(2475);function O(e){const{model:o}=e,t=(0,v.useObservable)(o.infoTableData$,{rows:[]});return n.createElement("div",{className:w.positionInfo},n.createElement("div",{className:w.title},o.title()),n.createElement("div",{className:w.contentWrapper},n.createElement(E.InfoTable,{rows:t.rows,header:t.header,disabled:!1})))}var h=t(556013),P=t(763281),D=t(35370);const M=(0,u.getLogger)("Trading.OrderPanel");function k(e){const{model:o,focus:t,shouldShowActionButton:a}=e,l=(0,n.useRef)(null),i=(0,v.useObservable)(o.warning$),{mode:s}=(0,n.useContext)(P.WidgetContext);(0,n.useEffect)((()=>{null!==l.current&&void 0===t&&l.current.focus()}),[]);const u=(0,n.useCallback)((e=>{const t=(0,d.hashFromEvent)(e);13!==t&&t!==d.hashShiftPlusEnter||o.isButtonDisabled()||(r.CheckMobile.any()?document.activeElement instanceof HTMLElement?document.activeElement.blur():M.logWarn("Failed to deselect: active element is not HTMLElement"):o.doneButtonClick())}),[o]),E=o.customFieldsModel.getCustomFieldsModels(),w=function(e,o){return o===g.OrderEditorDisplayMode.Panel&&null!==e.positionInfoModel&&e.positionInfoModel.getOrderInfoTableRowsCount()>0}(o,s);return n.createElement("div",{className:D.positionWidget,onKeyDown:u,tabIndex:-1,ref:l},(s===g.OrderEditorDisplayMode.Popup||s===g.OrderEditorDisplayMode.ResizableDrawer)&&n.createElement(b.HeaderContainer,{...o.headerStateValue}),n.createElement(m.Divider,{className:D.divider,size:"xsmall"}),n.createElement("div",{className:D.brackets},n.createElement(f.BracketControlGroup,{model:o,focus:t})),E.length>0&&n.createElement("div",{className:D.customFieldsWrapper},n.createElement(h.OrderPanelCustomFields,{customFieldModels:E})),i&&n.createElement(c.Informer,{className:D.warning,content:i,informerIntent:"default"}),w&&n.createElement("div",null,n.createElement(O,{"data-name":"position-info",model:(0,p.ensureNotNull)(o.positionInfoModel)})),void 0!==o.buttonModel&&a&&n.createElement("div",{className:D.button},n.createElement(C.PlaceAndModifyButton,{model:o,buttonModel:o.buttonModel})))}var W=t(274837),B=t(978251);const N=n.memo((e=>{
const{model:o,isOpened:t,focus:a,onOpen:l,onClose:r}=e;return(0,W.useCommonDialogHandlers)({isOpened:t,onOpen:l,onClose:r}),n.createElement(s.AdaptivePopupDialog,{className:B.dialog,isOpened:t,dataName:"position-dialog-popup",render:function(){return n.createElement(i.Body,{className:B.dialogBody},n.createElement(k,{key:o.id,model:o,focus:a,shouldShowActionButton:!0}))},onClose:()=>r?.()})}));var $=t(910549),F=t(977540),y=t(110686);const R=n.memo((e=>{const{model:o,isOpened:t,focus:a,onOpen:l,onClose:i,forceCollapsedPositionDrawer:s=!1}=e;return(0,W.useCommonDialogHandlers)({isOpened:t,onOpen:l,onClose:i}),n.createElement(F.ResizableDrawer,{controlsContent:n.createElement(y.OrderDrawerControlContent,{buttonModel:o.buttonModel,onClose:i,side:()=>o.side(),isButtonDisabled$:o.isButtonDisabled$,isButtonDisabled:()=>o.isButtonDisabled(),loading$:o.loading$,doneButtonClick:()=>o.doneButtonClick()}),disableSwipe:!1,disablePan:!1,contentHeight:s?F.ResizableDrawerContentHeight.Collapsed:F.ResizableDrawerContentHeight.Full},n.createElement($.PopupContext.Consumer,null,(()=>n.createElement(k,{model:o,key:o.id,focus:a,shouldShowActionButton:!1}))))}));var I=t(925940);function H(e){return n.createElement("div",{"data-name":"position-panel",className:I.positionPanel},n.createElement(k,{key:e.model.id,...e,shouldShowActionButton:!0}))}var S=t(157129);let x=null,T=null;function A(e){const{viewModel:o,settings$:t,mode:a,focus:l,onClose:i,onOpen:s}=e,r=n.createElement(P.OrderTicketProvider,{settings$:t,mode:a,orderPanelStatus$:o.status$,isFractional:o.isFractional},n.createElement(N,{model:o,isOpened:!0,focus:l,onOpen:s,onClose:()=>z(i)}));T?T.render(r):(x=document.createElement("div"),document.body.appendChild(x),T=(0,S.createReactRoot)(r,x))}const U="position-drawer-widget";function z(e){x&&(document.body.removeChild(x),x=null),T?.unmount(),T=null;(0,l.getRootOverlapManager)().removeWindow(U),e?.()}function L(e){const{viewModel:o,settings$:t,mode:a,focus:i,onClose:s,onOpen:r,forceCollapsedPositionDrawer:d}=e,c=(0,l.getRootOverlapManager)().ensureWindow(U),m=n.createElement(P.OrderTicketProvider,{settings$:t,mode:a,orderPanelStatus$:o.status$,isFractional:o.isFractional},n.createElement(R,{model:o,isOpened:!0,focus:i,onOpen:r,onClose:()=>z(s),forceCollapsedPositionDrawer:d}));T?T.render(m):T=(0,S.createReactRoot)(m,c)}function _(e,o,t,l,i){a.render(n.createElement(P.OrderTicketProvider,{settings$:o,mode:t,orderPanelStatus$:e.status$,isFractional:e.isFractional},n.createElement(H,{model:e,focus:i})),l)}function q(e){a.unmountComponentAtNode(e)}}}]);