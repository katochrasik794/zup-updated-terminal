(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[7502],{43681:e=>{e.exports={wrap:"wrap-Un5MtNUE",list:"list-Un5MtNUE",item:"item-Un5MtNUE",selected:"selected-Un5MtNUE",bluishItem:"bluishItem-Un5MtNUE",noPadding:"noPadding-Un5MtNUE"}},210162:e=>{e.exports={badge:"badge-PlSmolIm",hasChildren:"hasChildren-PlSmolIm",content:"content-PlSmolIm",slot:"slot-PlSmolIm",xsmall:"xsmall-PlSmolIm",small:"small-PlSmolIm",medium:"medium-PlSmolIm",large:"large-PlSmolIm",xlarge:"xlarge-PlSmolIm",xxlarge:"xxlarge-PlSmolIm"}},459110:e=>{e.exports={list:"list-mpa2WWtU",item:"item-mpa2WWtU",selected:"selected-mpa2WWtU",title:"title-mpa2WWtU",label:"label-mpa2WWtU",input:"input-mpa2WWtU",wait:"wait-mpa2WWtU"}},165550:e=>{e.exports={absolutePriceDropdownItem:"absolutePriceDropdownItem-QDwbzjCO",price:"price-QDwbzjCO",labelsGroup:"labelsGroup-QDwbzjCO"}},749160:e=>{e.exports={wrapper:"wrapper-Q0Xx72lJ",label:"label-Q0Xx72lJ",wait:"wait-Q0Xx72lJ",title:"title-Q0Xx72lJ",popupMenuItem:"popupMenuItem-Q0Xx72lJ",value:"value-Q0Xx72lJ"}},553238:e=>{e.exports={wrapper:"wrapper-RoaZjf69",title:"title-RoaZjf69",label:"label-RoaZjf69"}},932443:e=>{e.exports={dateTimeWrapper:"dateTimeWrapper-Dg2Jb5Mv",dateInputContainer:"dateInputContainer-Dg2Jb5Mv",dateInput:"dateInput-Dg2Jb5Mv"}},569327:e=>{e.exports={container:"container-JQC67cD9",leverageButton:"leverageButton-JQC67cD9",disabledLeverageButton:"disabledLeverageButton-JQC67cD9"}},116673:e=>{e.exports={hiddenLabel:"hiddenLabel-XFowpoet"}},49683:e=>{e.exports={dialog:"dialog-mAVKt9Z3",dialogBody:"dialogBody-mAVKt9Z3"}},656803:e=>{e.exports={orderInfo:"orderInfo-ZCVq_FIR",title:"title-ZCVq_FIR",contentWrapper:"contentWrapper-ZCVq_FIR",right:"right-ZCVq_FIR",disclaimer:"disclaimer-ZCVq_FIR",disclaimerLink:"disclaimerLink-ZCVq_FIR"}},674721:e=>{e.exports={panelContainer:"panelContainer-qPQHH_hi",orderPanel:"orderPanel-qPQHH_hi"}},595693:e=>{e.exports={scrollWrapper:"scrollWrapper-XYi0nst9",content:"content-XYi0nst9",separator:"separator-XYi0nst9",controls:"controls-XYi0nst9",informer:"informer-XYi0nst9"}},430019:e=>{e.exports={controlGroup:"controlGroup-HcMnXcBP",absolutePriceControl:"absolutePriceControl-HcMnXcBP",withRelative:"withRelative-HcMnXcBP",relativePriceControl:"relativePriceControl-HcMnXcBP"}},608628:e=>{e.exports={"min-order-ticket-height":"320px","min-order-info-height":"46px",orderWidget:"orderWidget-F15FKlrH",header:"header-F15FKlrH",side:"side-F15FKlrH",doneButton:"doneButton-F15FKlrH",customField:"customField-F15FKlrH",duration:"duration-F15FKlrH",customFieldsWrapper:"customFieldsWrapper-F15FKlrH",orderInfoWrapper:"orderInfoWrapper-F15FKlrH",resizeHandler:"resizeHandler-F15FKlrH",orderTicket:"orderTicket-F15FKlrH",topWrapper:"topWrapper-F15FKlrH",centerBlock:"centerBlock-F15FKlrH",centerBlockEditing:"centerBlockEditing-F15FKlrH","brackets-wrapper":"brackets-wrapper-F15FKlrH",brackets:"brackets-F15FKlrH",quantityWrapper:"quantityWrapper-F15FKlrH",leverage:"leverage-F15FKlrH",screenWithKeyholeIcon:"screenWithKeyholeIcon-F15FKlrH",
sadScreenIcon:"sadScreenIcon-F15FKlrH",launchReplayIcon:"launchReplayIcon-F15FKlrH",emptyStateBlockWrapper:"emptyStateBlockWrapper-F15FKlrH",scrollWrapper:"scrollWrapper-F15FKlrH",divider:"divider-F15FKlrH"}},340591:e=>{e.exports={priceLabel:"priceLabel-s5LgTmXf",ask:"ask-s5LgTmXf",bid:"bid-s5LgTmXf",last:"last-s5LgTmXf"}},89129:e=>{e.exports={progressBarContainer:"progressBarContainer-Zcxs1Uvi",marginsContainer:"marginsContainer-Zcxs1Uvi",margin:"margin-Zcxs1Uvi",titleContainer:"titleContainer-Zcxs1Uvi",title:"title-Zcxs1Uvi",price:"price-Zcxs1Uvi",availableMargin:"availableMargin-Zcxs1Uvi",progressBar:"progressBar-Zcxs1Uvi",track:"track-Zcxs1Uvi",progress:"progress-Zcxs1Uvi",exceededMargin:"exceededMargin-Zcxs1Uvi",wait:"wait-Zcxs1Uvi"}},55799:e=>{e.exports={controlGroup:"controlGroup-jhgU4iCE",orderSizeCalculator:"orderSizeCalculator-jhgU4iCE",title:"title-jhgU4iCE",label:"label-jhgU4iCE",hidden:"hidden-jhgU4iCE",wait:"wait-jhgU4iCE",units:"units-jhgU4iCE",calculatorIcon:"calculatorIcon-jhgU4iCE",isOpened:"isOpened-jhgU4iCE"}},300021:e=>{e.exports={calculator:"calculator-vLRZh3q9",calculatorWithInput:"calculatorWithInput-vLRZh3q9",input:"input-vLRZh3q9",buttonsWrapper:"buttonsWrapper-vLRZh3q9",buttonWithOperation:"buttonWithOperation-vLRZh3q9",buttonIcon:"buttonIcon-vLRZh3q9"}},18365:e=>{e.exports={menuBox:"menuBox-rm7KgfIT"}},589756:e=>{e.exports={dropdown:"dropdown-Ep8u3tCS",hidden:"hidden-Ep8u3tCS",popupMenuItem:"popupMenuItem-Ep8u3tCS",labelWrapper:"labelWrapper-Ep8u3tCS",toolbox:"toolbox-Ep8u3tCS",active:"active-Ep8u3tCS"}},376491:e=>{e.exports={openButton:"openButton-oAJwOoJe",iconWrapper:"iconWrapper-oAJwOoJe",openIcon:"openIcon-oAJwOoJe",wait:"wait-oAJwOoJe",opened:"opened-oAJwOoJe",list:"list-oAJwOoJe",item:"item-oAJwOoJe",selected:"selected-oAJwOoJe",title:"title-oAJwOoJe",label:"label-oAJwOoJe",input:"input-oAJwOoJe"}},890497:e=>{e.exports={relativePriceDropdownItem:"relativePriceDropdownItem-L1mdgTgI",price:"price-L1mdgTgI"}},174884:e=>{e.exports={restrictions:"restrictions-kbYnGQgu",restriction:"restriction-kbYnGQgu",hardToBorrow:"hardToBorrow-kbYnGQgu",halted:"halted-kbYnGQgu"}},758304:e=>{e.exports={restrictions:"restrictions-B5GOsH7j",smallPaddings:"smallPaddings-B5GOsH7j",sideControl:"sideControl-B5GOsH7j",sell:"sell-B5GOsH7j",active:"active-B5GOsH7j",buy:"buy-B5GOsH7j",section:"section-B5GOsH7j",title:"title-B5GOsH7j",typeSide:"typeSide-B5GOsH7j",value:"value-B5GOsH7j",valueNoData:"valueNoData-B5GOsH7j",spread:"spread-B5GOsH7j",raisedTop:"raisedTop-B5GOsH7j",disable:"disable-B5GOsH7j"}},598189:e=>{e.exports={tabsContainer:"tabsContainer-zC5M0yfs"}},74968:e=>{e.exports={informer:"informer-iBPUmjfh"}},21923:e=>{e.exports={wrapper:"wrapper-eYAfVbpw"}},536408:e=>{e.exports={wrap:"wrap-ne5qGlZh",icon:"icon-ne5qGlZh",text:"text-ne5qGlZh",disabled:"disabled-ne5qGlZh"}},817921:e=>{e.exports={container:"container-Tv7LSjUz",overlayScrollWrap:"overlayScrollWrap-Tv7LSjUz",wrapper:"wrapper-Tv7LSjUz"}},209087:e=>{e.exports={container:"container-HTBJo9ba",top:"top-HTBJo9ba"}},737953:e=>{e.exports={
list:"list-HGwPo2aR",item:"item-HGwPo2aR"}},657947:(e,t,r)=>{"use strict";r.d(t,{DurationControl:()=>b});var o=r(609838),n=r(50959),s=r(721717),i=r(760775),a=r(472488),l=r(930202),c=r(44807),u=r(508550),d=r(614793),p=r(932443);function h(e){const{initDateTime:t,onDateSelect:r,onTimeSelect:o,onControlFocused:s,hasDatePicker:i,hasTimePicker:a,showErrorMessages:h,revertInvalidData:m,keepFocusOnKeyBoardTimeNavigation:v,error:f,openTimePopupByFocus:g,onError:b}=e;if((0,n.useEffect)((()=>()=>b?.({res:!1})),[]),!i&&!a)return n.createElement(n.Fragment,null);const E=()=>{s?.()};return n.createElement("div",{className:p.dateTimeWrapper,onKeyDown:e=>{13===(0,l.hashFromEvent)(e)&&e.stopPropagation()}},i&&n.createElement(d.DatePicker,{name:"duration-date-input",containerClassName:p.dateInputContainer,className:p.dateInput,initial:t,onPick:e=>{r(e)},onFocus:E,showErrorMessages:h,revertInvalidData:m,showOnFocus:!1,errors:f&&f.res&&f.msg?[f.msg]:void 0}),a&&n.createElement(c.TimeInput,{name:"duration-time-input",value:(C=t,(0,u.twoDigitsFormat)(C.getHours())+":"+(0,u.twoDigitsFormat)(C.getMinutes())),onChange:e=>{o(function(e){const[t,r]=e.split(":"),o=new Date;return o.setHours(Number(t),Number(r)),o}(e))},onFocus:E,showErrorMessages:h,keepFocusOnKeyBoardNavigation:v,openPopupByFocus:g}));var C}var m=r(553238);function v(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),t.getHours(),t.getMinutes()).getTime()}const f="duration-select-input",g=o.t(null,void 0,r(383870));function b(e){const{currentDuration:t,durationMetaInfoList:l,onDurationChanged:c,onControlFocused:u,showErrorMessages:d,revertInvalidData:p,onError:b,error:E}=e,[C,y]=(0,n.useState)(t.datetime),S=(0,i.findDurationMetaInfo)(l,t.type);(0,n.useEffect)((()=>{if(void 0===u)return;const e=document.getElementById(f);return e?.addEventListener("focus",u),()=>e?.removeEventListener("focus",u)}),[u]);const w=(0,n.useMemo)((()=>E?.res&&void 0!==C?new Date(C):E?.res||void 0===t.datetime?["GTT","GTD"].includes(t.type)?(0,i.makeDatePlus24UTCHours)():new Date:new Date(t.datetime)),[t.datetime,t.type,C,E]);(0,n.useEffect)((()=>{(S?.hasTimePicker&&w.getTime()<=Date.now()||!S?.hasTimePicker&&w.getTime()<(new Date).setHours(0,0,0,0))&&P({type:e.currentDuration.type,datetime:(0,i.makeDatePlus24UTCHours)().getTime()})}),[]);const _=(0,n.useMemo)((()=>l.map((e=>({title:e.name,value:e.value})))),[l]);if(void 0===S)return n.createElement(n.Fragment,null);const k=_.length<2;return n.createElement("div",{className:m.wrapper},n.createElement("div",{className:m.title},n.createElement(a.Label,{htmlFor:f,className:m.label},o.t(null,void 0,r(296344)))),n.createElement(s.Select,{anchorButtonId:f,value:S?.value,items:_,disabled:k,onChange:function(r){const o={type:r},n=(0,i.findDurationMetaInfo)(l,r);void 0!==n&&(n.hasDatePicker||n.hasTimePicker)&&(o.datetime=t.datetime||(0,i.getTimestamp)((0,i.makeDatePlus24UTCHours)()));P(o),void 0!==e.onClose&&e.onClose()},anchorButtonSize:"small",stretch:!0}),n.createElement(h,{initDateTime:w,hasDatePicker:S.hasDatePicker,
hasTimePicker:S.hasTimePicker,onControlFocused:u,onDateSelect:function(t){if(null===t)return void b?.({res:!0});const r=v(t,w);if(y(r),S?.hasTimePicker&&r<=Date.now()||!S?.hasTimePicker&&r<(new Date).setHours(0,0,0,0))return void b?.({res:!0,msg:g});P({type:e.currentDuration.type,datetime:r})},onTimeSelect:function(t){const r=v(w,t);if(y(r),r<=Date.now())return void b?.({res:!0,msg:g});P({type:e.currentDuration.type,datetime:r})},revertInvalidData:p,showErrorMessages:d,onError:b,keepFocusOnKeyBoardTimeNavigation:!0,error:E,openTimePopupByFocus:!1}));function P(e){b?.({res:!1}),c(e)}}},729354:(e,t,r)=>{"use strict";r.d(t,{QuantityInput:()=>m});var o=r(50959),n=r(609838),s=r(463039),i=r(514970);var a=r(587125),l=r(441219),c=r(621363),u=r(209957),d=r(773743),p=r(760775),h=r(116673);function m(e){const{id:t,qty:m,quantityMetainfo:v,onValueChange:f,className:g,customTitle:b,hasLotSize:E,dataQaId:C,onClick:y,inputReference:S,hideLabel:w,button:_,customErrorsAttachment:k,replaceDivider:P}=e,{error:O,errorMessage:T,setError:D,setErrorMessage:M,handleInputError:I}=function(e,t){const[r,n]=(0,o.useState)(!1),[s,a]=(0,o.useState)(void 0),[l,c]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{const{res:r,msg:o}=(0,i.checkQtyError)(t,e,!0),s=l?void 0:o;n(l||r),a(s)}),[e,t,l]),{error:r,errorMessage:s,setError:n,setErrorMessage:a,handleInputError:e=>{c(e)}}}(m,v),N=(0,o.useMemo)((()=>(0,l.numberFormattersParsersChain)({chain:[(0,c.prohibitNanOnParseStep)(),(0,u.decimalNumberMagnitudeStep)({standardNotationOnly:!0}),(0,d.signumStep)({negativeSign:d.longMinusSign})]},{ignoreLocaleNumberFormat:!0,noExponentialForm:!0})),[v]),x=b??(E?n.t(null,void 0,r(833526)):n.t(null,void 0,r(715432)));return o.createElement(o.Fragment,null,o.createElement(s.Label,{className:w&&h.hiddenLabel,htmlFor:t},x),o.createElement(a.NumberInput,{...v,button:_,id:t,className:g,value:(0,p.applyRounding)(m,N),onValueChange:e=>{const{res:t,msg:r}=(0,i.checkQtyError)(v,e,!0);t||f(e),D(t),M(r)},error:O,errorMessage:T,errorHandler:I,onBlur:()=>{D(!1),M(void 0)},onClick:y,inputReference:S,useFormatter:!1,mode:"float",customErrorsAttachment:k,inputMode:"decimal",replaceDivider:P,dataQaId:C}))}},129018:(e,t,r)=>{"use strict";r.d(t,{QuantityCalculator:()=>O});var o=r(50959),n=r(960521),s=r(624216),i=r(510618),a=r(493173),l=r(523090),c=r(609838),u=r(497754),d=r.n(u),p=r(926032),h=r(180185),m=r(878112),v=r(380327),f=r(729354),g=r(600297),b=r(218666),E=r(96634),C=r(115589),y=r(672197),S=r(300021);const w={isGrouped:!1,cellState:{isTop:!1,isRight:!1,isBottom:!1,isLeft:!1}};function _(e){const{min:t,max:n,step:s,uiStep:i,reference:a,withInput:l,valueInput:u,onChangeValueInput:_,onClick:k,onClose:P,onInputClick:O,replaceDivider:T}=e,D=(0,o.useRef)(null),M=(0,o.useRef)(null),I=(0,o.useRef)(null),N={min:t,max:n,step:s,uiStep:i};function x(e,t){D.current?.blur(),k(e,t)}return(0,o.useEffect)((()=>{const e=setTimeout((()=>{if(D.current)return D.current.focus(),void(D.current.selectionStart=D.current.value.length);I.current?.focus()}),0);return M.current=(0,p.createGroup)({
desc:"Qty calculator"}),M.current?.add({desc:"Press Enter in qty calculator",hotkey:13,handler:P}),()=>{clearTimeout(e),M.current?.destroy(),M.current=null}}),[]),o.createElement("div",{className:d()(S.calculator,l&&S.calculatorWithInput),tabIndex:-1,ref:a,onKeyDown:e=>{13!==(0,h.hashFromEvent)(e)&&27!==(0,h.hashFromEvent)(e)||(e.preventDefault(),e.stopPropagation(),P())}},l&&o.createElement(f.QuantityInput,{id:"calculator-input",qty:u,quantityMetainfo:N,className:S.input,customTitle:c.t(null,void 0,r(598721)),onValueChange:_,onClick:O,inputReference:e=>D.current=e,replaceDivider:T}),o.createElement(v.ControlGroupContext.Provider,{value:w},o.createElement("div",{className:S.buttonsWrapper},o.createElement(g.Button,{reference:I,value:-s,buttonType:g.ButtonType.IncDec,icon:o.createElement(m.Icon,{className:S.buttonIcon,icon:E}),onClick:x,className:S.buttonWithOperation}),o.createElement(g.Button,{value:s,buttonType:g.ButtonType.IncDec,icon:o.createElement(m.Icon,{className:S.buttonIcon,icon:b}),onClick:x,className:S.buttonWithOperation}),o.createElement(g.Button,{value:1,buttonType:g.ButtonType.PlusValue,onClick:x}),o.createElement(g.Button,{value:5,buttonType:g.ButtonType.PlusValue,onClick:x}),o.createElement(g.Button,{value:25,buttonType:g.ButtonType.PlusValue,onClick:x}),o.createElement(g.Button,{value:100,buttonType:g.ButtonType.PlusValue,onClick:x}),o.createElement(g.Button,{value:500,buttonType:g.ButtonType.PlusValue,onClick:x}),o.createElement(g.Button,{value:1e3,buttonType:g.ButtonType.PlusValue,onClick:x}),o.createElement(g.Button,{value:0,buttonType:g.ButtonType.Clear,icon:o.createElement(m.Icon,{className:S.buttonIcon,icon:C}),onClick:x}),o.createElement(g.Button,{value:t||s,buttonType:g.ButtonType.Default,icon:o.createElement(m.Icon,{className:S.buttonIcon,icon:y}),onClick:x}))))}var k=r(18365);const P=(0,a.mergeThemes)(i.DEFAULT_MENU_THEME,{menuBox:k.menuBox});class O extends o.PureComponent{constructor(e){super(e),this._setCalcRef=e=>{this.props.calcReference&&this.props.calcReference(e)},this._calculatorStepHandler=(e,t)=>{const{min:r,max:o,uiStep:s,trackEventTarget:i,trackEvent:a}=this.props;if(void 0!==a&&void 0!==i&&a(i,"Calculator Button",(0,l.prepareCalculatorEventText)(e,t)),t===g.ButtonType.Clear||t===g.ButtonType.Default)return this._updateValueByCalc(e);const c=this.props.valueGetter();if(null===c)return;let u=Number((0,n.Big)(c).plus(e));if((u<r||o<u)&&t!==g.ButtonType.IncDec)return this._updateValueByCalc(c);if(t===g.ButtonType.IncDec){if(u=this._calcByStep(c,e,r,s),o<u)return this._updateValueByCalc(o);if(u<r)return this._updateValueByCalc(r)}return this._updateValueByCalc(u)},this._updateValueByCalc=e=>{this._handlerValueInput(e),this.props.onValueChange(e,!0),void 0!==this.props.errorHandler&&this.props.errorHandler(!1),this.props.calculatorUsedStat&&this.props.calculatorUsedStat(),this.props.onFocus?.()},this._onInputClick=()=>{const{trackEventTarget:e,trackEvent:t}=this.props;void 0!==t&&void 0!==e&&t(e,"Calculator Input","Quantity input field")},this.state={valueInput:e.valueGetter()},
this._handlerValueInput=this._handlerValueInput.bind(this)}render(){const{min:e,max:t,step:r,uiStep:n,withInput:i,targetEl:a,position:l,onClose:c,onClickOutside:u,onKeyboardClose:d,closeOnClickOutside:p}=this.props;return o.createElement(s.PopupMenu,{isOpened:!0,onClose:c,onClickOutside:u,onKeyboardClose:d,position:l,doNotCloseOn:a,theme:P,closeOnClickOutside:p},o.createElement(_,{min:e,max:t,step:r,uiStep:n,withInput:i,reference:this._setCalcRef,valueInput:this.state.valueInput,onChangeValueInput:this._updateValueByCalc,onClick:this._calculatorStepHandler,onClose:c,onInputClick:this._onInputClick,replaceDivider:void 0}))}_calcByStep(e,t,r,o){const s=Math.sign(t),i=Math.abs(o??t),a=new n.Big(e),l=a.minus(r).mod(t);let c=a.plus(s*i);return l.eq(0)||(c=c.plus((s>0?0:1)*i).minus(l)),c.toNumber()}_handlerValueInput(e){this.setState({valueInput:e})}}},383778:(e,t,r)=>{"use strict";r.d(t,{TradingPanelWarningInformersContainer:()=>h});var o=r(50959),n=r(209185),s=r(586639),i=r(609838),a=r(918460);const l=e=>{const[t,r]=(0,o.useState)(e);return[t,(0,o.useCallback)((()=>r(!1)),[]),(0,o.useCallback)((()=>r(!0)),[])]};var c=r(661851),u=r(74968);function d(e){const{warningMessageSource:t,isCloseButtonShown:d=!0}=e,[p,h]=(0,o.useState)(),[m,v,f]=l(!0),g=(0,o.useCallback)((e=>{h(e),f()}),[]),b=(0,o.useMemo)((()=>(0,n.isObservable)(t)?t:(0,s.of)(t)),[t]);return(0,c.useObservableSubscription)(b,g),m&&void 0!==p&&""!==p?o.createElement(a.Informer,{content:p,header:i.t(null,void 0,r(392298)),informerIntent:"warning",isCloseButtonShown:d,className:u.informer,onCloseClick:v}):o.createElement(o.Fragment,null)}var p=r(21923);function h(e){const{warningInformersItems:t}=e;return 0===t.length?o.createElement(o.Fragment,null):o.createElement("div",{className:p.wrapper},t.map((e=>o.createElement(d,{key:e.id,...e}))))}},27950:(e,t,r)=>{"use strict";r.d(t,{EditButton:()=>l});var o=r(50959),n=r(497754),s=r(878112),i=r(610600),a=r(536408);function l(e){const{value:t,onClick:r,className:l,startSlot:c,disabled:u=!1}=e;return o.createElement("div",{className:n(a.wrap,u&&a.disabled,l),onClick:r,"data-name":"edit-button"},o.createElement("div",{className:n(a.text,"apply-overflow-tooltip")},void 0!==c&&c,o.createElement("span",null,t)),o.createElement(s.Icon,{icon:i,className:a.icon}))}},438980:(e,t,r)=>{"use strict";r.d(t,{Measure:()=>n});var o=r(664332);function n(e){const{children:t,onResize:r}=e;return t((0,o.useResizeObserver)(r||(()=>{}),[null===r]))}},109955:(e,t,r)=>{"use strict";r.d(t,{OverlayScrollWrapper:()=>c});var o=r(50959),n=r(497754),s=r.n(n),i=r(73288),a=r(139043),l=r(817921);function c(e){const{children:t,className:r,wrapperClassName:n,reference:c,hasCustomTouchScrollAnimation:u,scrollContainerRef:d,isForceVisible:p,tabIndex:h,...m}=e,[v,f,g,b]=(0,a.useOverlayScroll)(d,u);return(0,o.useImperativeHandle)(c,(()=>({updateScrollState:b}))),o.createElement("div",{...m,...f,className:s()(l.container,r)},o.createElement(i.OverlayScrollContainer,{...v,visible:p??v.visible,className:l.overlayScrollWrap}),o.createElement("div",{
className:s()(l.wrapper,n),tabIndex:h,ref:g,onScroll:b},t))}},763802:(e,t,r)=>{"use strict";r.d(t,{Caret:()=>o.Caret,CaretButton:()=>o.CaretButton});var o=r(148982)},327871:(e,t,r)=>{"use strict";r.d(t,{KeyCode:()=>o,makeKeyboardListener:()=>i});var o,n=r(50959);!function(e){e[e.Enter=13]="Enter",e[e.Space=32]="Space",e[e.Backspace=8]="Backspace",e[e.DownArrow=40]="DownArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.LeftArrow=37]="LeftArrow",e[e.Escape=27]="Escape",e[e.Tab=9]="Tab"}(o||(o={}));class s{constructor(){this._handlers=new Map}registerHandlers(e){Object.keys(e).forEach((t=>{const r=parseInt(t);let o=e[r];if(Array.isArray(o)||(o=[o]),this._handlers.has(r)){const e=this._handlers.get(r);e&&o.forEach((t=>e.add(t)))}else this._handlers.set(r,new Set(o))}))}unregisterHandlers(e){Object.keys(e).forEach((t=>{const r=parseInt(t);let o=e[r];if(Array.isArray(o)||(o=[o]),this._handlers.has(r)){const e=this._handlers.get(r);e&&o.forEach((t=>e.delete(t)))}}))}deleteAllHandlers(){this._handlers=new Map}registerHandler(e,t){if(this._handlers.has(e)){const r=this._handlers.get(e);r&&r.add(t)}else this._handlers.set(e,new Set([t]))}unregisterHandler(e,t){if(this._handlers.has(e)){const r=this._handlers.get(e);r&&r.delete(t)}}listen(e){if(this._handlers.has(e.keyCode)){const t=this._handlers.get(e.keyCode);t&&t.forEach((t=>t(e)))}}}function i(e){var t;return(t=class extends n.PureComponent{constructor(e){super(e),this._keyboardListener=new s,this._listener=this._keyboardListener.listen.bind(this._keyboardListener)}componentDidMount(){this._registerHandlers(this.props.keyboardEventHandlers)}componentDidUpdate(e){e.keyboardEventHandlers!==this.props.keyboardEventHandlers&&this._registerHandlers(this.props.keyboardEventHandlers)}render(){const{keyboardEventHandlers:t,...r}=this.props;return n.createElement(e,{...r,onKeyDown:this._listener})}_registerHandlers(e){e&&(this._keyboardListener.deleteAllHandlers(),this._keyboardListener.registerHandlers(e))}}).displayName=`KeyboardListener(${e.displayName??e.name??"Component"})`,t}},523398:(e,t,r)=>{"use strict";r.r(t),r.d(t,{closeOrderDialog:()=>Ur,closeOrderDrawer:()=>Qr,mountOrderPanel:()=>Gr,showOrderDialog:()=>zr,showOrderDrawer:()=>qr,unmountOrderPanel:()=>jr});var o,n=r(50959),s=r(632227),i=r(801808),a=r(157129),l=r(497754),c=r.n(l),u=r(586639),d=r(601227),p=r(228837),h=r(273388),m=r(650151),v=r(671945),f=r(662941),g=r(584811),b=r(661851),E=r(180185),C=r(609838),y=r(534934),S=r(363111),w=r(930202),_=r(210162),k=r.n(_);function P({href:e,onClick:t,reference:r,...o}){return e?n.createElement("a",{href:e,onClick:t,target:"_blank",ref:r,...o}):t?n.createElement("button",{onClick:t,ref:r,...o}):n.createElement("span",{ref:r,...o})}function O({className:e,size:t,leftSlot:r,rightSlot:o,children:s,...i}){const a=c()(e,k().badge,t&&k()[t],s&&k().hasChildren);return n.createElement(P,{className:a,...i},r&&n.createElement("div",{className:k().slot},r),s&&n.createElement("span",{className:k().content},s),r&&o&&n.createElement("div",{className:k().slot},o))}
!function(e){e.XSmall="xsmall",e.Small="small",e.Medium="medium",e.Large="large",e.XLarge="xlarge"}(o||(o={}));var T=r(894862),D=r(174884);function M(e){return e===T.RestrictionType.HardToBorrow?D.hardToBorrow:e===T.RestrictionType.Halted?D.halted:null}function I(e){return n.createElement("div",{className:D.restrictions},e.restrictionTypes.map(((e,t)=>n.createElement(O,{key:t,size:o.XSmall,className:c()(D.restriction,M(e))},e))))}var N=r(758304);function x(e,t){return r=>{const o=(0,w.hashFromEvent)(r);13!==o&&32!==o||(r.preventDefault(),r.stopPropagation(),e(t))}}const B=C.t(null,void 0,r(168222)),F=C.t(null,void 0,r(169961)),R=C.t(null,void 0,r(883629)),W=e=>Math.max(e.ask?.length??0,e.bid?.length??0,e.spread?.length??0)>7,H=e=>[S.OrderPanelStatus.Editing,S.OrderPanelStatus.Preview].includes(e);function L({value:e}){return n.createElement("div",{className:N.value},e||n.createElement("div",{className:N.valueNoData},R))}const V=e=>{const{side:t,status:r,quotes:o,onSideChanged:s,restrictionTypes:i,currencyForCrypto:a,orderPlacingStatus:c}=e;function u(e){return(r!==S.OrderPanelStatus.Wait||c===S.OrderPlacingStatus.Placed)&&t===e}const{handleBuyClick:d,handleSellClick:p,handleBuyKeyDown:h,handleSellKeyDown:m}=(0,n.useMemo)((()=>({handleBuyClick:()=>s(1),handleSellClick:()=>s(-1),handleBuyKeyDown:x(s,1),handleSellKeyDown:x(s,-1)})),[s]);return n.createElement(n.Fragment,null,0!==i.length&&n.createElement("div",{className:l(N.restrictions,N.smallPaddings)},n.createElement(I,{restrictionTypes:i})),n.createElement("div",{className:l(N.sideControl,H(r)&&N.disable)},n.createElement("div",{role:"button",tabIndex:0,className:l(N.sell,u(-1)&&N.active),"data-name":"side-control-sell",onClick:p,onKeyDown:m},n.createElement("div",{className:N.title},n.createElement("span",{className:a&&N.typeSide},B),a&&n.createElement("span",null,a)),n.createElement(L,{value:o.bid})),n.createElement("div",{role:"button",tabIndex:0,className:l(N.buy,u(1)&&N.active),"data-name":"side-control-buy",onClick:d,onKeyDown:h},n.createElement("div",{className:N.title},n.createElement("span",{className:a&&N.typeSide},F),a&&n.createElement("span",{className:N.typeSide},a)),n.createElement(L,{value:o.ask})),o.spread&&n.createElement("div",{className:l(N.spread,W(o)&&N.raisedTop),"data-name":"side-control-spread"},o.spread)))};var K=r(763281);function A(e){const{model:t,orderPlacingStatus$:r}=e,{orderPanelStatus:o}=(0,n.useContext)(K.WidgetContext),s=(0,b.useObservable)(t.value$,t.getValue()),i=(0,b.useObservable)(t.formattedQuotes$,t.getFormattedQuotes()),a=(0,b.useObservable)(t.restrictionTypes$,t.getRestrictionTypes()),l=(0,b.useObservable)(r,S.OrderPlacingStatus.Creating);return n.createElement(V,{quotes:i,side:s,status:o,orderPlacingStatus:l,restrictionTypes:a,currencyForCrypto:t.baseCurrency,onSideChanged:e=>{t.setValue(e),t.onControlFocused.fire()}})}var z=r(918460),U=r(204926),$=r(975228),q=r(109955);function Q(e){const{scrollContainerRef:t,...r}=e,o=(0,$.useAccurateHover)(t);return n.createElement(q.OverlayScrollWrapper,{...r,scrollContainerRef:t,
isForceVisible:o})}var G=r(909450),j=r(595693);const Z={cancel:C.t(null,void 0,r(904543)),sendOrder:C.t(null,void 0,r(224602))};function J(e){const{model:t,side:r,isMobile:o,loading$:s,shouldShowActionButton:i,...a}=e,l=(0,n.useRef)(null),c=(0,n.useRef)(null),u=(0,b.useObservable)(s,!1);(0,n.useEffect)((()=>l.current?.focus()),[u]);const d=0!==t.errors.length;return n.createElement(n.Fragment,null,o?n.createElement(X,{...a,ref:c,model:t,hasErrors:d}):n.createElement(Q,{className:j.scrollWrapper,scrollContainerRef:c},n.createElement(X,{...a,ref:c,model:t,hasErrors:d})),i&&n.createElement("div",{className:j.controls},n.createElement(p.SquareButton,{size:"medium",variant:"primary",color:-1===r?"red":"blue",onClick:t.onPlaceClick,reference:l,disabled:d||u},Z.sendOrder),n.createElement(p.SquareButton,{size:"medium",color:"gray",variant:"secondary",onClick:t.onCancelClick},Z.cancel)))}const X=(0,n.forwardRef)(((e,t)=>{const{model:r,hasErrors:o,isPopupOrDrawer:s,requestResize:i}=e,a=(0,b.useObservable)(r.infoTableQuotesData$,{rows:[]}),l=r.infoTableCustomData(),c=r.infoTableOrderData();return(0,n.useEffect)((()=>{s&&i?.()}),[s,a.rows.length]),n.createElement("div",{className:j.content,ref:t},o&&n.createElement(z.Informer,{className:j.informer,informerIntent:"danger",content:r.errors.map(G.parseMarkup)}),0!==r.warnings.length&&n.createElement(z.Informer,{className:j.informer,informerIntent:"warning",content:r.warnings.map(G.parseMarkup)}),n.createElement(U.InfoTable,{rows:a.rows,header:a.header}),n.createElement("div",{className:j.separator}),n.createElement(U.InfoTable,{rows:c.rows,header:c.header}),0!==l.length&&n.createElement(n.Fragment,null,n.createElement("div",{className:j.separator}),l.map(((e,t)=>n.createElement(U.InfoTable,{key:`custom-${t}`,rows:e.rows,header:e.header})))))}));var Y=r(488831),ee=r(820660),te=r(598189);const re=C.t(null,void 0,r(490138)),oe=C.t(null,void 0,r(790258)),ne=C.t(null,void 0,r(898251)),se=C.t(null,void 0,r(978369));var ie;!function(e){e.Market="Market",e.Limit="Limit",e.Stop="Stop",e.StopLimit="StopLimit"}(ie||(ie={}));const ae={Market:2,Limit:1,Stop:3,StopLimit:4};function le(e){const{orderType:t,setOrderType:r,supportMarketOrders:o,supportLimitOrders:s,supportStopOrders:i,supportStopLimitOrders:a}=e,l=(0,n.useMemo)((()=>function(e){const{supportMarketOrders:t,supportLimitOrders:r,supportStopOrders:o,supportStopLimitOrders:n}=e,s=[];return t&&s.push({id:"Market",label:re}),r&&s.push({id:"Limit",label:oe}),o&&s.push({id:"Stop",label:ne}),n&&s.push({id:"StopLimit",label:se}),s}({supportMarketOrders:o,supportLimitOrders:s,supportStopOrders:i,supportStopLimitOrders:a})),[o,s,i,a]),c=(0,n.useCallback)((e=>ae[e.id]===t),[t]);(0,n.useEffect)((()=>{l.length&&!l.some(c)&&r(ae[l[0].id])}),[l,r]);const u=(0,ee.useEnterAndSpaceKeyDownHandler)();return n.createElement("div",{tabIndex:-1,onKeyDown:u,className:te.tabsContainer,id:e["data-test-id"]},n.createElement(Y.UnderlineButtonTabs,{id:"order-type-tabs",items:l,isActive:c,onActivate:e=>r(ae[e.id]),size:"xsmall",overflowBehaviour:"none",
stretchTabs:!0,equalTabSize:!0}))}var ce=r(728232),ue=r(493455),de=r(960521),pe=r(624216),he=r(192063),me=r(763802),ve=r(587125),fe=r(749160);const ge=[1,5,10,25,50,75,100];function be(e){const{control:t,controlType:r,error:o,side:s,focusedControl:i,setFocusedControl:a}=e,c=(0,n.useRef)(null),u=(0,n.useRef)(null),d=(0,b.useObservable)(t.value$,t.getValue()),p=(0,b.useObservable)(e.balanceValue$,null),[h,v]=(0,n.useState)(!1),[f,g]=(0,n.useState)(0),C=Boolean(o&&o.res),y=o&&o.msg,w=null!==p&&p>0&&(-1===s?1===r:2===r);return(0,n.useEffect)((()=>{var t;5===e.initialFocus&&null!==(t=u.current)&&(t.focus(),t.setSelectionRange(t.value.length,t.value.length))}),[]),n.createElement(n.Fragment,null,n.createElement(ve.NumberInput,{...function(e){const t={};k(e)&&(t.highlight=!0);Boolean(o&&o.res)&&k(e)&&(t.intent="danger");return t}(r),value:d,onBlur:e.forceRoundByStep?function(){if(null!==d&&void 0!==e.step){const t=new de.Big(d),r=t.mod(e.step);if(!r.eq(0)){_(t.minus(r).toNumber())}}}:void 0,onValueChange:_,min:e.min,step:e.step,useFormatter:!1,errorMessage:y,errorHandler:e.setControlError,error:C&&k(r),inputReference:function(e){u.current=e},innerLabel:h?void 0:n.createElement("span",{className:fe.label},e.label),onFocus:()=>(a(r),void e.onControlFocused.fire()),onKeyDown:function(e){if(27===(0,E.hashFromEvent)(e))h&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),P())},className:l(fe.input,e.status===S.OrderPanelStatus.Wait&&fe.wait),button:w?n.createElement(me.CaretButton,{isDropped:h,onFocus:function(){u.current?.focus()},onClick:function(){v(!h)}}):n.createElement(n.Fragment,null),containerReference:function(e){c.current=e},alwaysUpdateValueFromProps:e.forceRoundByStep,fontSizeStyle:e.fontSizeStyle,shouldApplyValueOnBlur:!1,inputMode:"decimal",replaceDivider:void 0}),w&&n.createElement(pe.PopupMenu,{position:function(){const e=(0,m.ensureNotNull)(c.current).getBoundingClientRect();return g(e.width),{x:e.left,y:e.top+e.height+1}},onClose:P,isOpened:h,doNotCloseOn:c.current,minWidth:f},ge.map((r=>{const o=function(e){return(0,de.Big)((0,m.ensureNotNull)(p)).mul(.01).mul(e).toNumber()}(r),s=n.createElement(n.Fragment,null,r+"%  ",n.createElement("span",{className:fe.value},"("+e.formatter.format(o)+" "+e.label+")"));return n.createElement(he.PopupMenuItem,{key:r.toString(),className:fe.popupMenuItem,label:s,onClick:()=>t.setValue(o)})}))));function _(r){t.setValue(r),e.onModifiedCallback()}function k(t){return e.status!==S.OrderPanelStatus.Wait&&i===t}function P(){v(!1)}}function Ee(e){const{model:t,className:o,status:s,useContextValidation:i}=e,a=(0,b.useObservable)(t.quoteCurrencyUiParams$),c=(0,b.useObservable)(t.error$,t.getError()),u=(0,b.useObservable)(t.focusedControl$,t.getFocusedControl()),d={side:(0,b.useObservable)(t.side$,t.getSide()),status:s,formatter:t.formatter,error:c,focusedControl:u,setFocusedControl:t.setFocusedControl,onControlFocused:t.onControlFocused,setControlError:t.setControlError,fontSizeStyle:"medium"};return n.createElement(n.Fragment,null,n.createElement("div",{
className:fe.title},C.t(null,void 0,r(715432))),n.createElement(ue.ControlGroup,{cols:1,rows:2,className:l(o,fe.wrapper)},n.createElement(be,{...d,control:t.quantity,onModifiedCallback:t.quantity.onModifiedCallback,label:t.info.baseCurrency,controlType:1,balanceValue$:t.baseCurrencyCryptoBalanceValue$,initialFocus:e.focus,forceRoundByStep:!0,step:t.info.qty.step,min:i?0:t.info.qty.min}),n.createElement(be,{...d,control:t.quoteCurrencyQuantity,onModifiedCallback:t.quoteCurrencyQuantity.onModifiedCallback,label:t.info.quoteCurrency,controlType:2,balanceValue$:t.quoteCurrencyCryptoBalanceValue$,step:a?.step,min:i?0:a?.min})))}var Ce=r(760775),ye=r(972535),Se=r(738036),we=r(327871),_e=r(43681),ke=r(737953);class Pe extends n.PureComponent{constructor(e){super(e)}render(){return n.createElement("div",{className:this.props.className,onClick:this.props.onClick,ref:this.props.reference},this.props.children)}}var Oe=r(438980);class Te extends n.PureComponent{constructor(e){super(e),this._handleResize=([e])=>{this.props.onMeasure?.(e.target.getBoundingClientRect())}}render(){const{theme:e=ke}=this.props,t=l(e.list,{[this.props.className]:Boolean(this.props.className)}),{fontSize:r=13}=this.props,o={bottom:this.props.bottom,fontSize:r,left:this.props.left,height:this.props.height||"auto",right:this.props.right,top:this.props.top,width:this.props.width,zIndex:this.props.zIndex};return n.createElement(Oe.Measure,{onResize:Boolean(this.props.onMeasure)?this._handleResize:null},(e=>n.createElement("div",{className:t,style:o,ref:(0,h.mergeRefs)([this.props.reference,e])},this._wrapItems(this.props.items,this.props.selected))))}componentDidMount(){if(void 0!==this.props.selected&&this.props.shouldScrollIfNotVisible){const e=this._items[this.props.selected];e&&this._scrollToItem(e)}}componentDidUpdate(){if(void 0!==this.props.selected&&this.props.shouldScrollIfNotVisible){const e=this._items[this.props.selected];e&&this._scrollToItem(e)}}_wrapItems(e=[],t){this._items=[];const{itemWrap:r=Pe,theme:o=ke}=this.props,s=r;return e.map(((e,r)=>{const i=l(o.item,{[this.props.itemsClassName]:Boolean(this.props.itemsClassName),[this.props.selectedClassName]:t===r});return n.createElement(s,{reference:t=>{t&&this._items.push({elem:t,index:r,value:e})},key:r,onClick:()=>this._onSelect(r),className:i},e.elem)}))}_onSelect(e){this.props.onSelect&&this.props.onSelect(e,this._items[e].value)}_scrollToItem(e){e.elem.scrollIntoView({block:"center"})}}Te.defaultProps={shouldScrollIfNotVisible:!0};var De=r(841037),Me=r(874485);class Ie extends n.PureComponent{render(){const e={position:"absolute",top:this.props.top,width:this.props.width,height:this.props.height,bottom:this.props.bottom,right:this.props.right,left:this.props.left,zIndex:this.props.zIndex};return n.createElement("div",{className:this.props.className,style:e,ref:this.props.reference},this.props.children)}}Ie.displayName="Dropdown Container";const Ne=(0,Me.makeOverlapable)((0,De.makeAttachable)(Ie));var xe,Be=r(209087);!function(e){e.Top="top",e.Bottom="bottom"}(xe||(xe={}))
;class Fe extends n.PureComponent{constructor(){super(...arguments),this._container=null,this._setContainerRef=e=>{"function"==typeof this.props.reference&&this.props.reference(e),"object"==typeof this.props.reference&&(this.props.reference.current=e),this._container=e}}componentDidMount(){this.props.onDropdownWheelNoPassive&&this._addPassiveListenerOnWheel(this.props.onDropdownWheelNoPassive)}componentDidUpdate(e){this.props.onDropdownWheelNoPassive!==e.onDropdownWheelNoPassive&&this._updatePassiveListenerOnWheel(e.onDropdownWheelNoPassive)}componentWillUnmount(){this.props.onDropdownWheelNoPassive&&this._removePassiveListenerOnWheel(this.props.onDropdownWheelNoPassive)}render(){const{shadow:e="bottom",children:t,className:r}=this.props,o=l(Be.container,Be[e],r),s={maxHeight:this.props.maxHeight};return n.createElement("div",{ref:this._setContainerRef,style:s,className:o,onTouchStart:this.props.onDropdownTouchStart,onTouchMove:this.props.onDropdownTouchMove,onTouchEnd:this.props.onDropdownTouchEnd,onWheel:this.props.onDropdownWheel},t)}_updatePassiveListenerOnWheel(e){e&&this._removePassiveListenerOnWheel(e),this.props.onDropdownWheelNoPassive&&this._addPassiveListenerOnWheel(this.props.onDropdownWheelNoPassive)}_addPassiveListenerOnWheel(e){(0,m.ensureNotNull)(this._container).addEventListener("wheel",e,{passive:!1})}_removePassiveListenerOnWheel(e){(0,m.ensureNotNull)(this._container).removeEventListener("wheel",e)}}var Re=r(579184);const We=(He=Te,(Le=class extends n.PureComponent{constructor(e){super(e),this._items=this.props.items}componentDidUpdate(e){if(e.command!==this.props.command&&this.props.command)switch(this.props.command.name){case"next":this._next();break;case"prev":this._prev()}e.items!==this.props.items&&(this._items=this.props.items)}render(){return n.createElement(He,{...this.props},this.props.children)}_next(){const{selected:e=-1}=this.props,t=e+1;this._items.length-1>=t?this._navigateTo(t):this._navigateTo(0)}_prev(){const{selected:e=-1}=this.props,t=e-1,r=this._items.length-1;0<=t?this._navigateTo(t):this._navigateTo(r)}_navigateTo(e){this.props.onNavigate&&this.props.onNavigate(e,this._items[e])}}).displayName="Navigateable Component",Le);var He,Le;const Ve=(0,Re.makeAnchorable)(Ne),Ke={top:"top",bottom:"bottom",topRight:"top"};class Ae extends n.PureComponent{render(){const{anchor:e="bottom",fontSize:t=14,root:r="parent"}=this.props,o=l(_e.list,_e[e]),{dropdownClassName:s,height:i,...a}=this.props;return n.createElement(Ve,{...a,className:s,root:r},n.createElement(Fe,{className:this.props.dropdownContainerClassName,shadow:Ke[e],maxHeight:this.props.maxHeight,onDropdownTouchStart:this.props.onDropdownTouchStart?this.props.onDropdownTouchStart:void 0,onDropdownTouchMove:this.props.onDropdownTouchMove?this.props.onDropdownTouchMove:void 0,onDropdownTouchEnd:this.props.onDropdownTouchEnd?this.props.onDropdownTouchEnd:void 0,onDropdownWheelNoPassive:this.props.onDropdownWheelNoPassive?this.props.onDropdownWheelNoPassive:void 0},n.createElement(We,{...a,width:this.props.width,height:i,
className:this.props.className||o,itemsClassName:this.props.itemsClassName||_e.item,selectedClassName:this.props.selectedClassName||_e.selected,fontSize:t,reference:this.props.reference})))}}var ze,Ue=r(340591);function $e(e){const t=l(Ue.priceLabel,Ue[e.modifier.toLowerCase()]);return n.createElement("span",{className:l(t)},e.modifier)}!function(e){e.Ask="Ask",e.Bid="Bid",e.Last="Last"}(ze||(ze={}));var qe=r(165550);function Qe(e){const t=e.price===e.ask,r=e.price===e.bid,o=e.price===e.last,s=(t||r)&&e.ask===e.bid;let i,a;return e.displayPriceLabel&&(s&&1===e.side?i=n.createElement($e,{modifier:"Ask"}):s&&-1===e.side?i=n.createElement($e,{modifier:"Bid"}):t?i=n.createElement($e,{modifier:"Ask"}):r&&(i=n.createElement($e,{modifier:"Bid"})),a=n.createElement("div",{className:qe.labelsGroup},i,o&&n.createElement($e,{modifier:"Last"}))),n.createElement("div",{className:qe.absolutePriceDropdownItem},n.createElement("div",{className:qe.price},e.price),a)}var Ge,je=r(794087),Ze=r(472488),Je=r(229144),Xe=r(958198);function Ye(e,t){return e.findIndex((e=>e.priceIndex===t))}function et(e,t,r){const o=function(){0;return"phone"!==Xe.mediaState.device&&"phone-vertical"!==Xe.mediaState.device?rt:ot}(),n=[tt(e,t,r)];for(let s=1;s<=o;s++)n.push(tt(e-s,t,r)),n.unshift(tt(e+s,t,r));return n}function tt(e,t,r){return{priceIndex:e,displayPrice:t.format(r(e))}}!function(e){e[e.Up=1]="Up",e[e.Down=-1]="Down"}(Ge||(Ge={}));const rt=6,ot=4;var nt=r(459409),st=r(459110);const it=(0,we.makeKeyboardListener)(je.InputWithError);class at extends n.PureComponent{constructor(e){super(e),this._priceControl=null,this._priceInput=null,this._dropdown=null,this._validValueRegExp=/^([-−]?([0-9]+\.?[0-9]*)|([-−]?[0-9]*))$/,this._setDropdownRef=e=>{this._dropdown=e},this._onCaretButtonFocus=()=>{this._priceInput?.focus()},this._onFocus=()=>{this.props.onControlFocused&&this.props.onControlFocused(0)},this._onBlur=e=>{if(this.props.status!==S.OrderPanelStatus.Wait){const e=this.props.priceFormatter.parse(this.props.displayPrice);if(e.res){const t=this.props.priceFormatter.format(e.value);this._onPriceSelected(t)}}},this._onOutsideClick=e=>{this.state.isOpened&&this._dropdown&&!this._dropdown.contains(e.target)&&this._closeDropdown()},this._onInputChange=e=>{const t=e.target.value;if(!this._validValueRegExp.test((0,Je.stripLTRMarks)(t)))return;!this.props.isSelected&&this.props.onControlFocused&&this.props.onControlFocused(0);const r=this.props.priceFormatter.parse(t);r.res||this.props.errorHandler(!0,r.error),this._onModifiedCallback(),this._onPriceSelected(t)},this._onTouchStart=e=>{this._swipeState.y=e.touches[0].clientY},this._onTouchMove=e=>{if(e.changedTouches&&e.changedTouches.length&&null!==this._swipeState.y){const t=e.changedTouches[0].clientY-this._swipeState.y,r=this._swipeState.prevDiff??0;if(Math.abs(t-r)<10)return;this._swipeState.direction=t>r?"up":"down",this._swipeState.prevDiff=t,"up"===this._swipeState.direction?this._prependPriceOnDropdown():"down"===this._swipeState.direction&&this._appendPriceOnDropdown()}},this._onTouchEnd=e=>{
this._resetSwipeState()},this._onDropdownWheelNoPassive=e=>{e.preventDefault(),e.stopPropagation(),e.deltaY<0?this._prependPriceOnDropdown():this._appendPriceOnDropdown()},this._onInputMouseWheel=e=>{e.preventDefault(),e.stopPropagation(),this.props.isSelected&&(this._onModifiedCallback(),e.deltaY<0?this._changeValueByStep(1):this._changeValueByStep(-1))},this._onSelect=(e,t)=>{this.setState({selected:e},(()=>{this._onModifiedCallback(),this._closeDropdown(),this._onPriceSelected(t.displayPrice)}))},this._onNavigate=()=>{const e=this.state.command&&"prev"===this.state.command.name,t=this.state.command&&"next"===this.state.command.name;e?this._changeValueByStep(1):t&&this._changeValueByStep(-1)},this._onMouseOver=()=>{this.setState({mouseOver:!0})},this._onMouseOut=()=>{this.setState({mouseOver:!1})},this._onCaretButtonClick=e=>{e.stopPropagation(),this.state.isOpened?this._closeDropdown():(this._openDropdown(),ye.mobiletouch||this._priceInput?.setSelectionRange(this.props.displayPrice.length,this.props.displayPrice.length))},this._setPriceInput=e=>{this._priceInput=e},this._setPriceControl=e=>{this._priceControl=e},this._scrollPriceByArrow=e=>{e.preventDefault(),this._onModifiedCallback();const t=e.keyCode===we.KeyCode.UpArrow?1:-1;!this.props.isSelected&&this.props.onControlFocused&&this.props.onControlFocused(0),this._changeValueByStep(t)},this._selectPrev=e=>{e.preventDefault(),this._onModifiedCallback(),this.setState({command:{name:"prev"}})},this._selectNext=e=>{e.preventDefault(),this._onModifiedCallback(),this.setState({command:{name:"next"}})},this._openDropdown=()=>{this.setState({isOpened:!0,keyboardEventHandlers:this._getKeyboardEventHandlers("open")})},this._closeDropdownWithStopPropagation=e=>{e&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),this._closeDropdown()},this._closeDropdown=()=>{const e=et(this.props.priceIndex,this.props.priceFormatter,this.props.indexToPrice);this.setState({isOpened:!1,keyboardEventHandlers:this._getKeyboardEventHandlers("close"),priceList:e,selected:Ye(e,this.props.priceIndex)})},e.isFractional&&(this._validValueRegExp=/^([-−]?([0-9]+'?[0-9]*([0-9]+'?)[0-9]*)|([-−]?[0-9]*))$/);const t=et(e.priceIndex,e.priceFormatter,e.indexToPrice);this.state={priceList:t,selected:Ye(t,e.priceIndex),isOpened:!1,mouseOver:!1,keyboardEventHandlers:this._getKeyboardEventHandlers("close")},this._resetSwipeState()}render(){const e=n.createElement(me.CaretButton,{isDropped:this.state.isOpened,onFocus:this._onCaretButtonFocus,onClick:this._onCaretButtonClick});return n.createElement("span",{className:this.props.className},n.createElement("div",{className:st.title},n.createElement(Ze.Label,{htmlFor:this.props.id,onClick:this._onFocus,className:st.label},this.props.priceLabel)),n.createElement(Se.OutsideEvent,{mouseDown:!0,touchStart:!0,handler:this._onOutsideClick},(t=>n.createElement("span",{ref:t},n.createElement(nt.PrimaryInputSelector,{inputId:this.props.id,handleSelect:this._onFocus,inputElement:this._priceInput,isSelected:this.props.isSelected,
tooltipText:this.props.primaryPriceSelectorTooltip},n.createElement(it,{className:l(st.input,this.props.status===S.OrderPanelStatus.Wait&&st.wait),keyboardEventHandlers:this.state.keyboardEventHandlers,value:(0,Je.startWithLTR)((0,Je.stripLTRMarks)(this.props.displayPrice)),containerReference:this._setPriceControl,inputReference:this._setPriceInput,warning:this.props.warning,error:this.props.error,errorMessage:this.props.errorMessage,onChange:this._onInputChange,noReadonlyStyles:!0,onBlur:this._onBlur,onMouseOver:this._onMouseOver,onMouseOut:this._onMouseOut,onWheelNoPassive:this._onInputMouseWheel,highlight:this.props.highlight,highlightRemoveRoundBorder:this.props.highlightRemoveRoundBorder,fontSizeStyle:this.props.fontSizeStyle,button:e,intent:this.props.intent,id:this.props.id,"aria-current":this.props.isSelected,"aria-controls":this.props.isSelected?this.props.ariaControls:void 0,readonly:!this.props.isSelected,inputMode:"decimal"}))))),n.createElement(Ae,{anchor:"bottom",root:"document",reference:this._setDropdownRef,className:st.list,command:this.state.command,isOpened:this.state.isOpened,items:this._makeListItems(),itemsClassName:st.item,width:this._getDropdownWidth(),selected:this.state.selected,selectedClassName:st.selected,target:null!==this._priceControl?this._priceControl:void 0,attachmentOffsetY:3,inheritWidthFromTarget:!1,shouldScrollIfNotVisible:!1,onSelect:this._onSelect,onNavigate:this._onNavigate,onDropdownTouchStart:this._onTouchStart,onDropdownTouchMove:this._onTouchMove,onDropdownTouchEnd:this._onTouchEnd,onDropdownWheelNoPassive:this._onDropdownWheelNoPassive}))}componentDidUpdate(e,t){if(this.props.priceIndex===e.priceIndex)return;const r=et(this.props.priceIndex,this.props.priceFormatter,this.props.indexToPrice);this.setState({priceList:r,selected:Ye(r,this.props.priceIndex)})}_onPriceSelected(e){this.props.useContextValidation||this.props.errorHandler(!1),this.props.onPriceSelected(e)}_resetSwipeState(){this._swipeState={direction:null,y:null,prevDiff:null}}_getKeyboardEventHandlers(e){return"close"===e?{[we.KeyCode.UpArrow]:this._scrollPriceByArrow,[we.KeyCode.DownArrow]:this._scrollPriceByArrow}:{[we.KeyCode.Enter]:this._closeDropdownWithStopPropagation,[we.KeyCode.Escape]:this._closeDropdownWithStopPropagation,[we.KeyCode.UpArrow]:this._selectPrev,[we.KeyCode.DownArrow]:this._selectNext}}_makeListItems(){return this.state.priceList.map((e=>({...e,elem:n.createElement(Qe,{price:e.displayPrice,ask:this.props.priceFormatter.format(this.props.ask),bid:this.props.priceFormatter.format(this.props.bid),last:this.props.priceFormatter.format(this.props.last),side:this.props.side,displayPriceLabel:!0})})))}_prependPriceOnDropdown(){const e=[tt(this.state.priceList[0].priceIndex+1,this.props.priceFormatter,this.props.indexToPrice)].concat(this.state.priceList.slice(0,-1));this.setState({priceList:e,selected:Ye(e,this.props.priceIndex)})}_appendPriceOnDropdown(){
const e=this.state.priceList.length-1,t=tt(this.state.priceList[e].priceIndex-1,this.props.priceFormatter,this.props.indexToPrice),r=this.state.priceList.slice(1).concat(t);this.setState({priceList:r,selected:Ye(r,this.props.priceIndex)})}_changeValueByStep(e){const t=this.props.priceIndex+e,r=this.props.indexToPrice(t);this._onPriceSelected((0,Ce.formatValue)(r,this.props.priceFormatter))}_getDropdownWidth(){if(this.state.isOpened&&null!==this._priceControl&&(this.context.mode===S.OrderEditorDisplayMode.Popup||this.state.priceList[0].displayPrice.length<=7)){return parseFloat(window.getComputedStyle(this._priceControl,null).getPropertyValue("width"))+2}}_onModifiedCallback(){this.props.onModifiedCallback&&this.props.onModifiedCallback()}}at.contextType=K.WidgetContext,at.defaultProps={className:"",inputClassName:""};var lt,ct=r(454307);function ut(e,t){return e.findIndex((e=>e.displayValue===t))}!function(e){e[e.Up=1]="Up",e[e.Down=-1]="Down"}(lt||(lt={}));const dt=/^[-+]?[0-9]*\.?[0-9]+$/;function pt(e,t){const r=(0,ct.capitalizeFirstLetter)(e);return t>0?`${r} + ${Math.abs(t)}`:t<0?`${r} - ${Math.abs(t)}`:`${r}`}function ht(e){return String(e)}function mt(e,t){const r=e.offset;return o=e.base,n=function(e,t){return(Math.abs(e)>=1?e:0)+(1===t?1:-1)}(r,t),{displayValue:pt(o,n),base:o,offset:n};var o,n}function vt(e,t,r){const o=[],n=[],s={displayValue:pt(t,e),base:t,offset:e};for(let e=0;e<r;e++)o.unshift(mt(0===e?s:o[0],1)),n.push(mt(0===e?s:n[e-1],-1));return[...o,s,...n]}function ft(){return"phone"!==Xe.mediaState.device&&"phone-vertical"!==Xe.mediaState.device?6:4}var gt=r(890497);function bt(e){return n.createElement("div",{className:gt.relativePriceDropdownItem},n.createElement("div",{className:gt.price},e.price))}var Et=r(376491);const Ct=/^-?[0-9]*$/,yt=(0,we.makeKeyboardListener)(je.InputWithError),St=C.t(null,{context:"price"},r(820163)),wt=C.t(null,void 0,r(366123));class _t extends n.PureComponent{constructor(e){super(e),this._priceInput=null,this._priceControl=null,this._dropdown=null,this._setDropdownRef=e=>{this._dropdown=e},this._onMouseOver=e=>{this.setState({mouseOver:!0})},this._onMouseOut=()=>{this.setState({mouseOver:!1})},this._onOutsideClick=e=>{this.state.isOpened&&this._dropdown&&!this._dropdown.contains(e.target)&&(this._closeDropdown(),this._priceInput?.blur())},this._onCaretButtonFocus=()=>{this._priceInput?.focus()},this._onFocus=()=>{this.setState({isEditing:!0,displayValue:this.state.displayValue===pt(this.props.base,this.props.offset)?ht(this.props.offset):this.state.displayValue}),this.props.onControlFocused&&this.props.onControlFocused(1)},this._onBlur=()=>{this.props.error||this.setState({isEditing:!1,displayValue:pt(this.props.base,this.props.offset)},(()=>{this._trackExitEditingModeEvent(this.props.offset)}))},this._onInputChange=e=>{this._onModifiedCallback();const t=e.currentTarget.value;var r;if(!this.props.isSelected&&this.props.onControlFocused&&this.props.onControlFocused(1),Ct.test(t))return r=t,dt.test(r)?void this.setState({displayValue:t},(()=>{
this._onPriceOffsetSelected(Number(t))})):(this.setState({displayValue:t},(()=>{this._onPriceOffsetSelected(null)})),void this.props.errorHandler(!0,wt))},this._onTouchStart=e=>{this._swipeState.y=e.touches[0].clientY},this._onTouchMove=e=>{if(e.changedTouches&&e.changedTouches.length&&null!==this._swipeState.y){const t=e.changedTouches[0].clientY-this._swipeState.y,r=this._swipeState.prevDiff??0;if(Math.abs(t-r)<10)return;this._swipeState.direction=t>r?"up":"down",this._swipeState.prevDiff=t,"up"===this._swipeState.direction?this._prependPriceOnTouchMove():"down"===this._swipeState.direction&&this._appendPriceOnTouchMove()}},this._onTouchEnd=e=>{this._resetSwipeState()},this._onDropdownWheelNoPassive=e=>{e.preventDefault(),e.stopPropagation(),e.deltaY<0?this._prependPriceOnWheel():this._appendPriceOnWheel()},this._onInputMouseWheel=e=>{e.preventDefault(),e.stopPropagation(),this.props.isSelected&&(this._onModifiedCallback(),e.deltaY<0?this._changeValueByStep(1):this._changeValueByStep(-1))},this._onSelect=(e,t)=>{this.setState({displayValue:t.text,selected:e},(()=>{this._onModifiedCallback(),this._closeDropdown(),this._onPriceOffsetSelected()}))},this._onNavigate=(e,t)=>{const r=this.state.command&&"prev"===this.state.command.name,o=this.state.command&&"next"===this.state.command.name;r?this._changeValueByStep(1):o&&this._changeValueByStep(-1)},this._onCaretButtonClick=e=>{e.preventDefault(),e.stopPropagation(),this.state.isOpened?this._closeDropdown():(this._openDropdown(),!ye.mobiletouch&&this._priceInput&&this._priceInput.setSelectionRange(this.state.displayValue.length,this.state.displayValue.length))},this._switchEditingMode=e=>{e.preventDefault();const t=Number(this.state.displayValue);if(Number.isInteger(t)||this.props.error)this._priceInput?.blur();else{const e=Math.round(t),r=vt(e,this.props.base,ft()),o=ut(r,pt(this.props.base,e));this.setState({displayValue:String(e),prices:r,selected:o,isEditing:!1},(()=>{this._onPriceOffsetSelected(),this._priceInput?.blur()}))}},this._setPriceInput=e=>{this._priceInput=e},this._setPriceControl=e=>{this._priceControl=e},this._scrollPriceByArrow=e=>{e.preventDefault(),this._onModifiedCallback();const t=e.keyCode===we.KeyCode.UpArrow?1:-1;!this.props.isSelected&&this.props.onControlFocused&&this.props.onControlFocused(1),this._changeValueByStep(t)},this._selectPrev=e=>{e.preventDefault(),this._onModifiedCallback(),this.setState({command:{name:"prev"}})},this._selectNext=e=>{e.preventDefault(),this._onModifiedCallback(),this.setState({command:{name:"next"}})},this._openDropdown=()=>{this.setState({isOpened:!0,keyboardEventHandlers:this._getKeyboardEventHandlers("open")})},this._closeDropdownOnKeyDown=e=>{e&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),this._closeDropdown()},this._closeDropdown=()=>{const e=pt(this.props.base,this.props.offset),t=vt(this.props.offset,this.props.base,ft()),r=ut(t,e);this.setState({isOpened:!1,keyboardEventHandlers:this._getKeyboardEventHandlers("close"),prices:t,selected:r})},this._trackExitEditingModeEvent=e=>{
this.props.trackEvent&&this.props.trackEvent("Order Ticket","Relative Price - Exit Editing Mode",String(e))};const t=pt(e.base,e.offset),r=vt(e.offset,e.base,ft()),o=ut(r,t);this.state={displayValue:t,prices:r,selected:o,isOpened:!1,isEditing:!1,mouseOver:!1,keyboardEventHandlers:this._getKeyboardEventHandlers("close")},this._resetSwipeState()}render(){const e=n.createElement(me.CaretButton,{isDropped:this.state.isOpened,onFocus:this._onCaretButtonFocus,onClick:this._onCaretButtonClick});return n.createElement(Se.OutsideEvent,{mouseDown:!0,touchStart:!0,handler:this._onOutsideClick},(t=>n.createElement("span",{className:this.props.className,ref:t},n.createElement("div",{className:Et.title},n.createElement(Ze.Label,{htmlFor:this.props.id,onClick:this._onFocus,className:Et.label},St)),n.createElement(nt.PrimaryInputSelector,{handleSelect:this._onFocus,inputId:this.props.id,inputElement:this._priceInput,isSelected:this.props.isSelected,tooltipText:this.props.primaryPriceSelectorTooltip},n.createElement(yt,{noReadonlyStyles:!0,button:e,onChange:this._onInputChange,readonly:!this.props.isSelected,"aria-current":this.props.isSelected,inputReference:this._setPriceInput,id:this.props.id,containerReference:this._setPriceControl,onWheelNoPassive:this._onInputMouseWheel,className:c()(Et.input,this.props.status===S.OrderPanelStatus.Wait&&Et.wait),keyboardEventHandlers:this.state.keyboardEventHandlers,value:this.state.displayValue,error:this.props.error,errorMessage:this.props.errorMessage,onBlur:this._onBlur,onMouseOver:this._onMouseOver,onMouseOut:this._onMouseOut,highlight:this.props.highlight,highlightRemoveRoundBorder:this.props.highlightRemoveRoundBorder,fontSizeStyle:this.props.fontSizeStyle,intent:this.props.intent,"aria-controls":this.props.isSelected?this.props.ariaControls:void 0})),n.createElement(Ae,{anchor:"bottom",root:"document",reference:this._setDropdownRef,className:Et.list,command:this.state.command,isOpened:this.state.isOpened,items:this._makeListItems(),itemsClassName:Et.item,selected:this.state.selected,selectedClassName:Et.selected,target:null!==this._priceControl?this._priceControl:void 0,attachmentOffsetY:3,inheritWidthFromTarget:!0,shouldScrollIfNotVisible:!1,onSelect:this._onSelect,onNavigate:this._onNavigate,onDropdownTouchStart:this._onTouchStart,onDropdownTouchMove:this._onTouchMove,onDropdownTouchEnd:this._onTouchEnd,onDropdownWheelNoPassive:this._onDropdownWheelNoPassive}))))}componentDidUpdate(e){if(this.props.offset!==e.offset||this.props.base!==e.base){const e=pt(this.props.base,this.props.offset),t=vt(this.props.offset,this.props.base,ft()),r=ut(t,e);this.setState({prices:t,selected:r})}this.state.isEditing&&this.props.isSelected||this.props.offset===e.offset&&this.props.base===e.base&&this.props.error===e.error||this.setState({displayValue:pt(this.props.base,this.props.offset),isEditing:!1})}_onPriceOffsetSelected(e){const t=void 0!==e?e:this.state.prices[this.state.selected].offset;this.props.useContextValidation||this.props.errorHandler(!1),this.props.onPriceOffsetSelected(t)}
_onModifiedCallback(){this.props.onModifiedCallback&&this.props.onModifiedCallback()}_resetSwipeState(){this._swipeState={direction:null,y:null,prevDiff:null}}_getKeyboardEventHandlers(e){return"close"===e?{[we.KeyCode.UpArrow]:this._scrollPriceByArrow,[we.KeyCode.DownArrow]:this._scrollPriceByArrow,[we.KeyCode.Enter]:this._switchEditingMode}:{[we.KeyCode.Enter]:this._closeDropdownOnKeyDown,[we.KeyCode.Escape]:this._closeDropdownOnKeyDown,[we.KeyCode.UpArrow]:this._selectPrev,[we.KeyCode.DownArrow]:this._selectNext}}_makeListItems(){return this.state.prices.map(((e,t)=>({base:e.base,offset:e.offset,text:e.displayValue,elem:n.createElement(bt,{price:e.displayValue})})))}_prependPriceOnWheel(){const e=mt(this.state.prices[0],1);this.setState((t=>({prices:[e].concat(t.prices.slice(0,-1)),selected:0===t.selected?1:t.selected+1})))}_appendPriceOnWheel(){const e=this.state.prices.length-1,t=mt(this.state.prices[e],-1);this.setState((r=>({prices:r.prices.slice(1).concat(t),selected:r.selected===e?e-1:r.selected-1})))}_prependPriceOnTouchMove(){const e=this.state.prices[0],t=[];t.unshift(mt(e,1)),this.setState((e=>({prices:t.concat(e.prices.slice(0,this.state.prices.length-1)),selected:0===e.selected?1:e.selected+1})))}_appendPriceOnTouchMove(){const e=this.state.prices.length-1,t=this.state.prices[e],r=[];r.push(mt(t,-1)),this.setState((t=>({prices:t.prices.slice(1).concat(r),selected:t.selected===e?e-1:t.selected-1})))}_changeValueByStep(e){const t=this.props.offset+e,r=this.state.isEditing?ht(t):pt(this.props.base,t);this.setState({displayValue:r},(()=>{this._onPriceOffsetSelected(t)}))}}var kt=r(430019);const Pt={1:C.t(null,void 0,r(750513)),2:C.t(null,void 0,r(733848))};function Ot(e){const{model:t,priceType:r,focus:o,priceLabel:s,trackEvent:i,useContextValidation:a}=e,c=(0,n.useContext)(K.SettingsContext),{orderPanelStatus:u,isFractional:d}=(0,n.useContext)(K.WidgetContext),p=(0,b.useObservable)(t.priceControlData$,t.getPriceControlData()),h=(0,b.useObservable)(t.focusedControl$,t.getFocusedControl()),m=(0,b.useObservable)(t.error$,t.getError()),v=(0,b.useObservable)(t.quotes$,{ask:0,bid:0,trade:0}),f=(0,b.useObservable)(t.side$),g="medium",E=c.showRelativePriceControl&&!t.isRelativePriceControlHidden,C=m.msg,y=u!==S.OrderPanelStatus.Wait&&m.res&&"warning"===m.severity,w=T(0),_=T(1),k=Pt[r],P=1===r?"absolute-limit-price-field":"absolute-stop-price-field",O=1===r?"relative-limit-price-field":"relative-stop-price-field";return n.createElement(ue.ControlGroup,{cols:E?2:1,rows:1,className:kt.controlGroup},n.createElement(at,{...D(0),id:P,ariaControls:O,className:l(kt.absolutePriceControl,E&&kt.withRelative),priceType:r,isSelected:w,status:u,priceIndex:p?p.index:0,displayPrice:p?p.absolutePrice:"",ask:(0,Ce.getAsk)(v),bid:(0,Ce.getBid)(v),last:(0,Ce.getLast)(v),side:f,priceFormatter:t.formatter,warning:y,error:m.res&&"error"===m.severity&&w,errorMessage:C,errorHandler:M,onControlFocused:I,onPriceSelected:t.setAbsolutePrice,trackEvent:i,onModifiedCallback:t.modifiedAbsolutePriceControlStat,focus:o,fontSizeStyle:g,
priceLabel:s,indexToPrice:t.indexToPrice,isFractional:d,primaryPriceSelectorTooltip:k,useContextValidation:a}),E&&n.createElement(_t,{...D(1),id:O,ariaControls:P,isSelected:_,offset:p?.offset??0,base:p?p.base:"",className:kt.relativePriceControl,status:u,error:m.res&&"error"===m.severity&&_,errorMessage:C,errorHandler:M,fontSizeStyle:g,onControlFocused:I,onPriceOffsetSelected:t.setPriceOffset,trackEvent:i,onModifiedCallback:t.modifiedRelativePriceControlStat,primaryPriceSelectorTooltip:k,useContextValidation:a}));function T(e){return u!==S.OrderPanelStatus.Wait&&h===e}function D(e){const t={};return t.highlight=T(e),m.res&&"error"===m.severity&&T(e)&&(t.intent="danger"),t}function M(e,r){t.setControlError(e,r)}function I(e){e!==t.getFocusedControl()&&t.setFocusedControl(e),t.onControlFocused.fire()}}function Tt(e){const{model:t,trackEvent:o,focus:s}=e,i=(0,b.useObservable)(t.orderType$),a=4===i;return n.createElement(n.Fragment,null,3===i||a?n.createElement(Ot,{key:t.stopPriceModel.id,model:t.stopPriceModel,priceType:t.stopPriceModel.priceType,trackEvent:o,focus:s,priceLabel:a?C.t(null,void 0,r(475299)):C.t(null,void 0,r(7953)),useContextValidation:t.useContextValidation}):null,1===i||a?n.createElement(Ot,{key:t.limitPriceModel.id,model:t.limitPriceModel,priceType:t.limitPriceModel.priceType,trackEvent:o,focus:s,priceLabel:a?C.t(null,void 0,r(277646)):C.t(null,void 0,r(7953)),useContextValidation:t.useContextValidation}):null)}var Dt=r(570446),Mt=r(657947);function It(e){const{model:t,onClose:r}=e,{value$:o,getValue:s,setValue:i,getOrderType:a,durationMetaInfoList:l,onModifiedCallback:c,onControlFocused:u,setError:d,error$:p}=t,h=(0,b.useObservable)(o,s()),m=(0,b.useObservable)(p,{res:!1});if(null===h)return n.createElement(n.Fragment,null);return n.createElement(Mt.DurationControl,{currentDuration:h,durationMetaInfoList:function(){const e=a();return(0,Ce.filterDurationsByOrderType)(l,e)}(),onDurationChanged:function(e){i(e,a()),c()},onClose:r,onControlFocused:()=>u.fire(),error:m,onError:d,showErrorMessages:!0,revertInvalidData:!0})}var Nt=r(997776);const xt=n.lazy((async()=>({default:(await Promise.all([r.e(1705),r.e(6440),r.e(6112)]).then(r.bind(r,555145))).LeverageDialog}))),Bt=(0,Nt.withDialogLazyLoad)(xt);var Ft=r(27950),Rt=r(569327);function Wt(e){const{leverage:t,onClick:o,onControlFocused:s,blocked:i,forceDisabled:a=!1,onBlockedClick:l}=e,u=void 0===t;let d=C.t(null,{replace:{value:String(t)}},r(452386));return u&&(d=C.t(null,void 0,r(701544))),i&&(d=C.t(null,void 0,r(329776))),n.createElement("div",{className:Rt.container,onClick:function(){if(i)return s.fire(),void l()}},n.createElement(Ft.EditButton,{disabled:u||a||i,value:d,startSlot:u||i?void 0:"x",onClick:function(){o(),s.fire()},className:c()(Rt.leverageButton,a&&Rt.disabledLeverageButton)}))}function Ht(e){const{model:t}=e,r=(0,b.useObservable)(t.leverageInfo$,t.leverageInfo()),o=(0,b.useObservable)(t.blocked$,t.getBlocked()),s=t.leveragePreviewResult(),[i,a]=(0,n.useState)(!1),[l,c]=(0,n.useState)(r?.leverage);return(0,n.useEffect)((()=>{
c(r?.leverage)}),[r]),n.createElement(n.Fragment,null,n.createElement(Wt,{onClick:u,leverage:l,forceDisabled:i,blocked:o,onControlFocused:t.onControlFocused,onBlockedClick:t.onBlockedClick}),null!==r&&i&&void 0!==l&&n.createElement(Bt,{symbol:t.symbol,displaySymbol:t.displaySymbol,leverage:l,brokerName:t.brokerName,orderType:t.orderType,side:t.side,isOpen:i,onClose:u,onLeverageSet:t.setLeverage,onLeveragePreview:t.previewLeverage,title:r.title,min:r.min,max:r.max,step:r.step,customFields:t.customFields,infos:s?.infos,warnings:s?.warnings,errors:s?.errors,onSetLeverageValueInOrderWidget:function(e){c(e)}}));function u(){i||t.getLeverageInfo({symbol:t.symbol,orderType:t.orderType,side:t.side,customFields:t.customFields}),a((e=>!e))}}var Lt=r(523090),Vt=r(923978),Kt=r(89129);class At extends n.PureComponent{constructor(e){super(e)}render(){const e={width:`${this.props.progress}%`},t=this.props.usedMargin>this.props.availableMargin,o=t&&this.props.marginExceededTooltipText?this.props.marginExceededTooltipText:"",s=l(Kt.progress,t&&Kt.exceededMargin,o&&"apply-common-tooltip");return n.createElement("div",{className:l(Kt.progressBarContainer,this.props.wait&&Kt.wait)},n.createElement("div",{className:Kt.marginsContainer},n.createElement("div",{className:Kt.margin},n.createElement("div",{className:Kt.titleContainer},n.createElement("div",{className:Kt.title},this.props.marginMeterTitle?this.props.marginMeterTitle:C.t(null,void 0,r(214775))),void 0!==this.props.solutionId&&!1)),n.createElement("div",{className:Kt.price,dir:"ltr"},n.createElement("span",null,(0,Vt.formatInfoValue)(this.props.usedMargin)+" / "),n.createElement("span",{className:Kt.availableMargin},(0,Vt.formatInfoValue)(this.props.availableMargin)))),n.createElement("div",{className:Kt.progressBar},n.createElement("div",{className:Kt.track},n.createElement("div",{className:s,style:e,title:o}))))}}var zt=r(656803);function Ut(e){const{model:t}=e,{orderPanelStatus:o}=(0,n.useContext)(K.WidgetContext),s=(0,b.useObservable)(t.usedMargin$,0),i=(0,b.useObservable)(t.availableMargin$,0),a=t.marginMeterConfig(),l=(0,b.useObservable)(t.infoTableData$),u=(0,b.useObservable)(t.brokerProvidedData$),d=(0,b.useObservable)(t.brokerProvidedDataStatus$),p=(0,b.useObservable)(t.brokerProvidedDataError$),h=(0,b.useObservable)(t.isBrokerProvidedDataApproximate$),m=void 0!==l?.rows&&0!==l.rows.length,v=void 0!==u?.rows&&0!==u.rows.length;return n.createElement("div",{className:c()(zt.orderInfo)},n.createElement("div",{className:zt.title},t.title()),n.createElement("div",{className:zt.contentWrapper},t.hasMarginMeter()&&n.createElement(At,{usedMargin:s,availableMargin:i,progress:(0,Lt.calculatedMarginRatio)(s,i),wait:o===S.OrderPanelStatus.Wait,marginExceededTooltipText:a?.marginExceededTooltipText,description:a?.description,solutionId:a?.solutionId,marginMeterTitle:a?.marginMeterTitle}),m&&n.createElement(U.InfoTable,{rows:l.rows,header:l.header,disabled:o===S.OrderPanelStatus.Wait}),v&&n.createElement(n.Fragment,null,n.createElement(U.InfoTable,{rows:u.rows,
header:C.t(null,void 0,r(959932)),disabled:o===S.OrderPanelStatus.Wait,isDataApproximate:h,error:p,status:d}),u.disclaimer?function(e){if(!Array.isArray(e))return n.createElement("div",{className:zt.disclaimer,key:e},e);const t=[];for(const r of e)"string"!=typeof r?void 0!==r.url&&t.push(n.createElement("a",{key:r.url,className:zt.disclaimerLink,href:r.url,target:"_blank"},r.text)):t.push(r);return n.createElement("div",{className:zt.disclaimer},t)}(u.disclaimer):n.createElement(n.Fragment,null))))}var $t=r(383778),qt=r(898237),Qt=r(878112),Gt=r(595943),jt=r(752509),Zt=r(129018),Jt=r(484672),Xt=r(55799);const Yt=n.forwardRef(((e,t)=>{const{value:r,onValueChange:o,onKeyDown:s,quantityMetainfo:i,errorHandler:a,calculatorUsedStat:l,trackEvent:u,title:d,isSelected:p,onFocus:h,highlight:m,inputReference:v,primaryFieldSelectorTooltip:f,calculatorTitle:g,...b}=e,{min:E,max:C,...y}=i,[_,k]=(0,n.useState)(!1),P=(0,n.useRef)(null),O=(0,n.useRef)(null),T=(0,n.useRef)(null),D=(0,n.useRef)(null);function M(e){P.current=e}function I(e){v?.(e),O.current=e}function N(e){D.current=e}function x(e){const t=(0,w.hashFromEvent)(e);!_||13!==t&&27!==t||(e.stopPropagation(),k(!1)),Object.values(S.CalculatorDecKeyCodes).includes(t)||Object.values(S.CalculatorIncKeyCodes).includes(t)||k(!1),void 0!==s&&s(e)}function B(){k(!1),ye.mobiletouch||null===T.current||T.current.focus()}(0,n.useImperativeHandle)(t,(()=>O.current));const F=e=>{o(e),p||h()},R=n.createElement(Gt.Tooltip,{isRtl:(0,Je.isRtl)(),content:g,trigger:ye.mobiletouch?[Gt.Trigger.Focus]:[Gt.Trigger.Hover,Gt.Trigger.Focus]},n.createElement(qt.LightButton,{tabIndex:m?0:-1,reference:T,className:c()(Xt.calculatorIcon,_&&Xt.isOpened),isActive:_,size:"small","data-name":"quantity-calculator",variant:"ghost",onClick:function(e){e.stopPropagation(),k((e=>!e))},onKeyDown:function(e){const t=(0,w.hashFromEvent)(e);if(13===t||32===t)return e.preventDefault(),e.stopPropagation(),void k((e=>!e))},startSlot:n.createElement(Qt.Icon,{icon:Jt}),"aria-label":g,iconOnly:!0}));return n.createElement("div",null,n.createElement("div",{className:Xt.title},n.createElement(Ze.Label,{htmlFor:"quantity-field",className:Xt.label,onClick:h},d)),n.createElement(Se.OutsideEvent,{click:!0,mouseDown:!0,touchStart:!0,handler:function(e){D.current&&!D.current.contains(e.target)&&k(!1)}},(e=>n.createElement("span",{ref:e},n.createElement(nt.PrimaryInputSelector,{isSelected:p,handleSelect:h,inputElement:O.current,inputId:"quantity-field",tooltipText:f},n.createElement(ve.NumberInput,{...y,...b,value:r,noReadonlyStyles:!0,button:R,highlight:m,inputMode:"decimal",readonly:!p,"aria-current":p,autoSelectOnFocus:!1,onKeyDown:x,errorHandler:a,mode:"float",inputReference:I,id:"quantity-field",onValueChange:F,containerReference:M,"aria-controls":"quantity-calculation-field",controlIncKeyCodes:_?[S.CalculatorIncKeyCodes.Plus,S.CalculatorIncKeyCodes.NumPlus,S.CalculatorIncKeyCodes.FirefoxPlus]:void 0,controlDecKeyCodes:_?[S.CalculatorDecKeyCodes.Minus,S.CalculatorDecKeyCodes.NumMinus,S.CalculatorDecKeyCodes.FirefoxMinus]:void 0
})),_&&n.createElement(Zt.QuantityCalculator,{...i,valueGetter:()=>r,onValueChange:o,position:(0,jt.getPopupPositioner)(P.current,{horizontalAttachEdge:jt.HorizontalAttachEdge.Right,horizontalDropDirection:jt.HorizontalDropDirection.FromRightToLeft}),targetEl:P.current,calcReference:N,onClose:B,errorHandler:a,calculatorUsedStat:l,trackEvent:u,trackEventTarget:"Order Ticket"})))))}));var er=r(528457),tr=r(923058),rr=r(152601),or=r(630855),nr=r(609484),sr=r(744471),ir=r(737563),ar=r(589756);const lr="quantity-dropdown-types",cr=C.t(null,void 0,r(905094));function ur(e){const{quantityType:t,selectedQuantityType:r,title:o,informerText:s,onSelect:i}=e,a=r===t;const l=(0,ee.useEnterAndSpaceKeyDownHandler)();let c=o;return void 0!==s&&""!==s&&(c=n.createElement(n.Fragment,null,n.createElement("span",{"data-name":`quantity-type-${t}`},o),n.createElement(tr.ContextAction,null,n.createElement("div",{onKeyDown:l},n.createElement(ir.IconQuestionInformationButton,{tabIndex:0,intent:a?"neutral-light":void 0,icon:"info",ariaLabel:s,tooltip:s,onClick:function(e){e.stopPropagation(),ye.mobiletouch&&((0,sr.tooltipClickHandler)(e),document.addEventListener("touchend",(e=>e.preventDefault()),{once:!0}))}}))))),n.createElement(or.ContextActionsPopoverItem,{title:c,onClick:i,selected:a})}function dr(e){const{selectedQuantityType:t,setSelectedQuantityType:o,availableQuantityTypeInfos:s}=e,i=(0,n.useRef)(null),{isOpen:a,onClose:l,onOpen:c}=(0,er.useRootPopoverOpenState)(i),u=(0,ee.useEnterAndSpaceKeyDownHandler)(c),d=(0,n.useCallback)((e=>{e.onSelect?.(),o(e.quantityType),l(!1)}),[o,l]),p=(0,n.useMemo)((()=>Object.values(s).filter((e=>"units"!==e.quantityType)).map((e=>n.createElement(ur,{...e,key:e.quantityType,quantityType:e.quantityType,selectedQuantityType:t,onSelect:()=>d(e)})))),[t,d,s]);return n.createElement(n.Fragment,null,n.createElement("label",{htmlFor:lr,className:ar.hidden},C.t(null,void 0,r(211292))),n.createElement(Gt.Tooltip,{isRtl:!1,content:cr,trigger:ye.mobiletouch?[Gt.Trigger.Focus]:[Gt.Trigger.Hover,Gt.Trigger.Focus]},n.createElement(nr.TextButton,{showCaret:!0,id:lr,onClick:c,isSelected:a,reference:i,size:"small",color:"light-gray",onKeyDown:u},s[t]?.title)),n.createElement(rr.PopoverKeyboardNavigator,{isOpen:a,onClose:l,anchored:{type:"element",at:i},"data-name":"menu-inner"},p))}var pr=r(463039);function hr(e){const{min:t,max:r,step:o,title:s,uiStep:i,onFocus:a,disabled:l,highlight:c,onValueChange:u,inputReference:d,primaryFieldSelectorTooltip:p,isSelected:h,...m}=e,v=(0,n.useRef)(null),f=(0,n.useCallback)((e=>{d?.(e),v.current=e}),[d]),g=(0,n.useCallback)((e=>{u(e),h||a()}),[u,a]);return n.createElement(n.Fragment,null,n.createElement(pr.Label,{className:Xt.hidden,htmlFor:"quantity-calculation-field"},s),n.createElement(nt.PrimaryInputSelector,{disabled:l,isSelected:h,handleSelect:a,inputElement:v.current,tooltipText:p,inputId:"quantity-calculation-field"},n.createElement(ve.NumberInput,{...m,min:t,max:r,step:o,noReadonlyStyles:!0,uiStep:i,disabled:l,highlight:c,readonly:!h,"aria-current":h,autoSelectOnFocus:!1,
mode:"float",inputReference:f,onValueChange:g,"data-name":"calculation-method-input",id:"quantity-calculation-field","aria-controls":"quantity-field",inputMode:"decimal"})))}const mr=C.t(null,void 0,r(485280));function vr(e,t){return e?.[t]??null}function fr(e){const{model:t,status:r,focus:o,trackEvent:s,useContextValidation:i}=e,{quantity:a,orderSizeCalculator:l,inputType$:c,error$:u,focusedControl$:d,convertedValues$:p,onControlFocused:h,stopLossAvailable$:m,orderSizeCalculatorQuantityType$:v,getInputType:f,setInputTypeAndValue:g,getOrderSizeCalculatorQuantityType:E,getError:C,setControlError:y,getFocusedControl:w,orderWidgetStat:_,getFormatter:k,calculatorTitle:P}=t,O=t.getAvailableQuantityTypeInfos(),T=(0,n.useRef)(null),D=(0,n.useRef)(null),M=(0,b.useObservable)(a.value$,a.getValue()),I=(0,b.useObservable)(l.value$,l.getValue()),N=(0,b.useObservable)(p),x=(0,b.useObservable)(c,f()),B=(0,b.useObservable)(u,C()),F=(0,b.useObservable)(d,w()),R=(0,b.useObservable)(m),W=(0,b.useObservable)(v,E()),[H,L]=(0,n.useState)(!1),V="riskInCurrency"===(K=W)||"riskInPercent"===K;var K;if((0,n.useEffect)((()=>{5===o&&A("units"===x?T.current:D.current)}),[]),(0,n.useEffect)((()=>{H&&(L(!1),A(D.current))}),[H]),void 0===O)return n.createElement(n.Fragment,null);function A(e){null!==e&&e.focus()}const z=(e,t)=>{0===e&&(a.setValue(t),a.onModifiedCallback()),3===e&&(l.setValue(t),l.onModifiedCallback()),h.fire()};const U=(e,t)=>{const o=F===e,n=r!==S.OrderPanelStatus.Wait&&o,s=null===D.current?void 0:n,a=Boolean(void 0!==B&&B.res&&n);return{value:0===e?M:I,onValueChange:t=>z(e,t),onEmptyString:()=>z(e,null),onFocus:()=>(e=>{e!==x&&g(e,vr(N,e)),h.fire()})(t),className:r===S.OrderPanelStatus.Wait&&Xt.wait,boundariesErrorMessages:O[t]?.boundariesErrorMessages,highlight:s,isSelected:n,intent:a?"danger":void 0,error:a,errorMessage:a?B.msg:void 0,errorHandler:i?void 0:y,fontSizeStyle:"medium",forceShowControls:!1,autoComplete:"off",formatter:k(t),forceApplyValueFromProps:H||!o,replaceDivider:void 0}},$=!R&&V;return n.createElement(ue.ControlGroup,{className:Xt.controlGroup,cols:null===D.current?1:2,rows:1},n.createElement(Yt,{...U(0,"units"),title:O.units.title,ref:T,quantityMetainfo:O.units.quantityMetainfo,calculatorUsedStat:()=>a.calculatorUsedStat(),trackEvent:s,primaryFieldSelectorTooltip:mr,calculatorTitle:P}),null!==W&&n.createElement("div",{className:Xt.orderSizeCalculator},n.createElement("div",{className:Xt.title},n.createElement(dr,{selectedQuantityType:W,setSelectedQuantityType:function(e){g(e,vr(N,e)),L(!0),_?.setIsOrderSizeCalculatorUsed(),_?.setQtyTypeModifiedProperty(e),h.fire()},availableQuantityTypeInfos:O})),n.createElement(hr,{...U(3,W),...O[W]?.quantityMetainfo,disabled:$,inputReference:function(e){D.current=e},title:O[W]?.title,mode:"float",primaryFieldSelectorTooltip:mr})))}var gr=r(556013),br=r(28156),Er=r(166554),Cr=r(608628);const yr=(0,v.getLogger)("Trading.OrderPanel"),Sr=C.t(null,void 0,r(645207));C.t(null,void 0,r(731685)),C.t(null,void 0,r(711986)),C.t(null,void 0,r(733895)),C.t(null,void 0,r(470877)),
C.t(null,void 0,r(877309));function wr(){document.activeElement instanceof HTMLElement?document.activeElement.blur():yr.logWarn("Failed to deselect: active element is not HTMLElement")}const _r=(0,n.forwardRef)(((e,t)=>{const{model:r,focus:o,trackEvent:s,orderPanelStatus:i,orderType:a,setOrderType:l,isNoQuotes:c,isMobile:u,isPopupMode:p,requestResize:m,shouldShowActionButton:v,showOrderInfo:f}=e;(0,n.useEffect)((()=>{p&&m?.()}),[a,p,f]);const g=i===S.OrderPanelStatus.Wait||d.CheckMobile.any()?void 0:o,b=function(e,t){return Boolean(2!==t&&(!e.existingOrder||e.existingOrder&&e.supportModifyOrderPrice))}(r,a),E=function(e,t){const r=2!==t||e.supportMarketBrackets();return Boolean(e.supportBrackets()&&r)}(r,a)||function(e){return Boolean(e.supportCryptoBrackets)}(r),C=function(e){return Boolean(e.durationModel&&(!e.existingOrder||e.existingOrder&&e.supportModifyDuration)&&e.durationModel.isDurationsAvailable())}(r),y=function(e){return Boolean(e.supportLeverageButton)}(r),w=[S.OrderPanelStatus.Active,S.OrderPanelStatus.Wait].includes(i),_=r.customFieldsModel.getCustomFieldsModels(),k=(r.links(),[]),P=(0,n.useRef)(null),O={model:r,supportOrderPrice:b,supportBrackets:E,supportDuration:C,customFieldModels:_,supportLeverageButton:y,centerBlockRef:P,trackEvent:s,currentFocus:g,orderPanelStatus:i,showOrderInfo:f,isMobile:u};w&&k.push({id:"symbol-specific-warning",warningMessageSource:r.symbolSpecificWarningMessage});const T=r.limitPriceModel&&r.stopPriceModel&&!r.existingOrder&&!1!==r.supportModifyOrderType;return n.createElement(n.Fragment,null,r.sideModel&&!r.existingOrder&&n.createElement("div",{className:Cr.side},n.createElement(A,{model:r.sideModel,orderPlacingStatus$:r.orderPlacingStatus$})),T&&n.createElement(le,{orderType:a,setOrderType:l,supportMarketOrders:r.supportMarketOrders(),supportLimitOrders:r.supportLimitOrders(),supportStopOrders:r.supportStopOrders(),supportStopLimitOrders:r.supportStopLimitOrders()}),u?n.createElement(kr,{...O}):n.createElement(Q,{className:Cr.scrollWrapper,scrollContainerRef:P},n.createElement(kr,{...O})),!1,void 0!==r.buttonModel&&v&&n.createElement("div",{className:Cr.doneButton},n.createElement(Dt.PlaceAndModifyButton,{model:r,reference:(0,h.isomorphicRef)(t),buttonModel:r.buttonModel})),n.createElement($t.TradingPanelWarningInformersContainer,{warningInformersItems:k}))}));function kr(e){const{model:t,supportOrderPrice:r,supportBrackets:o,supportDuration:s,customFieldModels:i,supportLeverageButton:a,centerBlockRef:c,trackEvent:u,currentFocus:d,orderPanelStatus:p,showOrderInfo:h}=e;return t.limitPriceModel&&t.stopPriceModel&&t.quantityModel&&n.createElement("div",{className:l(Cr.centerBlock,p===S.OrderPanelStatus.Editing&&Cr.centerBlockEditing),ref:c},p===S.OrderPanelStatus.Editing&&n.createElement(g.Divider,{className:Cr.divider,size:"xsmall"}),r&&n.createElement(Tt,{model:t,trackEvent:u,focus:d}),t.supportModifyQuantity&&n.createElement("div",{className:Cr.quantityWrapper},n.createElement(Pr,{model:t,orderPanelStatus:p,currentFocus:d,trackEvent:u})),o&&n.createElement("div",{
className:Cr["brackets-wrapper"]},n.createElement("div",{className:Cr.brackets},n.createElement(ce.BracketControlGroup,{model:t,focus:d}))),s&&n.createElement("div",{className:Cr.duration},n.createElement(It,{model:(0,m.ensureDefined)(t.durationModel)})),i.length>0&&n.createElement("div",{className:Cr.customFieldsWrapper},n.createElement(gr.OrderPanelCustomFields,{customFieldModels:i})),a&&n.createElement("div",{className:Cr.leverage},n.createElement(Ht,{model:(0,m.ensureDefined)(t.leverageModel)})),h&&n.createElement("div",{className:Cr.orderInfoWrapper},n.createElement(Ut,{"data-name":"order-info",model:(0,m.ensureNotNull)(t.orderInfoModel)})))}function Pr(e){const{model:t,orderPanelStatus:r,currentFocus:o,trackEvent:s}=e;return t.supportCryptoExchangeOrderTicket()?n.createElement(Ee,{model:t.quantityModel,status:r,focus:o,useContextValidation:t.useContextValidation}):n.createElement(fr,{model:t.quantityModel,status:r,trackEvent:s,focus:o,useContextValidation:t.useContextValidation})}function Or(e){const{model:t}=e,r=t.tradableSolution?n.createElement(p.SquareButton,{onClick:t.tradableSolution.apply,size:"small"},t.tradableSolution.title):void 0;return n.createElement("div",{className:Cr.emptyStateBlockWrapper},n.createElement(f.EmptyStateBlock,{iconClass:Cr.sadScreenIcon,title:Sr,titleSize:"normal",text:(0,m.ensureDefined)(t.notTradableText),action:r}))}function Tr(e){const{model:t}=e;return n.createElement("div",{className:Cr.emptyStateBlockWrapper},n.createElement(f.EmptyStateBlock,{iconClass:Cr.launchReplayIcon,title:(0,m.ensureDefined)(t.notTradableReasonHeadingText),titleSize:"normal",text:(0,m.ensureDefined)(t.notTradableText)}))}function Dr(e){const{model:t,requestResize:o}=e,{mode:s,orderPanelStatus:i}=(0,n.useContext)(K.WidgetContext),a=(0,b.useObservable)(t.isNoQuotes$,!1),c=(0,b.useObservable)(t.orderInfoModel?.infoTableData$??(0,u.of)(null),null),p=(0,b.useObservable)(t.orderInfoModel?.brokerProvidedData$??(0,u.of)(null),null),h=(0,b.useObservable)(t.orderType$,t.getOrderType()),v=(0,n.useRef)(null),f=(0,n.useRef)(null),g=function(e,t){return t===S.OrderPanelStatus.Preview&&null!==e.orderPreviewModel}(t,i),w=function(e){const t=e.orderInfoModel?.getOrderInfoTableRowsCount()||0;return!e.needSignIn&&!e.noBroker&&!e.notTradableText&&t>0&&y.enabled("order_info")}(t)&&(null!==c||null!==p)&&!g,_=d.CheckMobile.any()||d.CheckMobile.isIPad(),k=s===S.OrderEditorDisplayMode.Popup,P=s===S.OrderEditorDisplayMode.ResizableDrawer;return(0,n.useEffect)((()=>{i===S.OrderPanelStatus.Wait&&v.current?.contains(document.activeElement)&&wr()}),[i]),n.createElement("div",{className:l(Cr.orderWidget),onKeyDown:function(e){const r=(0,E.hashFromEvent)(e);if(!(13!==r&&r!==E.hashShiftPlusEnter||t.isButtonDisabled()||null===f.current))return d.CheckMobile.any()?wr():void f.current.focus()},tabIndex:-1,ref:v,"aria-label":C.t(null,void 0,r(675962))},n.createElement("div",{className:Cr.orderTicket},(k||P)&&n.createElement(br.HeaderContainer,{...e.model.headerStateValue
}),!1,!1,t.notTradableText&&(t.notTradableReasonHeadingText===Er.launchReplayReasoning.reasonHeading?n.createElement(Tr,{model:t}):n.createElement(Or,{model:t})),!t.needSignIn&&!t.noBroker&&!t.notTradableText&&(g?n.createElement(J,{model:(0,m.ensureNotNull)(t.orderPreviewModel),side:t.side(),loading$:t.loading$,isMobile:_,shouldShowActionButton:e.shouldShowActionButton,isPopupOrDrawer:k||P,requestResize:o}):n.createElement(_r,{...e,ref:f,orderType:h,setOrderType:t.setOrderType,orderPanelStatus:i,isNoQuotes:a,isMobile:_,isPopupMode:k,showOrderInfo:w,requestResize:o}))))}var Mr=r(674721);function Ir(e){return n.createElement("div",{"data-name":"order-panel",className:Mr.orderPanel},n.createElement(Dr,{...e,key:e.model.id,shouldShowActionButton:!0}))}var Nr=r(930894),xr=r(533408),Br=r(274837),Fr=r(49683);const Rr=n.memo((e=>{const{model:t,isOpened:r,onClose:o,trackEvent:s,focus:i,onOpen:a}=e;return(0,Br.useCommonDialogHandlers)({isOpened:r,onOpen:a,onClose:o}),n.createElement(xr.AdaptivePopupDialog,{className:Fr.dialog,isOpened:r,dataName:"order-dialog-popup",render:function(e){const{requestResize:r}=e;return n.createElement(Nr.Body,{className:Fr.dialogBody},n.createElement(Dr,{key:t.id,model:t,trackEvent:s,focus:i,requestResize:r,shouldShowActionButton:!0}))},onClose:()=>o?.()})}));var Wr=r(910549),Hr=r(977540),Lr=r(110686);const Vr=n.memo((e=>{const{model:t,isOpened:r,onClose:o,trackEvent:s,focus:i,onOpen:a,forceCollapsedOrderDrawer:l}=e;(0,Br.useCommonDialogHandlers)({isOpened:r,onOpen:a,onClose:o});const[c,u]=(0,n.useState)(l?Hr.ResizableDrawerContentHeight.Collapsed:Hr.ResizableDrawerContentHeight.Full),d=(0,n.useCallback)((()=>{u(Hr.ResizableDrawerContentHeight.Full)}),[]);return n.createElement(Hr.ResizableDrawer,{controlsContent:n.createElement(Lr.OrderDrawerControlContent,{buttonModel:t.buttonModel,onClose:o,sideModel:t.sideModel,side:()=>t.side(),isButtonDisabled$:t.isButtonDisabled$,isButtonDisabled:()=>t.isButtonDisabled(),loading$:t.loading$,doneButtonClick:()=>t.doneButtonClick()}),disableSwipe:!1,disablePan:!1,contentHeight:c},n.createElement(Wr.PopupContext.Consumer,null,(e=>n.createElement(Dr,{model:t,key:t.id,trackEvent:s,focus:i,shouldShowActionButton:!1,requestResize:d}))))}));let Kr=null,Ar=null;function zr(e){const{viewModel:t,settings$:r,mode:o,onClose:s,onOpen:i,focus:l,trackEvent:c}=e,u=n.createElement(K.OrderTicketProvider,{settings$:r,mode:o,orderPanelStatus$:t.status$,isFractional:t.isFractional},n.createElement(Rr,{model:t,isOpened:!0,onOpen:i,onClose:()=>Ur(s),trackEvent:c,focus:l}));Ar?Ar.render(u):(Kr=document.createElement("div"),document.body.appendChild(Kr),Ar=(0,a.createReactRoot)(u,Kr))}function Ur(e){Kr&&(Ar?.unmount(),Ar=null,Kr=null,e?.())}const $r="order-drawer-widget";function qr(e){const{viewModel:t,settings$:r,mode:o,onClose:s,onOpen:l,focus:c,trackEvent:u,forceCollapsedOrderDrawer:d}=e,p=(0,i.getRootOverlapManager)().ensureWindow($r),h=n.createElement(K.OrderTicketProvider,{settings$:r,mode:o,orderPanelStatus$:t.status$,isFractional:t.isFractional},n.createElement(Vr,{
model:t,isOpened:!0,onOpen:l,onClose:()=>Qr(s),trackEvent:u,focus:c,forceCollapsedOrderDrawer:d}));Ar?Ar.render(h):Ar=(0,a.createReactRoot)(h,p)}function Qr(e){Ar?.unmount(),Ar=null;(0,i.getRootOverlapManager)().removeWindow($r),e?.()}function Gr(e){const{viewModel:t,settings$:r,mode:o,resizerBridgeElement:i,focus:a,trackEvent:l}=e;s.render(n.createElement(K.OrderTicketProvider,{settings$:r,mode:o,orderPanelStatus$:t.status$,isFractional:t.isFractional},n.createElement(Ir,{model:t,trackEvent:l,focus:a})),i)}function jr(e){s.unmountComponentAtNode(e)}},997776:(e,t,r)=>{"use strict";r.d(t,{withDialogLazyLoad:()=>i});var o=r(50959),n=r(252130);const s=e=>{const[t,r]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{!t&&e&&r(!0)}),[e]),t};function i(e){return t=>{const r=(0,n.useIsMounted)();return(s(t.isOpen)||t.isOpen)&&r?o.createElement(o.Suspense,{fallback:null},o.createElement(e,{...t})):null}}},115589:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9.36 5a4.44 4.44 0 0 0-4.39 4.5c0 2.49 1.97 4.5 4.39 4.5 1.62 0 3.04-.9 3.8-2.25l.84.5A5.33 5.33 0 0 1 9.36 15 5.43 5.43 0 0 1 4 9.5C4 6.46 6.4 4 9.36 4c1.98 0 3.71 1.1 4.64 2.75l-.84.5A4.36 4.36 0 0 0 9.36 5Z"/></svg>'},96634:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M5 9h9v1H5V9Z"/></svg>'},218666:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M9.5 4.5h-1v4h-4v1h4v4h1v-4h4v-1h-4v-4Z"/></svg>'},672197:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M10 6.13V8L6 5.5 10 3v2.1A5 5 0 1 1 4 10a.5.5 0 0 1 1 0 4 4 0 1 0 5-3.87Z"/></svg>'},484672:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path fill="currentColor" d="m13.625 2.299.398.304-10.239 13.41-.397-.303-.398-.303 10.238-13.41zM17 16h-7v-1h7zm0-3h-7v-1h7zM5 5h3v1H5v3H4V6H1V5h3V2h1z"/></svg>'}}]);