(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[2650],{733234:(e,t,i)=>{"use strict";i.d(t,{getLocaleIso:()=>r});var s=i(650151)
;const o=JSON.parse('{"en":{"language":"en","language_name":"English","flag":"us","geoip_code":"us","iso":"en","iso_639_3":"eng","global_name":"English","is_only_recommended_tw_autorepost":true},"in":{"language":"en","language_name":"English ‎(India)‎","flag":"in","geoip_code":"in","iso":"en","iso_639_3":"eng","global_name":"Indian"},"de_DE":{"language":"de","language_name":"Deutsch","flag":"de","geoip_code":"de","countries_with_this_language":["at","ch"],"iso":"de","iso_639_3":"deu","global_name":"German","is_in_european_union":true},"fr":{"language":"fr","language_name":"Français","flag":"fr","geoip_code":"fr","iso":"fr","iso_639_3":"fra","global_name":"French","is_in_european_union":true},"ca_ES":{"language":"ca_ES","language_name":"Català","flag":"es","geoip_code":"es","iso":"ca","iso_639_3":"cat","global_name":"Catalan"},"es":{"language":"es","language_name":"Español","flag":"es","geoip_code":"es","countries_with_this_language":["mx","ar","ve","cl","co","pe","uy","py","cr","gt","c","bo","pa","pr"],"iso":"es","iso_639_3":"spa","global_name":"Spanish","is_in_european_union":true},"it":{"language":"it","language_name":"Italiano","flag":"it","geoip_code":"it","iso":"it","iso_639_3":"ita","global_name":"Italian","is_in_european_union":true},"pl":{"language":"pl","language_name":"Polski","flag":"pl","geoip_code":"pl","iso":"pl","iso_639_3":"pol","global_name":"Polish","is_in_european_union":true},"hu_HU":{"language":"hu_HU","language_name":"Magyar","flag":"hu","geoip_code":"hu","iso":"hu","iso_639_3":"hun","global_name":"Hungarian","is_in_european_union":true},"sv_SE":{"language":"sv","language_name":"Svenska","flag":"se","geoip_code":"se","iso":"sv","iso_639_3":"swe","global_name":"Swedish","is_in_european_union":true},"tr":{"language":"tr","language_name":"Türkçe","flag":"tr","geoip_code":"tr","iso":"tr","iso_639_3":"tur","global_name":"Turkish","is_only_recommended_tw_autorepost":true},"ru":{"language":"ru","language_name":"Русский","flag":"ru","geoip_code":"ru","countries_with_this_language":["am","by","kg","kz","md","tj","tm","uz"],"iso":"ru","iso_639_3":"rus","global_name":"Russian","is_only_recommended_tw_autorepost":true},"br":{"language":"pt","language_name":"Português","flag":"br","geoip_code":"br","iso":"pt","iso_639_3":"por","global_name":"Portuguese"},"id":{"language":"id_ID","language_name":"Bahasa Indonesia","flag":"id","geoip_code":"id","iso":"id","iso_639_3":"ind","global_name":"Indonesian"},"ms_MY":{"language":"ms_MY","language_name":"Bahasa Melayu","flag":"my","geoip_code":"my","iso":"ms","iso_639_3":"zlm","global_name":"Malaysian"},"th_TH":{"language":"th","language_name":"ภาษาไทย","flag":"th","geoip_code":"th","iso":"th","iso_639_3":"tha","global_name":"Thai"},"vi_VN":{"language":"vi","language_name":"Tiếng Việt","flag":"vn","geoip_code":"vn","iso":"vi","iso_639_3":"vie","global_name":"Vietnamese"},"ja":{"language":"ja","language_name":"日本語","flag":"jp","geoip_code":"jp","iso":"ja","iso_639_3":"jpn","global_name":"Japanese"},"kr":{"language":"ko","language_name":"한국어","flag":"kr","geoip_code":"kr","iso":"ko","iso_639_3":"kor","global_name":"Korean"},"zh_CN":{"language":"zh","language_name":"简体中文","flag":"cn","geoip_code":"cn","countries_with_this_language":["zh"],"iso":"zh-Hans","iso_639_3":"cmn","global_name":"Chinese"},"zh_TW":{"language":"zh_TW","language_name":"繁體中文","flag":"tw","geoip_code":"tw","countries_with_this_language":["hk"],"iso":"zh-Hant","iso_639_3":"cmn","global_name":"Taiwanese"},"ar_AE":{"language":"ar","language_name":"العربية","flag":"sa","geoip_code":"sa","countries_with_this_language":["ae","bh","dj","dz","eg","er","iq","jo","km","kw","lb","ly","ma","mr","om","qa","sa","sd","so","sy","td","tn","ye"],"dir":"rtl","iso":"ar","iso_639_3":"arb","global_name":"Arabic"},"he_IL":{"language":"he_IL","language_name":"עברית","flag":"il","geoip_code":"il","dir":"rtl","iso":"he","iso_639_3":"heb","global_name":"Israeli"}}'),n=function(){
const e=document.querySelectorAll("link[rel~=link-locale][data-locale]");if(0===e.length)return o;const t={};return e.forEach((e=>{const i=(0,s.ensureNotNull)(e.getAttribute("data-locale"));t[i]={...o[i],href:e.href}})),t}();function r(e){return e=e||window.locale,n[e]?.iso}},369625:e=>{e.exports={container:"container-YmcAFxOk",redStripe:"redStripe-YmcAFxOk",blueStripe:"blueStripe-YmcAFxOk",title:"title-YmcAFxOk",counter:"counter-YmcAFxOk",blueCounter:"blueCounter-YmcAFxOk",redCounter:"redCounter-YmcAFxOk",descriptor:"descriptor-YmcAFxOk",subtitle:"subtitle-YmcAFxOk",table:"table-YmcAFxOk",tableTitle:"tableTitle-YmcAFxOk",tableRow:"tableRow-YmcAFxOk",units:"units-YmcAFxOk",atDecoration:"atDecoration-YmcAFxOk",price:"price-YmcAFxOk",date:"date-YmcAFxOk"}},930783:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ExecutionsService:()=>u});var s=i(650151),o=i(671945),n=i(144421),r=i(932473),a=i(995379),l=i(627692),c=i(760775);class u extends a.BrokerService{constructor(e,t,i){super(e,"ExecutionsService"),this._allExecutionsID=new Set,this._executions=[],this._executionsAdded=new l.Delegate,this._executionsCleared=new l.Delegate,this._formatter=new r.PriceFormatter,this._symbol="",this._dataEvents=t,this._getSymbolName=i,this._logger=(0,o.getLogger)("Trading.ExecutionsService"),this._initialized=!0,this._tryToStart()}formatter(){return this._formatter}executions(){return this._executions}executionsAdded(){return this._executionsAdded}executionsCleared(){return this._executionsCleared}startService(){this.activeBroker()?.config.supportExecutions&&(this._canBeStarted=!0,this._tryToStart())}stopService(){this._canBeStarted=!1,this._isStarted&&this._stop()}_tryToStart(){(0,s.assert)(!this._isStarted,"Execution's service has already started"),this._canBeStarted&&this._initialized&&this._start()}_start(){(0,s.assert)(!this._isStarted,"Execution's service has already started"),this._isStarted=!0,this._dataEvents.symbolResolved().subscribe(this,this._createExecutions),this._dataEvents.symbolError().subscribe(this,this._createExecutions),this._createExecutions()}_stop(){this._isStarted=!1,this._clearExecutions();(0,s.ensure)(this.activeBroker()).executionUpdate.unsubscribeAll(this),this.activeBroker()?.unsubscribeExecutions(this._symbol),this._dataEvents.symbolResolved().unsubscribeAll(this),this._dataEvents.symbolError().unsubscribeAll(this)}_createExecutions(){this._clearExecutions(),this.activeBroker()?.unsubscribeExecutions(this._symbol),this._symbol="";const e=this._getSymbolName();e&&(this._actualTradingSymbolSubscription=this.trading().makeActualSymbolObservable(e)?.subscribe((({symbol:e})=>{e!==this._symbol&&(this.activeBroker()?.unsubscribeExecutions(this._symbol),this._symbol=e,this._requestFormatterAndExecutions())})))}_clearExecutions(){this._actualTradingSymbolSubscription?.unsubscribe(),this._allExecutionsID=new Set,this._executions=[],this._executionsCleared.fire()}async _requestFormatterAndExecutions(){const e=this.activeBroker();if(!e)return;if(!this._symbol)return;if(!(await e.isTradable(this._symbol)).tradable)return
;if(!e.isConnected())return;e.subscribeExecutions(this._symbol);const t=this._symbol;Promise.all([e.formatter(this._symbol,!1),e.executions(this._symbol)]).then((([i,s])=>{this._symbol===t&&(this._formatter=i,this._executions=s.map((e=>this._createExecutionData(e))).filter(n.notNull),this._executionsAdded.fire(this._executions),e.executionUpdate.unsubscribeAll(this),e.executionUpdate.subscribe(this,this._addExecution))}))}_addExecution(e){const t=this._createExecutionData(e);null!==t&&this._executionsAdded.fire([t])}_createExecutionData(e){return e.symbol!==this._symbol||this._allExecutionsID.has(e.id)?null:0===e.qty?(this._logger.logWarn(`An execution has wrong quantity. Data - ${JSON.stringify(e)}`),null):(this._allExecutionsID.add(e.id),{...e,tooltip:(0,c.executionText)(e,this._formatter)})}}},643144:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ExecutionsPointsManager:()=>r});var s=i(333054),o=i(627692);function n(e){return void 0!==e.index}class r{constructor(e,t,i){this._points=[],this._existingExecutionPointsCache=null,this._offsetOfFirstExistingPoint=null,this._existingPointsChanged=new o.Delegate,this._pointsets=[],this._pointsetManagerFactory=t,this._firstSeriesTimePointWV=i,this._firstSeriesTimePointWV.subscribe(this._updateExistingPoints.bind(this)),this._executionsService=e,this._addPoints(this._executionsService.executions()),this._executionsService.executionsAdded().subscribe(this,this._addPoints),this._executionsService.executionsCleared().subscribe(this,this._clearPoints)}destroy(){this._clearPoints(),this._firstSeriesTimePointWV.destroy(),this._executionsService.executionsAdded().unsubscribeAll(this),this._executionsService.executionsCleared().unsubscribeAll(this),this._executionsService.destroy()}existingPoints(){return null===this._offsetOfFirstExistingPoint?[]:(null===this._existingExecutionPointsCache&&(this._existingExecutionPointsCache=this._points.slice(this._offsetOfFirstExistingPoint).filter(n)),this._existingExecutionPointsCache)}existingPointsChanged(){return this._existingPointsChanged}_onExistingStartPointChanged(){this._existingExecutionPointsCache=null,this._existingPointsChanged.fire(this.existingPoints())}_addPoints(e){if(0===e.length)return;const t=function(e){return e.map((e=>{const t=Math.round(e.time/1e3);return{id:e.id,price:e.price,time_t:t,index:void 0,isBuyDirection:1===e.side,tooltip:e.tooltip,qty:e.qty}}))}(e);t.sort(((e,t)=>e.time_t-t.time_t));let i=0;const o=this._points.length>0;o&&(i=(0,s.upperbound)(this._points,t[0].time_t,((e,t)=>t.time_t>e),0)),this._points=this._points.slice(0,i).concat(t).concat(this._points.slice(i));const n=this._firstSeriesTimePointWV.value();null!==this._offsetOfFirstExistingPoint&&null!==n&&t[0].time_t<n?this._offsetOfFirstExistingPoint=this._offsetOfFirstExistingPoint+t.length:((null===this._offsetOfFirstExistingPoint||t[0].time_t<this._points[this._offsetOfFirstExistingPoint].time_t)&&(this._offsetOfFirstExistingPoint=this._calcOffsetOfFirstExistingPoint()),
null!==this._offsetOfFirstExistingPoint&&(o?i>=this._offsetOfFirstExistingPoint&&this._sendPointsToServer(i,i+t.length):this._sendPointsToServer(this._offsetOfFirstExistingPoint,this._points.length)))}_updateExistingPoints(){if(0===this._points.length)return;const e=this._calcOffsetOfFirstExistingPoint();null!==e&&(null===this._offsetOfFirstExistingPoint&&(this._offsetOfFirstExistingPoint=this._points.length),e<this._offsetOfFirstExistingPoint&&(this._sendPointsToServer(e,this._offsetOfFirstExistingPoint),this._offsetOfFirstExistingPoint=e))}_clearPoints(){for(const e of this._pointsets)e.onUpdate().unsubscribeAll(this),e.destroy();this._pointsets=[],this._points=[],this._offsetOfFirstExistingPoint=null,this._onExistingStartPointChanged()}_sendPointsToServer(e,t){const i=this._points.slice(e,t).map((e=>({time_t:e.time_t,offset:0})));if(0===i.length)return;const s=this._pointsetManagerFactory(i);null!==s&&(s.onUpdate().subscribe(this,this._updatePointsFromServer),this._pointsets.push(s))}_updatePointsFromServer(e){if(null===this._offsetOfFirstExistingPoint)return;const t=(0,s.lowerbound)(this._points,e[0].time_t,((e,t)=>e.time_t<t),this._offsetOfFirstExistingPoint);let i=Math.max(this._offsetOfFirstExistingPoint,t);for(const t of e)for(let e=i;e<this._points.length&&(i=e,!(this._points[e].time_t>t.time_t));e++)this._points[e].time_t===t.time_t&&(this._points[e].index=t.index);this._onExistingStartPointChanged()}_calcOffsetOfFirstExistingPoint(){const e=this._firstSeriesTimePointWV.value();return null===e?null:(0,s.upperbound)(this._points,e,((e,t)=>t.time_t>e),0,this._offsetOfFirstExistingPoint||this._points.length)}}},561583:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ExecutionsSource:()=>ue});var s=i(119131),o=i(587060),n=i(484686);class r extends s.CustomSourceBase{constructor(e,t,i,s,o){super(e,t),this._paneViews=[],this._executionsPointsManager=i,this._executionsPointsManager.existingPointsChanged().subscribe(this,this.redraw),this._createPaneViews(),this._getMinTick=s,this._showExecutionLabel=o}async getMinTick(e){return this._getMinTick(e)}redraw(){this.updateAllViews((0,o.sourceChangeEvent)(this.id())),this._model.updateSource(this)}points(){return this._executionsPointsManager.existingPoints()}updateAllViews(e){for(const t of this._paneViews)t.update(e)}paneViews(e){return this._isSourceShouldBeShown(e)?this._paneViews:[]}hoveredExecution(){const e=this._model.hoveredSource()===this&&this._model.lastHittestData()||null;return null===e||void 0===e.activeItem?null:e.activeItem}destroy(){this._executionsPointsManager.existingPointsChanged().unsubscribe(this,this.redraw),this._executionsPointsManager.destroy()}isExecutionLabelVisible(){return this._showExecutionLabel.value()}_isSourceShouldBeShown(e){return!!e.containsMainSeries()&&!(window.TradingView.printing&&!(0,n.isTradingObjVisibleOnScreenshot)())}}var a,l=i(960521),c=i.n(l),u=i(147167),h=i(630787),_=i(583696),d=i(333054),m=i(829609),g=i(613113),p=i(316167);!function(e){e[e.OverlayTransparency=50]="OverlayTransparency"}(a||(a={}))
;const b=m.colorsPalette["color-tv-blue-500"],x=m.colorsPalette["color-ripe-red-500"],f={textColor:m.colorsPalette["color-cold-gray-200"],overlayColor:(0,g.generateColor)(m.colorsPalette["color-cold-gray-900"],50),outlineColor:m.colorsPalette["color-cold-gray-900"]},y={textColor:m.colorsPalette["color-cold-gray-900"],overlayColor:(0,g.generateColor)(m.colorsPalette["color-white"],50),outlineColor:m.colorsPalette["color-white"]};var P=i(650151),v=i(621278),w=i(884684),S=i(721048),C=i(115145),E=i(612930);const T=document.createElement("canvas");T.width=0,T.height=0;const A=(0,P.ensureNotNull)(T.getContext("2d")),k="normal",V="#FFFFFF",M=40,F=12,O=6,D=10,I=18,B=13,H=9,L=8,N=6,R=3,Y=10,W=15.5,q=4,U=19,X=10;class z{constructor(e){this._textWidthCache=new S.TextWidthCache,this._font=(0,v.makeFont)(F,C.CHART_FONT_FAMILY,k),this._data={points:[]},this._onHover=({exPointX:t,exPointY:i,pointX:s,pointY:o,clientX:n,clientY:r,timePointIndex:a,isBuy:l,left:c,right:u,top:h})=>{const _=n-s,d=r-o,m={centerX:t+_,centerY:i+d,leftX:c+_,rightX:u+_,topY:h+d};e.onHover({timePointIndex:a,isBuy:l,spawnPoint:m})}}setData(e){this._data=e}hitTest(e,t){for(const t of[...this._data.points].reverse()){const i=Math.round(t.x),s=Math.round(t.y),o=(this._textWidthCache.measureText(A,t.amount.toString())??0)+I,n=W+q*t.amount,r=i-o/2,a=i+o/2,l=t.arrowUp?s:s-n,c=t.arrowUp?s+n:s;if(e.x>r&&e.x<a&&e.y>l&&e.y<c){const i={activeItem:t.id,equals:e=>e.activeItem===t.id,clickHandler:i=>this._onHover({exPointX:t.x,exPointY:t.y,pointX:e.x,pointY:e.y,clientX:i.clientX,clientY:i.clientY,timePointIndex:t.timePointIndex,isBuy:t.isBuy,left:r,right:a,top:l}),tapHandler:i=>this._onHover({exPointX:t.x,exPointY:t.y,pointX:e.x,pointY:e.y,clientX:i.clientX,clientY:i.clientY,timePointIndex:t.timePointIndex,isBuy:t.isBuy,left:r,right:a,top:l})};return new w.HitTestResult(w.HitTarget.Custom,i)}}return null}draw(e,t){const{horizontalPixelRatio:i,verticalPixelRatio:s}=t,o=I*i,n=q*s,r={arrowHeadOuterWidth:B*i,arrowHeadInnerWidth:H*i,arrowHeadHeight:L*s,arrowHeadWidestPartHeight:N*s,arrowStemWidth:R*i,arrowStemHeight:Y*s,arrowHeight:W*s},a=I*i;for(const t of this._data.points){const l=1===t.amount.toString().length?0:this._textWidthCache.measureText(e,t.amount.toString()),c=t.arrowUp?1:-1,u=Math.round(t.x*i),h=Math.round((t.y+q*c)*s);if(e.save(),t.amount>M){(0,E.drawStackedExecutionArrowWithCounter)({ctx:e,fillStyle:t.arrowColor,strokeStyle:t.outlineColor,isArrowUp:t.arrowUp,pixelRatio:i,isHovered:t.isHovered,x:u,y:h,textWidth:l,arrowDimensions:r,executionCircleDiameter:a});const _=h+(r.arrowHeight+n+o/2)*c;if((0,E.drawText)(e,{horizontalPixelRatio:i,verticalPixelRatio:s},t.amount.toString(),u,_,this._textYMidCorrection(e,t.amount.toString())*c,V,this._font,"center"),t.labelVisibility){const a=h+(r.arrowHeight+n+o+X*s+F)*c;(0,E.drawExecutionLabelText)({ctx:e,centerX:u,centerY:a,pixelRatio:{horizontalPixelRatio:i,verticalPixelRatio:s},text:t.labelText,textMidCorrection:this._textYMidCorrection(e,t.labelText),font:this._font,fillStyle:t.labelColor,strokeStyle:t.outlineColor,
isArrowUp:t.arrowUp})}}else{if(t.isHovered){const s=h+n*c,o=r.arrowHeight/2+t.amount*n,a=U*i;(0,E.drawExecutionArrowBackdrop)({ctx:e,x:u,y:s,height:o,diameter:a,fillStyle:t.arrowColor,isArrowUp:t.arrowUp})}for(let s=0;s<t.amount;s++){const o=h+n*s*c;(0,E.drawStackedExecutionArrow)({ctx:e,fillStyle:t.arrowColor,strokeStyle:t.outlineColor,x:u,y:o,isArrowUp:t.arrowUp,pixelRatio:i,isHovered:t.isHovered,arrowDimensions:r})}if(t.labelVisibility){const o=X*s,a=h+(n*t.amount+r.arrowHeight+o)*c;(0,E.drawExecutionLabelText)({ctx:e,centerX:u,centerY:a,pixelRatio:{horizontalPixelRatio:i,verticalPixelRatio:s},text:t.labelText,textMidCorrection:this._textYMidCorrection(e,t.labelText),font:this._font,fillStyle:t.labelColor,strokeStyle:t.outlineColor,isArrowUp:t.arrowUp})}}if(e.restore(),this._data.executionEntryPoint){e.save();const t=Math.round((this._data.executionEntryPoint.x-O/2)*i),o=Math.round(this._data.executionEntryPoint.y*s),n=Math.max(1,Math.round(D*i)),r=Math.max(1,Math.round(O*s));(0,E.drawOutlinedArrowHead)(e,t,o,this._data.executionEntryPoint.arrowColor,this._data.executionEntryPoint.outlineColor,n,r,i,this._data.executionEntryPoint.isBuyDirection?90:270),e.restore()}}}_textYMidCorrection(e,t){if(!t)return 0;const i=e.font;e.font=(0,P.ensureNotNull)(this._font);const s=Math.ceil(this._textWidthCache.yMidCorrection(e,t));return e.font=i,s}}var G=i(50959),j=i(632227),$=i(609838),J=i(497754),K=i.n(J),Q=i(152601),Z=i(563859),ee=i(733234),te=i(851310),ie=i(369625);const se=$.t(null,void 0,i(169961)),oe=$.t(null,void 0,i(168222));const ne=(0,G.memo)((e=>{const[t,i]=G.useState(0);return G.createElement(Q.PopoverKeyboardNavigator,{refToContentWrapperElement:t=>i(function(e,t){const i=e<document.body.clientHeight-t?e:e-t;return i>0?i:0}(e.spawnPoint.topY,t?.clientHeight||0)),isOpen:!0,onClose:e.onClose,anchored:{type:"rectangle",at:{x:(s=e.spawnPoint.centerX,o=e.spawnPoint.leftX,n=e.spawnPoint.rightX,s<document.documentElement.clientWidth-300-8-(n-o)?n+8:o-300-8),y:t,width:1,height:1}},closeOnClickAway:!0,closeOnEscape:!0,anchorPositionerCardAppearanceClassname:K()(ie.container,e.buy?ie.blueStripe:ie.redStripe),mobilePositionerCardAppearanceClassname:K()(ie.container,e.buy?ie.blueStripe:ie.redStripe)},G.createElement("div",{className:ie.title},G.createElement("span",{className:K()(ie.counter,e.buy?ie.blueCounter:ie.redCounter)},e.executions.length),G.createElement("span",{className:ie.descriptor},e.buy?se:oe)),e.executions.length>1&&G.createElement("div",{className:ie.subtitle},G.createElement("span",null,function(){let t=0,i=(0,u.numOfDecimalPlaces)(e.executions[0].qty);for(const s of e.executions){t+=s.qty;const e=(0,u.numOfDecimalPlaces)(s.qty);e>i&&(i=e)}return(0,Z.abbreviatedNumber)(Number(c()(t).toFixed(i)))}()," @ ",function(){let t=0,i=0;for(const s of e.executions)t+=s.price*s.qty,i+=s.qty;return e.formatPrice(c()(t).div(i).toNumber())}()," avg price")),G.createElement((function(){const t=e.executions.some((t=>e.formatPrice(t.price).toString().length+t.qty.toString().length>15))
;return G.createElement(G.Fragment,null,e.executions.length>1&&G.createElement("div",{className:ie.tableTitle},"TRADES"),G.createElement("table",{className:ie.table},G.createElement("tbody",null,function(t){return e.executions.map((i=>{const s=(o=i.timestamp,new Intl.DateTimeFormat((0,ee.getLocaleIso)(),{weekday:"short",day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit",hour12:!1}).format(new Date(1e3*o)).replaceAll(",",""));var o;const n=(0,te.appendEllipsis)(s.slice(0,5)),r=t?n:s;return G.createElement("tr",{className:ie.tableRow,key:i.id},G.createElement("td",{className:K()(ie.units,ie.tableCell)},(0,Z.abbreviatedNumber)(i.qty)),G.createElement("td",{className:K()(ie.atDecoration,ie.tableCell)},"@"),G.createElement("td",{className:K()(ie.price,ie.tableCell)},e.formatPrice(i.price)),G.createElement("td",{className:K()(ie.date,ie.tableCell)},r))}))}(t))))}),null));var s,o,n}));const re=document.createElement("div");var ae=i(144421);class le{constructor(e,t){this._invalidated=!0,this._currentMountedExecutionPopover=null,this._pointsGroupMap=new Map,this._showExecutionPopover=async({timePointIndex:e,isBuy:t,spawnPoint:i})=>{const s=await this._makeExecutionLabelsFromTimePointIndex(e,t);if(null!==s&&(null===this._currentMountedExecutionPopover||this._currentMountedExecutionPopover!==ce(e,t))){this._chartModel.mainSeries().dataEvents().symbolResolved().subscribe(this,this._hideExecutionPopover);const o=this._chartModel.mainSeries().symbolInfo()?.fractional?e=>this._formatFractionalPrice(e):e=>this._formatPriceByMinTick(e);!function({buy:e,executions:t,onClose:i,spawnPoint:s,formatPrice:o}){j.render(G.createElement(ne,{spawnPoint:s,buy:e,executions:t,onClose:i,formatPrice:o}),re)}({buy:t,onClose:this._hideExecutionPopover,executions:s,spawnPoint:i,formatPrice:o}),this._currentMountedExecutionPopover=ce(e,t)}},this._hideExecutionPopover=()=>{null!==this._currentMountedExecutionPopover&&(this._chartModel.mainSeries().dataEvents().symbolResolved().unsubscribe(this,this._hideExecutionPopover),j.unmountComponentAtNode(re),this._currentMountedExecutionPopover=null)},this._chartModel=e,this._source=t,this._renderer=new z({onHover:this._showExecutionPopover}),this._minTick=1/this._chartModel.mainSeries().base()}update(){this._invalidated=!0}renderer(){return this._invalidated&&(this._updateImpl(),this._invalidated=!1),this._renderer}_updateImpl(){this._renderer.setData({points:[]});const e=this._getVisiblePoints();if(null===e)return;this._updateMinTick();const t=this._createRenderData(e);this._renderer.setData(t)}async _updateMinTick(){const e=await this._source.getMinTick(this._chartModel.mainSeries().symbol());(0,ae.isNumber)(e)&&(this._minTick=e)}_createRenderData(e){let t,i;this._pointsGroupMap.clear();const s=this._isPriceScaleInverted(),o=this._styleGetter();for(const t of e){const e=this._pointsGroupMap.get(ce(t.index,t.isBuyDirection));e?this._pointsGroupMap.set(ce(t.index,t.isBuyDirection),[...e,t]):this._pointsGroupMap.set(ce(t.index,t.isBuyDirection),[t]),this._source.hoveredExecution()===t.id&&(i=t)}
const n=[];for(const e of this._pointsGroupMap.values()){let t=0,r=0,a=(0,u.numOfDecimalPlaces)(e[0].qty);for(const i of e){t+=i.price*i.qty,r+=i.qty;const e=(0,u.numOfDecimalPlaces)(i.qty);e>a&&(a=e)}const l=this._chartModel.mainSeries().symbolInfo()?.fractional?e=>this._formatFractionalPrice(e):e=>this._formatPriceByMinTick(e),h=e[0],_=l(c()(t).div(r).toNumber()),d=c()(r).toFixed(a),m=this._getXCoordinate(h.index),g=this._getYCoordinate(h.index,h.isBuyDirection);null!==m&&null!==g&&n.push({id:h.id,x:m,y:g,amount:e.length,arrowUp:h.isBuyDirection!==s,arrowColor:h.isBuyDirection?o.buyArrowColor:o.sellArrowColor,outlineColor:o.outlineColor,timePointIndex:h.index,isHovered:void 0!==e.find((e=>e.id===i?.id)),labelColor:o.textColor,labelText:`${d}\n@ ${_}`,labelVisibility:this._source.isExecutionLabelVisible(),isBuy:h.isBuyDirection})}if(i){const e=this._pointsGroupMap.get(ce(i.index,i.isBuyDirection));if(e){const n=this._getXCoordinate(i.index);let r=0,a=0;for(const t of e)r+=t.price*t.qty,a+=t.qty;const l=c()(r).div(a).toNumber(),u=this._priceToCoordinate(l);null!==n&&null!==u&&(t={x:n,y:u,arrowColor:i.isBuyDirection?o.buyArrowColor:o.sellArrowColor,outlineColor:o.outlineColor,isBuyDirection:i.isBuyDirection!==s})}}return{points:n,executionEntryPoint:t}}_getXCoordinate(e){const t=this._chartModel.mainSeries().bars().lastIndex();return null===t||e>t?null:this._chartModel.timeScale().indexToCoordinate(e)}_getYCoordinate(e,t){let i=null;const s=this._chartModel.mainSeries(),o=s.priceSource(),n=null!==o?o:t?"low":"high",r=(0,h.barFunction)(n),a=s.nearestData(e,_.PlotRowSearchMode.NearestLeft);if(void 0!==a){const e=r(a.value);Number.isNaN(e)||(i=this._priceToCoordinate(e))}return i}_priceToCoordinate(e){const t=this._chartModel.mainSeries(),i=t.firstValue();return i?t.priceScale().priceToCoordinate(e,i):null}_isPriceScaleInverted(){return this._chartModel.mainSeries().priceScale().isInverted()}_styleGetter(){return function(e){const t=e?f:y,{textColor:i,outlineColor:s}=t,o=(0,p.blendColors)(b,t.overlayColor),n=(0,p.blendColors)(x,t.overlayColor);return{buyArrowColor:b,sellArrowColor:x,inactiveBuyArrowColor:o,inactiveSellArrowColor:n,textColor:i,outlineColor:s}}(this._chartModel.dark().value())}_getVisiblePoints(){const e=this._chartModel.timeScale().visibleBarsStrictRange();if(null===e)return null;const t=this._source.points();if(0===t.length)return null;const i=(0,d.lowerbound)(t,e.firstBar(),((e,t)=>e.index<t),0),s=(0,d.upperbound)(t,e.lastBar(),((e,t)=>t.index>e),i);return i>=s?null:t.slice(i,s)}_formatPriceByMinTick(e){return new(c())(e).toFixed((0,u.numOfDecimalPlaces)(this._minTick))}_formatFractionalPrice(e){return this._chartModel.mainSeries().priceScale().formatPriceAbsolute(e)}_makeExecutionLabelsFromTimePointIndex(e,t){const i=[],s=this._getVisiblePoints();if(null===s)return null;for(const o of s)o.index===e&&o.isBuyDirection===t&&i.push({price:o.price,qty:o.qty,timestamp:o.time_t,id:o.id});return i}}function ce(e,t){return`${e} ${t?"buy":"sell"}`}class ue extends r{constructor(e,t,i,s,o,n){
super(e,t,o,n,i.labelVisibility),this._showExecutions=i.arrowVisibility,this._globalVisibility=s,this._globalVisibility.subscribe(this.redraw.bind(this))}destroy(){super.destroy(),this._showExecutions.destroy(),this._globalVisibility.unsubscribe()}_createPaneViews(){this._paneViews=[new le(this._model,this)]}_isSourceShouldBeShown(e){return!!this._globalVisibility.value()&&(!!this._showExecutions.value()&&super._isSourceShouldBeShown(e))}}},221824:(e,t,i)=>{"use strict";i.r(t),i.d(t,{TradedItemsChartCollectionFacade:()=>a});var s=i(650151),o=i(917053),n=i(884684),r=i(986775);class a{constructor(e){this._chartWidgetCollection=e}dropHoveredItem(){this._activeWidgetChartModel().setHoveredSource(null,null)}setHoveredItem(e){this._setItemState(e,((e,t)=>{this._activeWidgetChartModel().setHoveredSource(e,t)}))}setSelectedItem(e){this._setItemState(e,((e,t)=>{this._activeWidgetChartModel().selectionMacro((i=>{if(e)i.clearSelection(),i.addSourceToSelection(e,t);else{i.selection().customSources().find(r.isTradedGroupCustomSource)&&i.clearSelection()}}))}))}_setItemState(e,t){const{source:i,item:s}=this._findSourceAndItem(e.id,e.type);if(!i||!s)return void t(null,null);t(i,new n.HitTestResult(n.HitTarget.Custom,{activeItem:{id:s.id(),part:9}}).data())}_activeWidgetChartModel(){return(0,s.ensureNotNull)(this._chartWidgetCollection.activeChartWidget.value()).model().model()}_findSourceAndItem(e,t){for(const i of this._activeWidgetChartModel().customSources(o.CustomSourceLayer.Topmost))if((0,r.isTradedGroupCustomSource)(i)){const s=i.findItemWithType(e,t);if(s)return{source:i,item:s}}return{}}}},118875:(e,t,i)=>{"use strict";i.r(t),i.d(t,{BidAsk:()=>x,BidAskPrice:()=>p});var s=i(650151),o=i(144421),n=i(122998),r=i(119131),a=i(885861);class l extends a.PriceLineAxisView{constructor(e,t,i){super(),this._model=e,this._source=t,this._priceType=i}_value(){const e=this._model.mainSeries(),t=e.priceScale(),i=e.firstValue();if(null===i)return{noData:!0};const s=this._source.getPrice(this._priceType);if(null===s)return{noData:!0};const o=t.priceToCoordinate(s,i);return{noData:!1,floatCoordinate:o,coordinate:o,color:"",formattedPricePercentage:"",formattedPriceAbsolute:"",formattedPriceIndexedTo100:"",text:"",index:0}}_priceLineColor(e){const t=this._source.properties().childs();return 0===this._priceType?t.bidLineColor.value():t.askLineColor.value()}_lineWidth(){return this._source.properties().childs().lineWidth.value()}_lineStyle(){return this._source.properties().childs().lineStyle.value()}_isVisible(){return this._source.properties().childs().visible.value()}}var c=i(609838),u=i(814624),h=i(613113);class _ extends u.PriceAxisView{constructor(e,t,i){super(),this._model=e,this._source=t,this._priceType=i}_updateRendererData(e,t,s){if(e.visible=!1,t.visible=!1,!this._model.properties().childs().scalesProperties.childs().showBidAskLabels.value())return;const o=this._model.mainSeries(),n=o.priceScale(),r=o.firstValue();if(null===r)return;const a=this._source.getPrice(this._priceType);if(null===a)return
;const l=this._source.properties().childs(),u=0===this._priceType?(0,h.resetTransparency)(l.bidLineColor.value()):(0,h.resetTransparency)(l.askLineColor.value());e.visible=!0,t.visible=!0,e.text=n.formatPriceAbsolute(a),t.text=0===this._priceType?c.t(null,void 0,i(395506)):c.t(null,void 0,i(535928)),s.coordinate=n.priceToCoordinate(a,r),s.background=u,s.textColor=this.generateTextColor(u)}}var d=i(695962),m=i(884684);class g extends d.HorizontalLinePaneView{constructor(e,t,i,s){super(),this._model=e,this._source=t,this._priceType=i;const o={doubleClickHandler:s,doubleTapHandler:s};this._lineRenderer.setHitTest(new m.HitTestResult(m.HitTarget.Regular,o))}_updateImpl(){const e=this._lineRendererData;e.visible=!1;const t=this._source.properties().childs();if(!t.visible.value())return;const i=this._model.mainSeries(),s=i.priceScale(),o=i.firstValue();if(null===o)return;const n=this._source.getPrice(this._priceType);null!==n&&(e.visible=!0,e.y=s.priceToCoordinate(n,o),e.linestyle=t.lineStyle.value(),e.linewidth=t.lineWidth.value(),e.color=0===this._priceType?t.bidLineColor.value():t.askLineColor.value())}}var p,b=i(587060);!function(e){e[e.Bid=0]="Bid",e[e.Ask=1]="Ask"}(p||(p={}));class x extends r.CustomSourceBase{constructor(e,t,i,s){super(e,t),this._ask=null,this._bid=null,this._symbol=null,this._realtimeProvider=i,this._bidLinesPaneView=new g(t,this,0,s),this._askLinesPaneView=new g(t,this,1,s),this._bidPriceAxisView=new _(t,this,0),this._askPriceAxisView=new _(t,this,1),this._regularPriceAxisViews=[this._bidPriceAxisView,this._askPriceAxisView],this._bidLabelPaneView=new n.PanePriceAxisView(this._bidPriceAxisView,t.mainSeries(),t),this._askLabelPaneView=new n.PanePriceAxisView(this._askPriceAxisView,t.mainSeries(),t),this._bidPriceLineAxisView=new l(t,this,0),this._askPriceLineAxisView=new l(t,this,1),this._externalPriceAxisViews=[this._bidPriceLineAxisView,this._askPriceLineAxisView],this._updateRealtimeDataHandler=this._updateRealtimeData.bind(this);const o=t.mainSeries().dataEvents();o.symbolResolved().subscribe(this,this._createTradedSymbol),o.symbolError().subscribe(this,this._createTradedSymbol),this._hibernated=t.collapsed().spawn(),this._hibernated.subscribe((e=>{e?this._clearTradedSymbol():this._createTradedSymbol()})),this._createTradedSymbol()}destroy(){const e=this._model.mainSeries().dataEvents();e.symbolResolved().unsubscribeAll(this),e.symbolError().unsubscribeAll(this),this._hibernated.destroy(),this._clearTradedSymbol()}paneViews(e){return this._areViewsAvailableForPane(e)?[this._bidLinesPaneView,this._askLinesPaneView]:[]}labelPaneViews(e){return this._areViewsAvailableForPane(e)?[this._bidLabelPaneView,this._askLabelPaneView]:[]}priceAxisViews(e,t){return this._areViewsAvailableForPane(e)?e.findTargetPriceAxisViews(this,t,this._regularPriceAxisViews,this._externalPriceAxisViews):[]}priceScale(){return this._model.mainSeries().priceScale()}updateAllViews(e){this._bidLinesPaneView.update(e),this._askLinesPaneView.update(e),this._bidPriceAxisView.update(e),this._askPriceAxisView.update(e),
this._bidPriceLineAxisView.update(e),this._askPriceLineAxisView.update(e),this._bidLabelPaneView.update(e),this._askLabelPaneView.update(e)}getPrice(e){return 1===e?this._ask:this._bid}properties(){return this._model.mainSeries().properties().childs().bidAsk}_createTradedSymbol(){const e=function(e){if(e.isConvertedToOtherCurrency()||e.isConvertedToOtherUnit())return null;const t=e.symbolInfo();return null===t?e.proSymbol():t.pro_name||t.full_name||t.name||null}(this._model.mainSeries());e!==this._symbol&&(this._clearTradedSymbol(),null===e||this._hibernated.value()||this._initTradedSymbol(e))}_initTradedSymbol(e){this._symbol=e,this._realtimeProvider.subscribeRealtime(this._symbol,this._updateRealtimeDataHandler)}_clearTradedSymbol(){this._ask=null,this._bid=null,null!==this._symbol&&(this._realtimeProvider.unsubscribeRealtime((0,s.ensureNotNull)(this._symbol),this._updateRealtimeDataHandler),this._symbol=null)}_updateRealtimeData(e,t,i){const s=t.ask,n=t.bid;s===n?(this._ask=null,this._bid=null):((0,o.isNumber)(s)&&(this._ask=s),(0,o.isNumber)(n)&&(this._bid=n)),(this._model.mainSeries().properties().childs().bidAsk.childs().visible.value()||this._model.properties().childs().scalesProperties.childs().showBidAskLabels.value())&&(this.updateAllViews((0,b.sourceChangeEvent)(this.id())),this._model.updateSource(this))}_areViewsAvailableForPane(e){return!this._model.isInReplay().value()&&this._model.paneForSource(this._model.mainSeries())===e}}}}]);