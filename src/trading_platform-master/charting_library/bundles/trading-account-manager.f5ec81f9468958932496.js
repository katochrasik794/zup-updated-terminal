(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[8354,9937],{662093:e=>{e.exports={wrapper:"wrapper-GZajBGIm",input:"input-GZajBGIm",view:"view-GZajBGIm",danger:"danger-GZajBGIm"}},503260:e=>{e.exports={box:"box-ywH2tsV_",noOutline:"noOutline-ywH2tsV_",disabled:"disabled-ywH2tsV_","intent-danger":"intent-danger-ywH2tsV_",checked:"checked-ywH2tsV_",check:"check-ywH2tsV_",icon:"icon-ywH2tsV_",dot:"dot-ywH2tsV_",disableActiveStyles:"disableActiveStyles-ywH2tsV_"}},11327:e=>{e.exports={checkbox:"checkbox-vyj6oJxw",reverse:"reverse-vyj6oJxw",label:"label-vyj6oJxw",baseline:"baseline-vyj6oJxw"}},737643:e=>{e.exports={pair:"pair-ocURKVwI",xxceptionallysmalldonotusebrv1023:"xxceptionallysmalldonotusebrv1023-ocURKVwI",xxxxsmall:"xxxxsmall-ocURKVwI",xxxsmall:"xxxsmall-ocURKVwI",xxsmall:"xxsmall-ocURKVwI",xsmall:"xsmall-ocURKVwI",small:"small-ocURKVwI",medium:"medium-ocURKVwI",large:"large-ocURKVwI",xlarge:"xlarge-ocURKVwI",xxlarge:"xxlarge-ocURKVwI",xxxlarge:"xxxlarge-ocURKVwI",logo:"logo-ocURKVwI",skeleton:"skeleton-ocURKVwI",empty:"empty-ocURKVwI"}},210667:e=>{e.exports={arrow:"arrow-uDVcbwtB"}},878569:e=>{e.exports={description:"description-dQscsfnR","with-select":"with-select-dQscsfnR","description-strong":"description-strong-dQscsfnR","size-xsmall":"size-xsmall-dQscsfnR"}},264961:e=>{e.exports={"numbers-wrapper":"numbers-wrapper-KCq6gqzR","fake-numbers":"fake-numbers-KCq6gqzR",dots:"dots-KCq6gqzR","fake-numbers-inner":"fake-numbers-inner-KCq6gqzR",numbers:"numbers-KCq6gqzR",numbersOnTop:"numbersOnTop-KCq6gqzR",compact:"compact-KCq6gqzR","numbers-end-slot":"numbers-end-slot-KCq6gqzR",number:"number-KCq6gqzR","size-xsmall":"size-xsmall-KCq6gqzR","size-small":"size-small-KCq6gqzR","size-medium":"size-medium-KCq6gqzR","position-center":"position-center-KCq6gqzR","description-position-center":"description-position-center-KCq6gqzR",numbersRow:"numbersRow-KCq6gqzR",hideNumbers:"hideNumbers-KCq6gqzR"}},685463:e=>{e.exports={pagination:"pagination-iiQKH8Zr","pagination-group":"pagination-group-iiQKH8Zr",select:"select-iiQKH8Zr","compact-middle-slot":"compact-middle-slot-iiQKH8Zr"}},205808:e=>{e.exports={menuWrap:"menuWrap-Kq3ruQo8",isMeasuring:"isMeasuring-Kq3ruQo8",scrollWrap:"scrollWrap-Kq3ruQo8",momentumBased:"momentumBased-Kq3ruQo8",menuBox:"menuBox-Kq3ruQo8",isHidden:"isHidden-Kq3ruQo8"}},950485:e=>{e.exports={squareTabButton:"squareTabButton-huvpscfz",selected:"selected-huvpscfz",disableActiveStateStyles:"disableActiveStateStyles-huvpscfz",disabled:"disabled-huvpscfz",disableFocusOutline:"disableFocusOutline-huvpscfz",xlarge:"xlarge-huvpscfz",tabHiddenContent:"tabHiddenContent-huvpscfz",medium:"medium-huvpscfz",small:"small-huvpscfz",xsmall:"xsmall-huvpscfz",fake:"fake-huvpscfz",verticalTabsWrapper:"verticalTabsWrapper-huvpscfz",verticalButton:"verticalButton-huvpscfz",content:"content-huvpscfz",tabContent:"tabContent-huvpscfz",endSlotInDisclosure:"endSlotInDisclosure-huvpscfz"}},57173:e=>{e.exports={arrowIcon:"arrowIcon-nV6fm1zO",dropped:"dropped-nV6fm1zO"}},153666:e=>{e.exports={
"css-value-square-tabs-xsmall-gap":"4px","css-value-square-tabs-small-gap":"8px","css-value-square-tabs-medium-gap":"12px","css-value-square-tabs-xlarge-gap":"12px"}},661067:e=>{e.exports={scrollWrap:"scrollWrap-mf1FlhVw",overflowScroll:"overflowScroll-mf1FlhVw",squareTabs:"squareTabs-mf1FlhVw",overflowWrap:"overflowWrap-mf1FlhVw",content:"content-mf1FlhVw",verticalContent:"verticalContent-mf1FlhVw",vertical:"vertical-mf1FlhVw",xsmall:"xsmall-mf1FlhVw",squareTabButton:"squareTabButton-mf1FlhVw",startSlotWrap:"startSlotWrap-mf1FlhVw",endSlotWrap:"endSlotWrap-mf1FlhVw",endUpperSlot:"endUpperSlot-mf1FlhVw",startSlotWrapIconOnly:"startSlotWrapIconOnly-mf1FlhVw",small:"small-mf1FlhVw",medium:"medium-mf1FlhVw",xlarge:"xlarge-mf1FlhVw",squareTabCounter:"squareTabCounter-mf1FlhVw"}},408323:(e,t,s)=>{"use strict";s.d(t,{CheckboxInput:()=>u});var i=s(50959),n=s(497754),o=s.n(n),r=s(800417),a=s(611031),l=s(662093),c=s.n(l);function u(e){const t=o()(c().wrapper,e.className);return i.createElement("span",{className:t,title:e.title,style:e.style},i.createElement("input",{id:e.id,tabIndex:e.tabIndex,className:o()(e.intent&&c()[e.intent],c().input),type:"checkbox",name:e.name,checked:e.checked,disabled:e.disabled,value:e.value,autoFocus:e.autoFocus,role:e.role,onChange:function(){e.onChange?.(e.value)},ref:e.reference,"aria-required":e["aria-required"],"aria-describedby":e["aria-describedby"],"aria-invalid":e["aria-invalid"],"data-qa-id":e.dataQaId,...(0,r.filterDataProps)(e)}),i.createElement(a.CheckboxView,{className:c().view,indeterminate:e.indeterminate,checked:e.checked,disabled:e.disabled,intent:e.intent,tabIndex:e.tabIndex}))}},611031:(e,t,s)=>{"use strict";s.d(t,{CheckboxView:()=>d});var i=s(50959),n=s(497754),o=s.n(n),r=s(878112),a=s(465890),l=s.n(a),c=s(503260),u=s.n(c);function d(e){const{indeterminate:t,checked:s,tabIndex:n,className:a,disabled:c,disableActiveStyles:d,intent:h,hideIcon:p,...m}=e,g=t||!s||p?"":l(),_=o()(u().box,u()[`intent-${h}`],!t&&u().check,!!t&&u().dot,-1===n&&u().noOutline,a,s&&u().checked,c&&u().disabled,d&&u().disableActiveStyles);return i.createElement("span",{className:_,...m},i.createElement(r.Icon,{icon:g,className:u().icon}))}},302946:(e,t,s)=>{"use strict";s.d(t,{Checkbox:()=>u,CheckboxView:()=>d.CheckboxView});var i=s(50959),n=s(497754),o=s.n(n),r=s(230789),a=s(408323),l=s(11327),c=s.n(l);class u extends i.PureComponent{render(){const{inputClassName:e,labelClassName:t,...s}=this.props,n=o()(this.props.className,c().checkbox,{[c().reverse]:Boolean(this.props.labelPositionReverse),[c().baseline]:Boolean(this.props.labelAlignBaseline)}),r=o()(c().label,t,{[c().disabled]:this.props.disabled});let l=null;return this.props.label&&(l=i.createElement("span",{className:r,title:this.props.title},this.props.label)),i.createElement("label",{className:n},i.createElement(a.CheckboxInput,{...s,className:e}),l)}}u.defaultProps={value:"on"};(0,r.makeSwitchGroupItem)(u);var d=s(611031)},72903:(e,t,s)=>{"use strict";s.d(t,{CircleLogoPair:()=>o});var i=s(50959),n=s(108937);function o(e){
const{primaryLogoUrl:t,secondaryLogoUrl:s,size:o,className:a}=e;return i.createElement("span",{className:(0,n.getBlockStyleClasses)(o,a),title:e.title},i.createElement(r,{logoUrl:s,size:o}),i.createElement(r,{logoUrl:t,size:o}))}function r(e){const{logoUrl:t,size:s}=e,o=void 0!==t,[r,a]=(0,i.useState)(0),l=(0,i.useRef)(null),c=(0,n.getLogoStyleClasses)(s,r);return(0,i.useEffect)((()=>a(l.current?.complete??!o?2:1)),[o]),o&&3!==r?i.createElement("img",{ref:l,className:c,crossOrigin:"",src:t,alt:"",onLoad:()=>a(2),onError:()=>a(3)}):i.createElement("span",{className:c})}},108937:(e,t,s)=>{"use strict";s.d(t,{getBlockStyleClasses:()=>l,getLogoStyleClasses:()=>c});var i=s(497754),n=s.n(i),o=s(92318),r=s(737643),a=s.n(r);function l(e,t){return n()(a().pair,a()[e],t)}function c(e,t=2,s=!0){return n()(a().logo,a()[e],a().skeleton,o.skeletonTheme.wrapper,!s&&a().empty,1===t&&n()(o.skeletonTheme.animated))}},813550:(e,t,s)=>{"use strict";s.d(t,{useForceUpdate:()=>n});var i=s(50959);const n=()=>{const[,e]=(0,i.useReducer)((e=>e+1),0);return e}},975228:(e,t,s)=>{"use strict";s.d(t,{hoverMouseEventFilter:()=>r,useAccurateHover:()=>a,useHover:()=>n,useHoverDeprecated:()=>o});var i=s(50959);function n(){const[e,t]=(0,i.useState)(!1);return[e,{onMouseEnter:function(e){t(!0)},onMouseLeave:function(e){t(!1)}}]}function o(){const[e,t]=(0,i.useState)(!1);return[e,{onMouseOver:function(e){r(e)&&t(!0)},onMouseOut:function(e){r(e)&&t(!1)}}]}function r(e){return!e.currentTarget.contains(e.relatedTarget)}function a(e){const[t,s]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const t=t=>{if(null===e.current)return;const i=e.current.contains(t.target);s(i)};return document.addEventListener("mouseover",t),()=>document.removeEventListener("mouseover",t)}),[]),t}},778199:(e,t,s)=>{"use strict";function i(e,t,s,i,n){function o(n){if(e>n.timeStamp)return;const o=n.target;void 0!==s&&null!==t&&null!==o&&o.ownerDocument===i&&(t.contains(o)||s(n))}return n.click&&i.addEventListener("click",o,!1),n.mouseDown&&i.addEventListener("mousedown",o,!1),n.touchEnd&&i.addEventListener("touchend",o,!1),n.touchStart&&i.addEventListener("touchstart",o,!1),()=>{i.removeEventListener("click",o,!1),i.removeEventListener("mousedown",o,!1),i.removeEventListener("touchend",o,!1),i.removeEventListener("touchstart",o,!1)}}s.d(t,{addOutsideEventListener:()=>i})},908783:(e,t,s)=>{"use strict";s.d(t,{useOutsideEvent:()=>r});var i=s(50959),n=s(855393),o=s(778199);function r(e){const{click:t,mouseDown:s,touchEnd:r,touchStart:a,handler:l,reference:c}=e,u=(0,i.useRef)(null),d=(0,i.useRef)("undefined"==typeof window?0:new window.CustomEvent("timestamp").timeStamp);return(0,n.useIsomorphicLayoutEffect)((()=>{const e={click:t,mouseDown:s,touchEnd:r,touchStart:a},i=c?c.current:u.current;return(0,o.addOutsideEventListener)(d.current,i,l,document,e)}),[t,s,r,a,l]),c||u}},823030:(e,t,s)=>{"use strict";s.d(t,{SubmenuContext:()=>n,SubmenuHandler:()=>o});var i=s(50959);const n=i.createContext(null);function o(e){const[t,s]=(0,i.useState)(null),o=(0,i.useRef)(null),r=(0,i.useRef)(new Map)
;return(0,i.useEffect)((()=>()=>{null!==o.current&&clearTimeout(o.current)}),[]),i.createElement(n.Provider,{value:{current:t,setCurrent:function(e){null!==o.current&&(clearTimeout(o.current),o.current=null);null===t?s(e):o.current=setTimeout((()=>{o.current=null,s(e)}),100)},registerSubmenu:function(e,t){return r.current.set(e,t),()=>{r.current.delete(e)}},isSubmenuNode:function(e){return Array.from(r.current.values()).some((t=>t(e)))}}},e.children)}},730654:(e,t,s)=>{"use strict";s.d(t,{Portal:()=>c,PortalContext:()=>u});var i=s(50959),n=s(632227),o=s(925931),r=s(801808),a=s(481564),l=s(682925);class c extends i.PureComponent{constructor(){super(...arguments),this._uuid=(0,o.nanoid)()}componentWillUnmount(){this._manager().removeWindow(this._uuid)}render(){const e=this._manager().ensureWindow(this._uuid,this.props.layerOptions);e.style.top=this.props.top||"",e.style.bottom=this.props.bottom||"",e.style.left=this.props.left||"",e.style.right=this.props.right||"",e.style.pointerEvents=this.props.pointerEvents||"";const t=this.props.className;return t&&("string"==typeof t?e.classList.add(t):e.classList.add(...t)),this.props.shouldTrapFocus&&!e.hasAttribute(a.FOCUS_TRAP_DATA_ATTRIBUTE)&&e.setAttribute(a.FOCUS_TRAP_DATA_ATTRIBUTE,"true"),this.props["aria-hidden"]&&e.setAttribute("aria-hidden","true"),n.createPortal(i.createElement(u.Provider,{value:this},this.props.children),e)}moveToTop(){this._manager().moveToTop(this._uuid)}_manager(){return null===this.context?(0,r.getRootOverlapManager)():this.context}}c.contextType=l.SlotContext;const u=i.createContext(null)},682925:(e,t,s)=>{"use strict";s.d(t,{Slot:()=>n,SlotContext:()=>o});var i=s(50959);class n extends i.Component{shouldComponentUpdate(){return!1}render(){return i.createElement("div",{style:{position:"fixed",zIndex:150,left:0,top:0},ref:this.props.reference})}}const o=i.createContext(null)},230789:(e,t,s)=>{"use strict";s.d(t,{SwitchGroup:()=>r,makeSwitchGroupItem:()=>a});var i=s(50959),n=s(755883);const o=(0,i.createContext)({getName:()=>"",getValues:()=>[],getOnChange:()=>n.default,subscribe:n.default,unsubscribe:n.default});class r extends i.PureComponent{constructor(e){super(e),this._subscriptions=new Set,this._getName=()=>this.props.name,this._getValues=()=>this.props.values,this._getOnChange=()=>this.props.onChange,this._subscribe=e=>{this._subscriptions.add(e)},this._unsubscribe=e=>{this._subscriptions.delete(e)},this.state={switchGroupContext:{getName:this._getName,getValues:this._getValues,getOnChange:this._getOnChange,subscribe:this._subscribe,unsubscribe:this._unsubscribe}}}render(){return i.createElement(o.Provider,{value:this.state.switchGroupContext},this.props.children)}componentDidUpdate(e){this._notify(this._getUpdates(this.props.values,e.values))}_notify(e){this._subscriptions.forEach((t=>t(e)))}_getUpdates(e,t){return[...t,...e].filter((s=>t.includes(s)?!e.includes(s):e.includes(s)))}}function a(e){var t;return t=class extends i.PureComponent{constructor(){super(...arguments),this._onChange=e=>{this.context.getOnChange()(e)},
this._onUpdate=e=>{e.includes(this.props.value)&&this.forceUpdate()}}componentDidMount(){this.context.subscribe(this._onUpdate)}render(){return i.createElement(e,{...this.props,name:this._getName(),onChange:this._onChange,checked:this._isChecked()})}componentWillUnmount(){this.context.unsubscribe(this._onUpdate)}_getName(){return this.context.getName()}_isChecked(){return this.context.getValues().includes(this.props.value)}},t.contextType=o,t}},801808:(e,t,s)=>{"use strict";s.d(t,{OverlapManager:()=>r,getRootOverlapManager:()=>l});var i=s(650151),n=s(481564);class o{constructor(){this._storage=[]}add(e){this._storage.push(e)}remove(e){this._storage=this._storage.filter((t=>e!==t))}has(e){return this._storage.includes(e)}getItems(){return this._storage}}class r{constructor(e=document){this._storage=new o,this._windows=new Map,this._index=0,this._document=e,this._container=e.createDocumentFragment()}setContainer(e){const t=this._container,s=null===e?this._document.createDocumentFragment():e;!function(e,t){Array.from(e.childNodes).forEach((e=>{e.nodeType===Node.ELEMENT_NODE&&t.appendChild(e)}))}(t,s),this._container=s}registerWindow(e){this._storage.has(e)||this._storage.add(e)}ensureWindow(e,t={position:"fixed",direction:"normal"}){const s=this._windows.get(e);if(void 0!==s)return s;this.registerWindow(e);const i=this._document.createElement("div");if(i.style.position=t.position,i.style.zIndex=this._index.toString(),i.dataset.id=e,void 0!==t.index){const e=this._container.childNodes.length;if(t.index>=e)this._container.appendChild(i);else if(t.index<=0)this._container.insertBefore(i,this._container.firstChild);else{const e=this._container.childNodes[t.index];this._container.insertBefore(i,e)}}else"reverse"===t.direction?this._container.insertBefore(i,this._container.firstChild):this._container.appendChild(i);return this._windows.set(e,i),++this._index,i}unregisterWindow(e){this._storage.remove(e);const t=this._windows.get(e);void 0!==t&&(null!==t.parentElement&&t.parentElement.removeChild(t),this._windows.delete(e))}getZindex(e){const t=this.ensureWindow(e);return parseInt(t.style.zIndex||"0")}moveLastWindowToTop(){const e=this._storage.getItems(),t=e[e.length-1];t&&this.moveToTop(t)}moveToTop(e){if(this.getZindex(e)!==this._index){const t=this.ensureWindow(e);this._windows.forEach(((e,s)=>{e.hasAttribute(n.FOCUS_TRAP_DATA_ATTRIBUTE)&&e.setAttribute(n.FOCUS_TRAP_DATA_ATTRIBUTE,e===t?"true":"false")})),t.style.zIndex=(++this._index).toString()}}removeWindow(e){this.unregisterWindow(e)}}const a=new WeakMap;function l(e=document){const t=e.getElementById("overlap-manager-root");if(null!==t)return(0,i.ensureDefined)(a.get(t));{const t=new r(e),s=function(e){const t=e.createElement("div");return t.style.position="absolute",t.style.zIndex=150..toString(),t.style.top="0px",t.style.left="0px",t.id="overlap-manager-root",t.dataset.qaId="overlap-manager-root",t}(e);return a.set(s,t),t.setContainer(s),e.body.appendChild(s),t}}var c;!function(e){e[e.BaseZindex=150]="BaseZindex"}(c||(c={}))},247465:(e,t,s)=>{"use strict";s.d(t,{
isCancelled:()=>o,makeCancelable:()=>n});class i extends Error{constructor(){super("CancelToken")}}function n(e){let t=!1;return{promise:new Promise(((s,n)=>{e.then((e=>t?n(new i):s(e))),e.catch((e=>n(t?new i:e)))})),cancel(){t=!0}}}function o(e){return e instanceof i}},868333:(e,t,s)=>{"use strict";var i;s.d(t,{LogoSize:()=>i,getLogoUrlResolver:()=>r}),function(e){e[e.Medium=0]="Medium",e[e.Large=1]="Large"}(i||(i={}));class n{getSymbolLogoUrl(e){return e}collectSymbolLogoUrls(e,t){return[]}getCountryFlagUrl(){return""}getCryptoLogoUrl(e){return e}getProviderLogoUrl(e){return e}getSourceLogoUrl(e){return e}getBlockchainContractLogoUrl(e){return e}}let o;function r(){return o||(o=new n),o}},285089:(e,t,s)=>{"use strict";s.d(t,{setFixedBodyState:()=>l});var i=s(735922);const n=()=>!window.matchMedia("(min-width: 768px)").matches,o=()=>!window.matchMedia("(min-width: 1280px)").matches;let r=0,a=!1;function l(e){const{body:t}=document,s=t.querySelector(".widgetbar-wrap");if(e&&1==++r){const e=(0,i.getCSSProperty)(t,"overflow"),n=(0,i.getCSSPropertyNumericValue)(t,"padding-right");"hidden"!==e.toLowerCase()&&t.scrollHeight>t.offsetHeight&&((0,i.setStyle)(s,"right",`${(0,i.getScrollbarWidth)()}px`),t.style.paddingRight=`${n+(0,i.getScrollbarWidth)()}px`,a=!0),t.classList.add("i-no-scroll")}else if(!e&&r>0&&0==--r&&(t.classList.remove("i-no-scroll"),a)){(0,i.setStyle)(s,"right","0px");let e=0;e=s?(l=(0,i.getContentWidth)(s),n()?0:o()?45:Math.min(Math.max(l,45),450)):0,t.scrollHeight<=t.clientHeight&&(e-=(0,i.getScrollbarWidth)()),t.style.paddingRight=(e<0?0:e)+"px",a=!1}var l}},585938:(e,t,s)=>{"use strict";s.d(t,{useForceUpdate:()=>i.useForceUpdate});var i=s(813550)},522224:(e,t,s)=>{"use strict";s.d(t,{hoverMouseEventFilter:()=>i.hoverMouseEventFilter,useAccurateHover:()=>i.useAccurateHover,useHover:()=>i.useHover,useHoverDeprecated:()=>i.useHoverDeprecated});var i=s(975228)},683614:(e,t,s)=>{"use strict";s.d(t,{useVisibility:()=>n});var i=s(50959);function n(e,t,s){(0,i.useEffect)((()=>{const i=new IntersectionObserver((e=>{e[e.length-1].intersectionRatio<.25?s():t()}),{threshold:[0,.25,.5,.75,1],root:null,rootMargin:"0px"});return e.current&&i.observe(e.current),()=>i.disconnect()}),[])}},930052:(e,t,s)=>{"use strict";s.d(t,{MatchMedia:()=>n});var i=s(50959);class n extends i.PureComponent{constructor(e){super(e),this._handleChange=()=>{this.forceUpdate()},this.state={query:window.matchMedia(this.props.rule)}}componentDidMount(){this._subscribe(this.state.query)}componentDidUpdate(e,t){this.state.query!==t.query&&(this._unsubscribe(t.query),this._subscribe(this.state.query))}componentWillUnmount(){this._unsubscribe(this.state.query)}render(){return this.props.children(this.state.query.matches)}static getDerivedStateFromProps(e,t){return e.rule!==t.query.media?{query:window.matchMedia(e.rule)}:null}_subscribe(e){e.addEventListener("change",this._handleChange)}_unsubscribe(e){e.removeEventListener("change",this._handleChange)}}},230553:(e,t,s)=>{"use strict";s.d(t,{MenuContext:()=>i});const i=s(50959).createContext(null)
},510618:(e,t,s)=>{"use strict";s.d(t,{DEFAULT_MENU_THEME:()=>_,Menu:()=>f});var i=s(50959),n=s(497754),o=s.n(n),r=s(650151),a=s(825850),l=s(157206),c=s(753327),u=s(370981),d=s(801808),h=s(926032),p=s(823030),m=s(230553),g=s(205808);const _=g;var b;!function(e){e[e.IndentFromWindow=0]="IndentFromWindow"}(b||(b={}));class f extends i.PureComponent{constructor(e){super(e),this._containerRef=null,this._scrollWrapRef=null,this._raf=null,this._scrollRaf=null,this._scrollTimeout=void 0,this._manager=new d.OverlapManager,this._hotkeys=null,this._scroll=0,this._handleContainerRef=e=>{this._containerRef=e,this.props.reference&&("function"==typeof this.props.reference&&this.props.reference(e),"object"==typeof this.props.reference&&(this.props.reference.current=e))},this._handleScrollWrapRef=e=>{this._scrollWrapRef=e,"function"==typeof this.props.scrollWrapReference&&this.props.scrollWrapReference(e),"object"==typeof this.props.scrollWrapReference&&(this.props.scrollWrapReference.current=e)},this._handleCustomRemeasureDelegate=()=>{this._resizeForced(),this._handleMeasure()},this._handleMeasure=({callback:e,forceRecalcPosition:t}={})=>{if(this.state.isMeasureValid&&!t)return;const{position:s}=this.props,i=(0,r.ensureNotNull)(this._containerRef);let n=i.getBoundingClientRect();const o=document.documentElement.clientHeight,l=document.documentElement.clientWidth,c=this.props.closeOnScrollOutsideOffset??0;let u=o-0-c;const d=n.height>u;if(d){(0,r.ensureNotNull)(this._scrollWrapRef).style.overflowY="scroll",n=i.getBoundingClientRect()}const{width:h,height:p}=n,m="function"==typeof s?s({contentWidth:h,contentHeight:p,availableWidth:l,availableHeight:o}):s,g=m?.indentFromWindow?.left??0,_=l-(m.overrideWidth??h)-(m?.indentFromWindow?.right??0),b=(0,a.clamp)(m.x,g,Math.max(g,_)),f=(m?.indentFromWindow?.top??0)+c,v=o-(m.overrideHeight??p)-(m?.indentFromWindow?.bottom??0);let w=(0,a.clamp)(m.y,f,Math.max(f,v));if(m.forbidCorrectYCoord&&w<m.y&&(u-=m.y-w,w=m.y),t&&void 0!==this.props.closeOnScrollOutsideOffset&&m.y<=this.props.closeOnScrollOutsideOffset)return void this._handleGlobalClose(!0);const C=m.overrideHeight??(d?u:void 0);this.setState({appearingMenuHeight:t?this.state.appearingMenuHeight:C,appearingMenuWidth:t?this.state.appearingMenuWidth:m.overrideWidth,appearingPosition:{x:b,y:w},isMeasureValid:!0},(()=>{this.props.doNotRestorePosition||this._restoreScrollPosition(),e&&e()}))},this._restoreScrollPosition=()=>{const e=document.activeElement,t=(0,r.ensureNotNull)(this._containerRef);if(null!==e&&t.contains(e))try{e.scrollIntoView()}catch(e){}else(0,r.ensureNotNull)(this._scrollWrapRef).scrollTop=this._scroll},this._resizeForced=()=>{this.setState({appearingMenuHeight:void 0,appearingMenuWidth:void 0,appearingPosition:void 0,isMeasureValid:void 0})},this._resize=()=>{null===this._raf&&(this._raf=requestAnimationFrame((()=>{this.setState({appearingMenuHeight:void 0,appearingMenuWidth:void 0,appearingPosition:void 0,isMeasureValid:void 0}),this._raf=null})))},this._handleGlobalClose=e=>{this.props.onClose(e)},this._handleSlot=e=>{
this._manager.setContainer(e)},this._handleScroll=()=>{this._scroll=(0,r.ensureNotNull)(this._scrollWrapRef).scrollTop},this._handleScrollOutsideEnd=()=>{clearTimeout(this._scrollTimeout),this._scrollTimeout=setTimeout((()=>{this._handleMeasure({forceRecalcPosition:!0})}),80)},this._handleScrollOutside=e=>{e.target!==this._scrollWrapRef&&(this._handleScrollOutsideEnd(),null===this._scrollRaf&&(this._scrollRaf=requestAnimationFrame((()=>{this._handleMeasure({forceRecalcPosition:!0}),this._scrollRaf=null}))))},this.state={}}componentDidMount(){this._handleMeasure({callback:this.props.onOpen});const{customCloseDelegate:e=u.globalCloseDelegate,customRemeasureDelegate:t}=this.props;e.subscribe(this,this._handleGlobalClose),t?.subscribe(null,this._handleCustomRemeasureDelegate),window.addEventListener("resize",this._resize);const s=null!==this.context;this._hotkeys||s||(this._hotkeys=h.createGroup({desc:"Popup menu"}),this._hotkeys.add({desc:"Close",hotkey:27,handler:()=>{this.props.onKeyboardClose&&this.props.onKeyboardClose(),this._handleGlobalClose()}})),this.props.repositionOnScroll&&window.addEventListener("scroll",this._handleScrollOutside,{capture:!0})}componentDidUpdate(){this._handleMeasure()}componentWillUnmount(){const{customCloseDelegate:e=u.globalCloseDelegate,customRemeasureDelegate:t}=this.props;e.unsubscribe(this,this._handleGlobalClose),t?.unsubscribe(null,this._handleCustomRemeasureDelegate),window.removeEventListener("resize",this._resize),window.removeEventListener("scroll",this._handleScrollOutside,{capture:!0}),this._hotkeys&&(this._hotkeys.destroy(),this._hotkeys=null),null!==this._raf&&(cancelAnimationFrame(this._raf),this._raf=null),null!==this._scrollRaf&&(cancelAnimationFrame(this._scrollRaf),this._scrollRaf=null),this._scrollTimeout&&clearTimeout(this._scrollTimeout)}render(){const{id:e,role:t,"aria-label":s,"aria-labelledby":n,"aria-activedescendant":r,"aria-hidden":a,"aria-describedby":u,"aria-invalid":d,children:h,minWidth:_,theme:b=g,className:f,maxHeight:w,onMouseOver:C,onMouseOut:y,onKeyDown:S,onFocus:E,onBlur:x}=this.props,{appearingMenuHeight:F,appearingMenuWidth:T,appearingPosition:P,isMeasureValid:k}=this.state,I={"--ui-kit-menu-max-width":`${P&&P.x}px`,maxWidth:"calc(100vw - var(--ui-kit-menu-max-width) - 6px)"};return i.createElement(m.MenuContext.Provider,{value:this},i.createElement(p.SubmenuHandler,null,i.createElement(c.SlotContext.Provider,{value:this._manager},i.createElement("div",{id:e,role:t,"aria-label":s,"aria-labelledby":n,"aria-activedescendant":r,"aria-hidden":a,"aria-describedby":u,"aria-invalid":d,className:o()(f,b.menuWrap,!k&&b.isMeasuring),style:{height:F,left:P&&P.x,minWidth:_,position:"fixed",top:P&&P.y,width:T,...this.props.limitMaxWidth&&I},"data-name":this.props["data-name"],"data-qa-id":this.props.dataQaId,"data-tooltip-show-on-focus":this.props["data-tooltip-show-on-focus"],ref:this._handleContainerRef,onScrollCapture:this.props.onScroll,onContextMenu:l.preventDefaultForContextMenu,tabIndex:this.props.tabIndex,onMouseOver:C,onMouseOut:y,onKeyDown:S,
onFocus:E,onBlur:x},i.createElement("div",{className:o()(b.scrollWrap,!this.props.noMomentumBasedScroll&&b.momentumBased),style:{overflowY:void 0!==F?"scroll":"auto",maxHeight:w},onScrollCapture:this._handleScroll,ref:this._handleScrollWrapRef},i.createElement(v,{className:b.menuBox},h)))),i.createElement(c.Slot,{reference:this._handleSlot})))}update(e){e?this._resizeForced():this._resize()}focus(e){this._containerRef?.focus(e)}blur(){this._containerRef?.blur()}}function v(e){const t=(0,r.ensureNotNull)((0,i.useContext)(p.SubmenuContext)),s=i.useRef(null);return i.createElement("div",{ref:s,className:e.className,onMouseOver:function(e){if(!(null!==t.current&&e.target instanceof Node&&(i=e.target,s.current?.contains(i))))return;var i;t.isSubmenuNode(e.target)||t.setCurrent(null)},"data-name":"menu-inner","data-qa-id":"menu-inner"},e.children)}f.contextType=p.SubmenuContext},28466:(e,t,s)=>{"use strict";s.d(t,{CloseDelegateContext:()=>o});var i=s(50959),n=s(370981);const o=i.createContext(n.globalCloseDelegate)},8361:(e,t,s)=>{"use strict";s.d(t,{Portal:()=>i.Portal,PortalContext:()=>i.PortalContext});var i=s(730654)},753327:(e,t,s)=>{"use strict";s.d(t,{Slot:()=>i.Slot,SlotContext:()=>i.SlotContext});var i=s(682925)},742554:(e,t,s)=>{"use strict";s.d(t,{TouchScrollContainer:()=>c});var i=s(50959),n=s(259142),o=s(650151),r=s(601227);const a=CSS.supports("overscroll-behavior","none");let l=0;const c=(0,i.forwardRef)(((e,t)=>{const{children:s,...o}=e,c=(0,i.useRef)(null);return(0,i.useImperativeHandle)(t,(()=>c.current)),(0,i.useLayoutEffect)((()=>{if(r.CheckMobile.iOS())return l++,null!==c.current&&(a?1===l&&(document.body.style.overscrollBehavior="none"):(0,n.disableBodyScroll)(c.current,{allowTouchMove:u(c)})),()=>{l--,null!==c.current&&(a?0===l&&(document.body.style.overscrollBehavior=""):(0,n.enableBodyScroll)(c.current))}}),[]),i.createElement("div",{ref:c,...o},s)}));function u(e){return t=>{const s=(0,o.ensureNotNull)(e.current),i=document.activeElement;return!s.contains(t)||null!==i&&s.contains(i)&&i.contains(t)}}},430062:e=>{e.exports={wrapper:"wrapper-q2xHBwCG",labelWrapper:"labelWrapper-q2xHBwCG",labelAccountName:"labelAccountName-q2xHBwCG",labelInfo:"labelInfo-q2xHBwCG",accountBadge:"accountBadge-q2xHBwCG",summary:"summary-q2xHBwCG",dropdownButton:"dropdownButton-q2xHBwCG",hintPlaceholder:"hintPlaceholder-q2xHBwCG",content:"content-q2xHBwCG",popup:"popup-q2xHBwCG",singleItemDropdownWrapper:"singleItemDropdownWrapper-q2xHBwCG",accountName:"accountName-q2xHBwCG",currency:"currency-q2xHBwCG"}},800067:e=>{e.exports={wrapper:"wrapper-sS0Eevbl",popup:"popup-sS0Eevbl",brokerDropdownWrapper:"brokerDropdownWrapper-sS0Eevbl",brokerDropdownMobileWrapper:"brokerDropdownMobileWrapper-sS0Eevbl",betaBadgeWrapper:"betaBadgeWrapper-sS0Eevbl"}},440782:e=>{e.exports={headerWrapper:"headerWrapper-gktKXRGi",withoutDropdowns:"withoutDropdowns-gktKXRGi",brokerBlock:"brokerBlock-gktKXRGi",betaBadge:"betaBadge-gktKXRGi"}},612658:e=>{e.exports={accountSummaryField:"accountSummaryField-jRGFBLDP",value:"value-jRGFBLDP",
titleContainer:"titleContainer-jRGFBLDP",title:"title-jRGFBLDP"}},234682:e=>{e.exports={accountSummaryRow:"accountSummaryRow-p0GW1i2G",addMargin:"addMargin-p0GW1i2G"}},266031:e=>{e.exports={count:"count-jY_kTdIW",tabs:"tabs-jY_kTdIW"}},785948:e=>{e.exports={accountManager:"accountManager-RYOkdllU",topPanel:"topPanel-RYOkdllU",secondaryPanel:"secondaryPanel-RYOkdllU",content:"content-RYOkdllU",page:"page-RYOkdllU",active:"active-RYOkdllU",popup:"popup-RYOkdllU",mobile:"mobile-RYOkdllU"}},92065:e=>{e.exports={pageContainer:"pageContainer-NWiOUge8"}},718767:e=>{e.exports={stretch:"stretch-jequK3xK"}},634506:e=>{e.exports={title:"title-qCE0lhBm",hidden:"hidden-qCE0lhBm"}},542795:e=>{e.exports={container:"container-UePCJPvY",sticky:"sticky-UePCJPvY"}},413530:e=>{e.exports={button:"button-mNpEpVYL"}},82276:e=>{e.exports={message:"message-p5eTSZ4Q"}},798603:e=>{e.exports={wrapper:"wrapper-oHlQhto0",buttons:"buttons-oHlQhto0",button:"button-oHlQhto0",editButton:"editButton-oHlQhto0"}},313465:e=>{e.exports={title:"title-DIAl4Kmu",titleContent:"titleContent-DIAl4Kmu",wrapper:"wrapper-DIAl4Kmu"}},540752:e=>{e.exports={container:"container-JKVA979k",logo:"logo-JKVA979k",gap:"gap-JKVA979k",tickerAndDescriptionWrapper:"tickerAndDescriptionWrapper-JKVA979k",textWrapper:"textWrapper-JKVA979k",title:"title-JKVA979k",description:"description-JKVA979k",tooltipIcon:"tooltipIcon-JKVA979k",messageInformer:"messageInformer-JKVA979k"}},527755:e=>{e.exports={title:"title-UBH3TM61"}},137684:e=>{e.exports={text:"text-8tRPX9tj"}},226136:e=>{e.exports={gray:"gray-Qz5vw9Wh",grey:"grey-Qz5vw9Wh",blue:"blue-Qz5vw9Wh",red:"red-Qz5vw9Wh",green:"green-Qz5vw9Wh",orange:"orange-Qz5vw9Wh"}},341384:e=>{e.exports={wrapper:"wrapper-scLCpJg_",currency:"currency-scLCpJg_"}},436455:e=>{e.exports={wrapper:"wrapper-HXba0ecm",rightAligned:"rightAligned-HXba0ecm",tooltipIcon:"tooltipIcon-HXba0ecm"}},908932:e=>{e.exports={wrapper:"wrapper-ukE5gIkU",hiddenLabel:"hiddenLabel-ukE5gIkU",contentWrapper:"contentWrapper-ukE5gIkU",content:"content-ukE5gIkU",labelWrapper:"labelWrapper-ukE5gIkU",label:"label-ukE5gIkU",withPadding:"withPadding-ukE5gIkU",tooltipIcon:"tooltipIcon-ukE5gIkU"}},762370:e=>{e.exports={root:"root-Tu141ut0",tableHead:"tableHead-Tu141ut0",tableBody:"tableBody-Tu141ut0",table:"table-Tu141ut0",wrapper:"wrapper-Tu141ut0",headCell:"headCell-Tu141ut0",sortable:"sortable-Tu141ut0",headCellContent:"headCellContent-Tu141ut0",cell:"cell-Tu141ut0",capitalize:"capitalize-Tu141ut0",cellContent:"cellContent-Tu141ut0",rightAlignedCellContent:"rightAlignedCellContent-Tu141ut0",hideLabelOnMobile:"hideLabelOnMobile-Tu141ut0",hideCellOnMobile:"hideCellOnMobile-Tu141ut0",row:"row-Tu141ut0",highlightedRow:"highlightedRow-Tu141ut0",leftFixedColumn:"leftFixedColumn-Tu141ut0",rightFixedColumn:"rightFixedColumn-Tu141ut0",inactiveRow:"inactiveRow-Tu141ut0",tableWrapper:"tableWrapper-Tu141ut0",noBouncingScroll:"noBouncingScroll-Tu141ut0",tableWrapperEmpty:"tableWrapperEmpty-Tu141ut0",isScrolled:"isScrolled-Tu141ut0",emptyStateBlock:"emptyStateBlock-Tu141ut0",
emptyStateRow:"emptyStateRow-Tu141ut0",emptyStateCell:"emptyStateCell-Tu141ut0",paginationWrapper:"paginationWrapper-Tu141ut0"}},104432:e=>{e.exports={scrollContainer:"scrollContainer-QUmwCARl",scrollWrapper:"scrollWrapper-QUmwCARl"}},331632:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AccountManagerHeaderDropdowns:()=>y});var i=s(50959),n=s(497754),o=s.n(n),r=s(601227),a=s(917036),l=s(609838),c=s(528457),u=s(898237),d=s(723991),h=(s(603369),s(152601)),p=s(661851),m=s(430062);const g="Account Creation Dialog",_=l.t(null,void 0,s(271775));function b(e){return i.createElement(i.Fragment,null,i.createElement("span",null,e.name),!1)}function f(e){const{showSettings:t,showLabel:s,children:n}=e;return t||s?i.createElement("div",{className:m.wrapper},n):i.createElement(i.Fragment,null,n)}function v(e){const{name:t,currency:n}=e;return i.createElement(i.Fragment,null,i.createElement("span",{className:m.accountName},`${l.t(null,void 0,s(386511))}: ${t}`),void 0!==n&&i.createElement("span",{className:m.currency},n))}function w(e){const{currentAccount$:t,accountsList:s,mode:n,accountSettingsInfo:a,createAccount:l,resetAccount:w,changeAccountSettings:C,deleteAccount:y,trackEvent:S,showErrorNotification:E,accountHintOptions:x}=e,F=(0,i.useRef)(null),{isOpen:T,onOpen:P,onClose:k}=(0,c.useRootPopoverOpenState)(F),I=(0,p.useObservable)(t);if(void 0===I)return i.createElement(i.Fragment,null);const D=0===n;if(1===s.length&&void 0===l)return i.createElement("span",{className:o()(m.content,D&&m.popup,m.singleItemDropdownWrapper)},i.createElement(v,{name:I.name,currency:I.currency}));const R=!1,M=Boolean(!1),A=(r.CheckMobile.any(),(0,i.useMemo)((()=>s.map((e=>i.createElement(d.PopoverItem,{key:e.id,title:b(e),onClick:()=>e.selectAccount(),rightSlot:e.currency||void 0,selected:I.id===e.id})))),[s,l,I,function(){if(void 0===l)return;k(!0),showCreateAccountDialog({title:_,createAccountHandler:e=>(S(g,"Click Create account"),l(e)),accountSettingsInfoHandler:a,trackEvent:S})}]));return i.createElement(f,{showSettings:R,showLabel:M},i.createElement(u.LightButton,{showCaret:!0,isActive:T,isSelected:T,size:"medium","data-name":"account-selector",onClick:()=>{T?k(!0):P()},className:m.dropdownButton,variant:"quiet-primary",reference:F},i.createElement("span",{className:o()(m.content,D&&m.popup)},i.createElement(v,{name:I.name,currency:I.currency}),!1)),i.createElement(h.PopoverKeyboardNavigator,{closeOnEscape:!0,closeOnClickAway:!0,isOpen:T,onClose:k,"data-name":"account-dropdown",anchored:{type:"element",at:F}},A),R,M&&i.createElement(AccountLabel,{label:I.label,labelLink:I.labelLink,labelTooltipText:I.labelTooltipText}))}var C=s(800067);function y(e){const{brokerDropdownProps:t,accountDropdownProps:s,commonDropdownProps:n}=e,l=(r.CheckMobile.any(),0===s.mode);return i.createElement("div",{className:o()(C.wrapper,l&&C.popup)},l?i.createElement("span",{className:C.brokerDropdownWrapper},"Account Manager"):i.createElement(i.Fragment,null),i.createElement(w,{...s}),!l&&i.createElement(a.TerminalDropdown,{...n}))}},603903:(e,t,s)=>{"use strict";s.r(t),
s.d(t,{AccountManager:()=>Yn});var i=s(609838),n=s(50959),o=s(632227),r=s(497754),a=s.n(r),l=s(650151),c=s(551442),u=s(601227),d=s(69111),h=s(534934),p=s(760775),m=s(574235);class g{constructor(e){this._delegates=e}subscribe(e,t,s){this._delegates.forEach((i=>i.subscribe(e,t,s)))}unsubscribe(e,t){this._delegates.forEach((s=>s.unsubscribe(e,t)))}unsubscribeAll(e){this._delegates.forEach((t=>t.unsubscribeAll(e)))}}var _=s(765296),b=s(142928),f=s(851310);function v(e){return 0!==e.qty||0!==e.longQty&&void 0!==e.longQty||0!==e.shortQty&&void 0!==e.shortQty}var w=s(247465);class C{constructor(e){this._isActive=!1,this._created=!1,this._started=!1,this._fullUpdateDelegate=null,this._partialUpdateDelegate=null,this._deleteUpdateDelegate=null,this._noMoreEntries=!1,this._isLoadingMore=!1,this._fullUpdateCancel=null,this._exportData=async()=>{const e=this._isActive;e||(this.start(),await this.setActive(!0));const t=await this._view.exportData();return e||await this.setActive(!1),t},this._viewVisibilityHandler=e=>{this._model.setActive(e)},this._sortingChangeHandler=e=>{this._updateModelSortingState(e)},this._sizeChangeHandler=()=>{this._updateModelSortingState({column:this._view.sortingColumn(),mode:this._view.sortingMode()})};const{idProperty:t,name:s,model:i,view:n,source:o,subscriptions:r,supportPagination:a}=e;this._idProperty=t,this._model=i,this._view=n,this._name=s,this._source=o,this._subscriptions=r,this._supportPagination=Boolean(a)}start(){this._started||(this._updateModelSortingState({column:this._view.sortingColumn(),mode:this._view.sortingMode()}),this._subscribeUpdates(),this._subscribeView(),this._started=!0)}stop(){this._started&&(this._unsubscribeUpdates(),this._unsubscribeView(),this.reset(),this._started=!1)}isStarted(){return this._started}async setActive(e){(0,l.assert)(!e||this._started,"Should be started first"),this._isActive!==e&&(this._isActive=e,this._isActive&&!this._created&&await this._fullUpdate(),this._model.setActive(e))}isActive(){return this._isActive}reset(){this._isActive?this._fullUpdate():(this._deleteRows(),this._created=!1)}destroy(){this._unsubscribeUpdates(),this._unsubscribeView()}getDataExporter(){return{name:this._name,exportData:this._exportData}}highlightRowById(e){this._view.highlightRowById(e)}setRowInactiveById(e,t){this._view.setRowInactiveById(e,t)}setRowInactiveByFilter(e){this._view.setRowInactiveByFilter(e)}addFormatter(e){this._view.addFormatter(e)}addFormatters(e){for(const t of e)this.addFormatter(t)}isRowInViewport(e){return this._view.isRowInViewport(e)}setColumnAvailable(e,t){this._view.setColumnAvailable(e,t)}setRowLinkedByFilter(e){this._view.setRowLinkedByFilter(e)}setRowLinkedById(e,t){this._view.setRowLinkedById(e,t)}rowIdAtEvent(e){return this._view.rowIdAtEvent(e)}rowAtEvent(e){const t=this._view.rowIdAtEvent(e);if(void 0!==t)return this.rowById(t)}rowById(e){return this._model.data().get(e)}_update(e){return!!this._created&&(this._model.addRow(e),!0)}_deleteRow(e){this._created&&this._model.deleteRow(e)}_deleteRows(){this._model.deleteRows(),
this._created=!1}_fullUpdate(){if(this._deleteRows(),this._noMoreEntries=!1,!this._isActive)return Promise.resolve();this._fullUpdateCancel&&this._fullUpdateCancel();const e=(0,w.makeCancelable)(this._source());return this._fullUpdateCancel=e.cancel,e.promise.then((e=>{this._fullUpdateCancel=null,this._model.addRows(e),this._created=!0,this._onCreated()})).catch((e=>{if(!(0,w.isCancelled)(e))throw e}))}_onCreated(){}_loadMoreIfBottomVisible(e){if(this._isLoadingMore||!e||this._noMoreEntries)return;const t=this._model.rows().length-1;if(-1===t)return;const s=this._model.rows()[t][this._idProperty];this._isLoadingMore=!0,this._source(s).then((e=>{0!==e.length?(this._model.addRows(e),this._isLoadingMore=!1):this._noMoreEntries=!0})).catch((()=>{this._isLoadingMore=!1}))}_subscribeView(){this._view.onSizeChange.subscribe(this,this._sizeChangeHandler),this._view.onTableVisibilityChange.subscribe(this,this._viewVisibilityHandler),this._view.onSortingChange.subscribe(this,this._sortingChangeHandler),this._supportPagination&&this._view.onBottomVisibilityChange.subscribe(this,this._loadMoreIfBottomVisible)}_unsubscribeView(){this._view.onSizeChange.unsubscribe(this,this._sizeChangeHandler),this._view.onTableVisibilityChange.unsubscribe(this,this._viewVisibilityHandler),this._view.onSortingChange.unsubscribe(this,this._sortingChangeHandler),this._view.onBottomVisibilityChange.unsubscribe(this,this._loadMoreIfBottomVisible)}_updateModelSortingState(e){const t=0!==this._view.size()||this._supportPagination?e.mode:null;this._model.setSortingState({column:null===t?void 0:e.column,mode:t})}_subscribeUpdates(){if(this._fullUpdateDelegate)throw new Error("should unsubscribe first");this._fullUpdateDelegate=this._subscriptions.fullUpdateDelegate,this._fullUpdateDelegate.subscribe(this,this._fullUpdate),this._partialUpdateDelegate=this._subscriptions.rowUpdateDelegate,this._partialUpdateDelegate.subscribe(this,this._update),this._subscriptions.rowDeleteDelegate&&(this._deleteUpdateDelegate=this._subscriptions.rowDeleteDelegate,this._deleteUpdateDelegate.subscribe(this,this._deleteRow))}_unsubscribeUpdates(){this._fullUpdateDelegate&&(this._fullUpdateDelegate.unsubscribe(this,this._fullUpdate),delete this._fullUpdateDelegate),this._partialUpdateDelegate&&(this._partialUpdateDelegate.unsubscribe(this,this._update),delete this._partialUpdateDelegate),this._deleteUpdateDelegate&&(this._deleteUpdateDelegate.unsubscribe(this,this._deleteRow),delete this._deleteUpdateDelegate)}}var y=s(611882);class S{constructor(e,t){this._filterTabs=[],this._active=!1,this._count=new y.WatchedValue,this._content=e,this._id=t.id,this._name=t.name}setActive(e){this._active!==e&&(this._active=e,this._onActiveChanged(e))}isActive(){return this._active}reset(){}destroy(){}content(){return this._content}name(){return this._name}id(){return this._id||this._name}async contextItems(e){return[]}topline(){return null}activeFilterTabId(){return this._activeFilterTabId}filterTabs(){return this._filterTabs}count(){return this._count.readonly()}activateFilterTab(e){
this._activeFilterTabId=e}_setCount(e){this._count.setValue(e)}_onActiveChanged(e){}}class E extends S{constructor(e,t,s){super(e,t),this._tableControllers=s}reset(){this._tableControllers.forEach((e=>e.reset())),super.reset()}destroy(){this._tableControllers.forEach((e=>e.destroy())),super.destroy()}getExporters(){const e=this._tableControllers.map((e=>e.getDataExporter()));return{title:this.name(),exporters:e}}contextRow(e){}_onActiveChanged(e){this._tableControllers.forEach((t=>t.setActive(e)))}}var x=s(290484),F=s(298670),T=s(627692);class P{constructor(e,t,s){this._calculateCounts=async e=>{if(e?.aborted)return;const t=await this._source();if(e?.aborted)return;const s=t.length;s!==this._count&&(this._count=s,this._countChanged.fire(s))},this._source=e,this._rowUpdateDelegate=t,this._fullUpdateDelegate=s??null,this._countChanged=new T.Delegate,this._abortController=new AbortController,this._calculateCounts=(0,F.respectLatest)(this._calculateCounts),this._calculateCountsDebounced=(0,x.default)((()=>this._calculateCounts(this._abortController.signal)),100)}countChanged(){return this._countChanged}start(){this._abortController=new AbortController,this._rowUpdateDelegate.subscribe(this,this._calculateCountsDebounced),this._fullUpdateDelegate?.subscribe(this,this._calculateCountsDebounced),this._calculateCounts(this._abortController.signal)}stop(){this._abortController.abort(),this._count=void 0,this._rowUpdateDelegate.unsubscribe(this,this._calculateCountsDebounced),this._fullUpdateDelegate?.unsubscribe(this,this._calculateCountsDebounced)}}var k=s(150335),I=s(188464),D=s(420146),R=s(488736);var M=s(144421),A=s(611821),U=s(932473),O=s(441219),N=s(773743),B=s(209957);const V=(0,s(491807).numDependencyFormatter)((e=>(0,O.numberFormattersParsersChain)({chain:[(0,B.fixedNumberMagnitudeStep)({decimalPlaces:e}),(0,N.signumStep)({negativeSign:N.longMinusSign})]})));var L=s(229144),W=s(454307),H=s(166554),z=s(671129),q=s(73221),K=s(737563),G=s(72903),j=s(361701),$=s(252130),Q=s(683614),Z=s(585938),J=s(972535),Y=s(744471);function X(e){e.stopPropagation(),J.mobiletouch&&((0,Y.tooltipClickHandler)(e),document.addEventListener("touchend",(e=>e.preventDefault()),{once:!0}))}function ee(e){return{ariaLabel:e,tooltip:e,onClick:X}}function te(e){const{dependencies:t,customText:s}=e,i=(0,n.useRef)(null),o=(0,n.useRef)(void 0),r=(0,Z.useForceUpdate)(),a=(0,$.useIsMounted)(),l=(0,n.useCallback)((()=>{if(!a.current)return;if(null===i.current||i.current.offsetWidth>=i.current.scrollWidth)return o.current=void 0,void r();const e=s??i.current.textContent;null!==e&&e!==o.current&&(o.current=e,r())}),t);return(0,n.useEffect)((()=>l()),[l]),(0,Q.useVisibility)(i,(()=>l()),(()=>{})),[i,void 0!==o.current?ee(o.current):null]}var se=s(91603);const ie=i.t(null,void 0,s(521645));function ne(e){return{text:void 0!==e?.text&&""!==e.text?`${ie}\n\n${e.text}`:ie,type:e?.type===se.OrderOrPositionMessageType.Error?se.OrderOrPositionMessageType.Error:se.OrderOrPositionMessageType.Warning}}var oe=s(894862),re=s(82276);const ae={
[oe.OrderOrPositionMessageType.Information]:"default",[oe.OrderOrPositionMessageType.Warning]:"warning",[oe.OrderOrPositionMessageType.Error]:"danger"},le={[oe.OrderOrPositionMessageType.Information]:"info",[oe.OrderOrPositionMessageType.Warning]:"exclamation",[oe.OrderOrPositionMessageType.Error]:"exclamation"};function ce(e){e.stopPropagation(),J.mobiletouch&&((0,Y.tooltipClickHandler)(e),document.addEventListener("touchend",(e=>e.preventDefault()),{once:!0}))}function ue(e){const{type:t,text:s,className:i,reference:o,...r}=e;return n.createElement("div",{className:a()(re.message,i)},n.createElement(K.IconQuestionInformation,{...r,ref:o,icon:le[t],intent:ae[t],ariaLabel:s,tooltip:s,onClick:ce}))}function de(e){return e.replace(/\s+/g," ")}function he(e,t){return(0,n.useMemo)((()=>t?`${de(e)} - ${de(t)}`:de(e)),[e,t])}var pe=s(578758),me=s(540752);function ge(e){const{symbol:t,brokerSymbol:s,message:i,isDelayed:o}=e,r=(0,pe.useSymbolLogoAndDescription)(t),l=""!==t?i:ne(i),c=he(s,r?.description),[u,d]=te({dependencies:[s],customText:c}),[h,p]=te({dependencies:[r?.description],customText:c}),m=p??d;return n.createElement("div",{className:me.container},n.createElement("span",{className:me.logo},void 0!==r?.logoUrls&&r.logoUrls.length>1?n.createElement(G.CircleLogoPair,{primaryLogoUrl:r.logoUrls[0],secondaryLogoUrl:r.logoUrls[1],size:"xsmall"}):n.createElement(j.CircleLogo,{logoUrl:r?.logoUrls?.[0],placeholderLetter:s?.[0],size:"xsmall"})),n.createElement("div",{className:me.tickerAndDescriptionWrapper},n.createElement("div",{className:a()(me.textWrapper,null===m&&me.gap)},n.createElement("span",{className:me.title,ref:u},s),void 0!==r?.description&&n.createElement("span",{className:me.description,ref:h},r.description)),null!==m&&n.createElement(K.IconQuestionInformation,{...m,icon:"info",className:me.tooltipIcon}),!1,void 0!==l&&n.createElement(ue,{...l,className:me.messageInformer})))}var _e=s(313465);function be(e){const{brokerSymbol:t,logoComponent:s,tooltipText:i}=e,o=(0,p.getSymbolNameOverFullname)(t);return n.createElement("div",{className:_e.wrapper},s,n.createElement("div",{className:a()(_e.title,"apply-common-tooltip"),"data-tooltip":i??o},n.createElement("span",{className:_e.titleContent},o)))}function fe(e){const{brokerSymbol:t,symbol:s}=e,i=(0,pe.useSymbolLogoAndDescription)(s),o=he(t,i?.description);return n.createElement(be,{brokerSymbol:t,logoComponent:void 0!==i?.logoUrls&&i.logoUrls.length>1?n.createElement(G.CircleLogoPair,{primaryLogoUrl:i.logoUrls[0],secondaryLogoUrl:i.logoUrls[1],size:"xsmall"}):n.createElement(j.CircleLogo,{logoUrl:i?.logoUrls?.[0],placeholderLetter:t?.[0],size:"xsmall"}),tooltipText:o})}var ve=s(527755);const we=h.enabled("show_symbol_logos")&&h.enabled("show_symbol_logo_in_account_manager");function Ce(e){const t=(0,z.useMatchMedia)(q.TradingLayoutBreakpoint.Mobile);return we?t?n.createElement(ge,{...e}):n.createElement(fe,{...e}):t?n.createElement("span",{className:ve.title},e.brokerSymbol):n.createElement(be,{...e})}var ye=s(226136);function Se(e){return 1===e?ye.blue:ye.red}
function Ee(e){const{side:t}=e;return n.createElement("span",{className:Se(t)},(0,H.sideToText)(t))}function xe(e){const{side:t}=e;return n.createElement("span",{className:Se(t)},(0,H.positionSideToText)(t))}var Fe=s(137684);function Te(e){const{value:t,noWrap:s}=e;return n.createElement("span",{className:a()(Fe.text,s&&Fe.noWrap)},t)}var Pe=s(341384);function ke(e){const{className:t,value:s,currency:i}=e;return n.createElement("span",{className:a()(Pe.wrapper,t)},n.createElement("span",null,s),i&&n.createElement("span",{className:Pe.currency},i))}function Ie(e){return e?` ${e}`:""}function De(e){const{priceFormatter:t,price:s,prevPrice:i}=e,n=t.format(s);if(void 0===i)return{same:n};const o=t.format(i),r=n.split("").findIndex(((e,t)=>e!==o[t]));if(-1===r)return{same:n};return{same:n.substring(0,r),differs:n.substring(r)}}function Re(e){const{price:t,prevPrice:s,currency:i,lastCharSup:o}=e,{same:r,differs:a}=De(e),l=function(e){const{differs:t,price:s,prevPrice:i,lastCharSup:o,same:r}=e;return void 0!==t&&void 0!==i?n.createElement(n.Fragment,null,r,n.createElement("span",{className:s>i?ye.green:ye.red},o?Me(t):t)):o?Me(r):(0,L.forceLTRStr)(r)}({differs:a,price:t,prevPrice:s,lastCharSup:o,same:r});return i?n.createElement(ke,{value:l,currency:i}):n.createElement("span",null,l)}function Me(e){const t=/^([^]*)(\S)(\s*)$/.exec(e);return"0"===e||null===t?n.createElement(n.Fragment,null,(0,L.forceLTRStr)(e)):n.createElement(n.Fragment,null,t[1],n.createElement("sup",null,t[2]),void 0!==t[3]&&""!==t[3]&&n.createElement("sup",null,t[3]))}const Ae={3:ye.gray,6:ye.blue,5:ye.red,2:ye.green,1:ye.orange,4:void 0};function Ue(e){const{status:t}=e;return n.createElement("span",{className:Ae[t],style:{textTransform:"capitalize"}},(0,p.orderStatusToText)(t))}var Oe=s(960521);function Ne(e,t=2){if(!(0,p.isDefined)(e)||isNaN(e)||"number"!=typeof e)return"";const s=(0,Oe.Big)(10).pow(-(t+1));return(0,L.forceLTRStr)((0,Oe.Big)(e).abs().lt(s)?V(t).format(0):V(t).format(e))}function Be(e){return new Oe.Big(e).round(2)}function Ve(e){const t=Be(e);return t.gt(0)?ye.green:t.lt(0)?ye.red:ye.grey}function Le(e){return`${Be(e).gt(0)?"+":""}${Ne(e)}`}function We(e){const{profit:t,currency:s}=e;return(0,M.isNumber)(t)?(0,L.forceLTRStr)(Le(t)+Ie(s)):""}function He(e){const{profit:t,currency:s}=e;if(!(0,M.isNumber)(t))return n.createElement("span",null);const i=(0,L.forceLTRStr)(Le(t)),o=Ve(t);return void 0===s?n.createElement("span",{className:o},i):n.createElement(ke,{value:i,currency:s,className:o})}function ze({profit:e}){if(!(0,M.isNumber)(e))return n.createElement("span",null);const t=(0,L.forceLTRStr)(Le(e)),s=Ve(e);return n.createElement("span",{className:s},`${t}%`)}var qe=s(980956);const Ke=new I.DateTimeFormatter,Ge=new class{constructor(){this._dateFormatter=new R.DateFormatter,this._timeFormatter=new D.TimeFormatter}format(e){const t=new Date(e.dateOrDateTime);let s=this._dateFormatter.format(t);return e.hasTime&&(s+=" "+this._timeFormatter.format(t)),s}formatLocal(e){const t=new Date(e.dateOrDateTime)
;let s=this._dateFormatter.formatLocal(t);return e.hasTime&&(s+=" "+this._timeFormatter.formatLocal(t)),s}},je=i.t(null,void 0,s(351514)).toLowerCase(),$e=i.t(null,void 0,s(381849)).toLowerCase();function Qe({values:e}){return e.join(" ")}function Ze(e){const{values:[t,s],prevValues:[i]=[void 0],priceFormatter:n}=e;return(0,p.isDefined)(t)&&(0,M.isNumber)(t)?function(e){const{same:t,differs:s}=De(e),i=`${t}${s||""}`,n=Ie(e.currency);return(0,L.forceLTRStr)(i+n)}({price:t,prevPrice:i??void 0,priceFormatter:n,currency:s}):""}function Je({values:[e]}){return{value:(0,p.isDefined)(e)&&!isNaN(e)?e:""}}const Ye=[{name:"symbol",formatElement:({values:[e,t,s,i]})=>n.createElement(Ce,{brokerSymbol:e,symbol:t,message:s,isDelayed:i}),formatText:({values:[e]})=>(0,p.getSymbolNameOverFullname)(e)},{name:"side",formatElement:({values:[e]})=>n.createElement(Ee,{side:e}),formatText:({values:[e]})=>(0,H.sideToText)(e)},{name:"positionSide",formatElement:({values:[e]})=>n.createElement(xe,{side:e}),formatText:({values:[e]})=>(0,H.positionSideToText)(e)},{name:"text",formatElement:e=>n.createElement(Te,{value:Qe(e)}),formatText:Qe},{name:"type",formatText:({values:[e,t,s]})=>(0,H.orderTypeToText)({orderType:e,parentId:t,stopType:s})},{name:"formatPrice",formatElement:({values:[e],priceFormatter:t,prevValues:[s]=[void 0]})=>(0,p.isDefined)(e)&&(0,p.isDefined)(t)?n.createElement(Re,{priceFormatter:t,price:e,prevPrice:s??void 0}):void 0,formatText:Ze,formatRaw:Je,isPriceFormatterNeeded:!0},{name:"formatPriceForexSup",formatElement:({values:[e],priceFormatter:t,prevValues:[s]=[void 0]})=>(0,p.isDefined)(e)?n.createElement(Re,{priceFormatter:t,price:e,prevPrice:s??void 0,lastCharSup:t instanceof U.PriceFormatter&&t.hasForexAdditionalPrecision()}):void 0,formatText:Ze,formatRaw:Je,isPriceFormatterNeeded:!0},{name:"formatPriceInCurrency",formatElement:({values:[e,t],priceFormatter:s,prevValues:[i]=[void 0]})=>(0,p.isDefined)(e)?n.createElement(Re,{priceFormatter:s,price:e,prevPrice:i??void 0,currency:t}):void 0,formatText:Ze,formatRaw:({values:[e,t]})=>[{...Je({values:[e]}),title:je},{value:t||"",title:$e}],isPriceFormatterNeeded:!0},{name:"status",formatElement:({values:[e]})=>(0,p.isDefined)(e)?n.createElement(Ue,{status:e}):void 0,formatText:({values:[e]})=>(0,p.isDefined)(e)?(0,W.capitalizeFirstLetter)((0,H.orderStatusToText)(e)):""},{name:"date",formatText:({values:[e]})=>(0,p.isDefined)(e)&&tt(e)?Ke.format(new Date(e)):""},{name:"localDate",formatText:({values:[e]})=>(0,p.isDefined)(e)&&tt(e)?Ke.formatLocal(new Date(e)):""},{name:"dateOrDateTime",formatText:({values:[e]})=>(0,p.isDefined)(e)&&tt(e.dateOrDateTime)?Ge.format(e):""},{name:"localDateOrDateTime",formatText:({values:[e]})=>(0,p.isDefined)(e)&&tt(e.dateOrDateTime)?Ge.formatLocal(e):""},{name:"fixed",formatText:({values:[e]})=>Ne(e),formatRaw:Je},{name:"fixedInCurrency",formatElement:({values:[e,t]})=>(0,p.isDefined)(e)&&(0,p.isDefined)(t)?n.createElement(ke,{value:Ne(e),currency:t}):Ne(e),formatText:({values:[e,t]})=>{const s=Ne(e),i=Ie(t);return s?(0,L.forceLTRStr)(s+i):s},
requiredFieldsIndexes:[0]},{name:"variablePrecision",formatText:({values:[e]})=>!(0,p.isDefined)(e)||isNaN(e)?"":(0,L.forceLTRStr)(V().format((0,k.fixComputationError)(e))),formatRaw:Je},{name:"pips",formatText:({values:[e]})=>Ne(e,1),formatRaw:Je},{name:"integerSeparated",formatText:({values:[e]})=>(0,M.isNumber)(e)?(0,L.forceLTRStr)((0,qe.quantityFormatter)({decimalPlaces:0}).format(e)):"",formatRaw:Je},{name:"formatQuantity",formatText:({values:[e]})=>(0,M.isNumber)(e)?(0,L.forceLTRStr)(qe.defaultQuantityFormatter.format(e)):"",formatRaw:Je},{name:"profit",formatElement:({values:[e]})=>(0,p.isDefined)(e)?n.createElement(He,{profit:e}):void 0,formatText:({values:[e]})=>(0,p.isDefined)(e)?We({profit:e}):"",formatRaw:Je},{name:"profitInInstrumentCurrency",formatElement:({values:[e,t]})=>(0,p.isDefined)(e)?n.createElement(He,{profit:e,currency:t}):void 0,formatText:({values:[e,t]})=>(0,p.isDefined)(e)?We({profit:e,currency:t}):"",formatRaw:({values:[e,t]})=>[{...Je({values:[e]}),title:je},{value:t||"",title:$e}],requiredFieldsIndexes:[0]},{name:"profitInPercent",formatElement:({values:[e]})=>(0,p.isDefined)(e)?n.createElement(ze,{profit:e}):void 0,formatText:({values:[e]})=>(0,p.isDefined)(e)?`${We({profit:e})}%`:"",formatRaw:({values:[e]})=>({value:(0,p.isDefined)(e)?`${We({profit:e})}%`:""})},{name:"percentage",formatText:({values:[e]})=>(0,M.isNumber)(e)?(0,L.forceLTRStr)((0,A.getPercentageFormatter)().format(e)):"",formatRaw:e=>({...Je(e),title:"%"})},{name:"marginPercent",formatText:({values:[e]})=>(0,p.isDefined)(e)?isFinite(e)?e<.01?e+"%":(0,A.getPercentageFormatter)().format(e):"> 200%":"",formatRaw:({values:[e]})=>({value:isFinite(e)?Je({values:[e]}).value:"",title:"%"})},{name:"empty",formatText:()=>""}],Xe={name:"default",formatText:Qe};function et(e){return Ye.find((t=>t.name===e))??Xe}function tt(e){return"number"==typeof e?e>0:""!==e}var st=s(718767);function it(e){const t=document.createElement("div");return t.style.position="relative",!1!==e?.stretch&&t.classList.add(st.stretch),t}var nt=s(920057);function ot(e){return void 0!==e.sortProp&&""!==e.sortProp?e.sortProp:e.dataFields.length>0?e.dataFields[0]:void 0}function rt(e,t){return void 0===e&&void 0!==t?1:void 0!==e&&void 0===t?-1:void 0===e||void 0===t?0:e<t?1:e>t?-1:0}class at{constructor(e){this.onRowsChanged=new T.Delegate,this.onRowChanged=new T.Delegate,this._rowsData=new Map,this._priceFormatters=new Map,this._rows=[],this._isActive=!1,this._sortingPostponed=!1,this._sortingMode=null;const{columns:t,options:s,priceFormatterGetter:i,reverse:n=!0}=e,{idProperty:o,defaultSortingParameters:r,group:a}=s;this._idProperty=o,this._reverse=n,this._defaultSortingInfo=void 0!==r?{sortingProperty:r.property,sortingMode:!1===r.asc?1:0}:void 0,this._group=a,this._priceFormatterGetter=i,this._sortAndGroupRowsThrottled=(0,nt.default)((()=>{this._sortAndGroupRows(),this._update()}),1e3),this._columns=new Map(t.map((e=>[e.id,e])))}setActive(e){this._isActive=e,this._onTableStateChanged(e)}addRow(e){const t=e[this._idProperty]
;this._rowsData.has(t)?this._updateRow(t,e):(this._addRowData(e),this._sortAndGroupRowsThrottled.cancel(),this._sortAndGroupRows(),this._update())}addRows(e){for(const t of e){const e=t[this._idProperty];this._rowsData.has(e)?this._updateRowData(e,t):this._addRowData(t)}this._sortAndGroupRows(),this._update()}rows(){return this._rows}data(){return this._rowsData}deleteRow(e){const t=this._rowsData.get(e);void 0!==t&&(this._rowsData.delete(e),this._rows.splice(this._rows.indexOf(t),1),this._update())}deleteRows(){this._deleteRows(),this._update()}destroy(){this._sortAndGroupRowsThrottled.cancel(),this._deleteRows()}setSortingState(e){this._sortingColumn===e.column&&this._sortingMode===e.mode||(this._sortingColumn=e.column,this._sortingMode=e.mode,this._onSortingChange())}async resolvePriceFormatter(e){if(void 0!==this._priceFormatterGetter)try{const t=this._rowsData.get(e);if(void 0===t||void 0!==t.priceFormatter)return;t.priceFormatter=null;const s=this._priceFormatters.get(e);if(void 0!==s)return t.priceFormatter=s,void this._update();const i=await this._priceFormatterGetter(t);this._priceFormatters.set(e,i),t.priceFormatter=i,this._update()}catch{}}_deleteRows(){this._rowsData.clear(),this._rows=[]}_sortAndGroupRows(){this._isActive?this._rows.sort(((e,t)=>function(e){const{aRow:t,bRow:s,sortingMode:i,sortingProperty:n,groupDefiner:o}=e;let r=0;if(void 0!==o&&(r=rt(o(t),o(s))),0===r&&(r=t.isTotalRow?1:s.isTotalRow?-1:0),null===i||0!==r||void 0===n)return r;let a=t[n],l=s[n];return void 0!==a?.dateOrDateTime&&(a=a.dateOrDateTime,l=l?.dateOrDateTime??1/0),r=rt(a,l),0===i?-r:r}({aRow:e,bRow:t,groupDefiner:this._group,...this._getSortingInfo()}))):this._sortingPostponed=!0}_getSortingInfo(){const e=void 0!==this._sortingColumn?this._columns.get(this._sortingColumn):void 0,t=void 0!==e?ot(e):void 0;return void 0!==t?{sortingProperty:t,sortingMode:this._sortingMode}:{sortingProperty:this._defaultSortingInfo?.sortingProperty,sortingMode:this._defaultSortingInfo?.sortingMode??null}}_onSortingChange(){this._sortAndGroupRowsThrottled.cancel(),null===this._sortingMode&&this._resetRowsOrder(),this._sortAndGroupRows(),this._update()}_resetRowsOrder(){this._rows=[...this._rowsData.values()],this._reverse&&this._rows.reverse()}_onTableStateChanged(e){if(!e)return this._sortAndGroupRowsThrottled.cancel(),void(this._sortingPostponed=!0);this._update()}_update(){this._isActive&&(this._sortingPostponed&&(this._sortingPostponed=!1,this._sortAndGroupRows()),this.onRowsChanged.fire())}_updateRowData(e,t){const s=(0,l.ensureDefined)(this._rowsData.get(e)),{prevValue:i,priceFormatter:n,...o}=s;for(const e of Object.keys(s))delete s[e];Object.assign(s,t,{priceFormatter:n,prevValue:o}),this.onRowChanged.fire(e);const r=this._group?.(s)!==this._group?.(o),{sortingProperty:a}=this._getSortingInfo();(void 0!==a&&t[a]!==o[a]||r)&&this._sortAndGroupRowsThrottled()}_updateRow(e,t){this._updateRowData(e,t),this._update()}_addRowData({...e}){this._rowsData.set(e[this._idProperty],e),this._reverse?this._rows.unshift(e):this._rows.push(e)}}
var lt,ct,ut,dt=s(748838),ht=s(586240),pt=s(898237),mt=s(505357),gt=s(87523),_t=s(281670),bt=s(290556);function ft(e){switch(e){case"xsmall":return"xsmall";case"small":return"small";case"medium":return"medium";default:return}}!function(e){e.XSmall="xsmall",e.Small="small",e.Medium="medium"}(lt||(lt={})),function(e){e.Left="left",e.Center="center"}(ct||(ct={})),function(e){e.Prev="prev",e.Next="next"}(ut||(ut={}));var vt=s(878112),wt=s(210667),Ct=s.n(wt);function yt(e){return n.createElement(pt.LightButton,{className:Ct().arrow,variant:"secondary",color:"gray",onClick:e.onClick,startSlot:n.createElement(vt.Icon,{icon:(t=e.direction,s=e.size,"xsmall"===s?"prev"===t?bt:_t:"prev"===t?gt:mt)}),"aria-label":e.ariaLabel,disabled:e.disabled,reference:e.reference,tabIndex:e.tabIndex,size:e.size,iconOnly:!0});var t,s}var St=s(264961),Et=s.n(St);function xt(e){const{pageNumber:t,currentPage:s,renderComponent:i,reference:o,getHref:r,getNumberAriaLabel:a,onClick:l,tabIndex:c,fallbackToDummyHref:u=!1,size:d}=e,{href:h,handleClick:p}=function(e){const{getHref:t,fallbackToDummyHref:s,pageNumber:i,onClick:o}=e,r=(0,n.useMemo)((()=>t?t(i):s?"#":void 0),[t,s,i]),a=(0,n.useCallback)((e=>{!s||r&&"#"!==r||e.preventDefault(),o&&o(e,i)}),[o,s,i,r]);return{href:r,handleClick:a}}({pageNumber:t,getHref:r,fallbackToDummyHref:u,onClick:l});return n.createElement(pt.LightAnchorButton,{className:Et().number,renderComponent:i,variant:t===s?"primary":"ghost",color:"gray",isSelected:t===s,"aria-current":t===s,reference:o,href:h,onClick:p,tabIndex:c,"aria-label":a?a(t):void 0,ellipsis:!1,size:ft(d)},t)}var Ft=s(855393);var Tt=s(708886),Pt=s(65160);function kt({lastPage:e,currentPage:t}){const s=(0,n.useMemo)((()=>function(e){const t=[];for(let s=1;s<=e;s++)t.push(s);return t}(e)),[e]),i=(0,n.useRef)(null),o=(0,n.useRef)(null),r=(0,n.useRef)(0),a=(0,n.useRef)(0),l=(0,n.useRef)(t),[c,u]=(0,n.useState)(!1),[d,h]=(0,n.useState)(0),[p,m]=(0,n.useState)(!1),[g,_]=(0,n.useState)(!1),b=(0,n.useCallback)((i=>[s[0],t,e].includes(i)),[s,t,e]);(0,Ft.useIsomorphicLayoutEffect)((()=>{if(t===l.current)return;const i=l.current===s[0]&&t===e,n=l.current===e&&t===s[0];u(i||n),l.current=t}),[t,s,e]);const f=(0,n.useCallback)((e=>{const i=e.widthsMap.get("number")??0,n=function(e){if(!e||!window)return-1;const t=window.getComputedStyle(e),s=t.getPropertyValue("--ui-lib-pagination-items-gap");if(""===s)return-1;return parseInt(s)}(o.current);let l=2*r.current+a.current;-1!==n&&(l-=n);const c=i+4,{dotsCount:u,...d}=function({currentPage:e,elements:t,containerWidth:s,elementWidth:i,dotsWidth:n,maxItemsCount:o}){if(t.length*i<=s&&t.length<=o)return{visible:[...t],hidden:[],dotsCount:0};const r=t.indexOf(e);let a=s-2*n-2*i,l=Math.min(Math.floor(a/i),o-4);const c=Math.floor((l-1)/2),u=l-c-1;return r-c-1<=0?(a=s-n-i,l=Math.min(Math.floor(a/i),o-2),{visible:[...t.slice(0,l),t[t.length-1]],hidden:t.slice(l,t.length-1),dotsCount:1}):r+u+1>=t.length-1?(a=s-n-i,l=Math.min(Math.floor(a/i),o-2),{visible:[t[0],...t.slice(t.length-l,t.length)],hidden:t.slice(1,t.length-l),dotsCount:1
}):{visible:[t[0],...t.slice(r-c,r),e,...t.slice(r+1,r+u+1),t[t.length-1]],hidden:[...t.slice(1,r-c),...t.slice(r+u+1,t.length-1)],dotsCount:2}}({currentPage:t,elements:s,containerWidth:e.containerWidth-l,elementWidth:c,dotsWidth:e.moreButtonWidth,maxItemsCount:r.current>0?11:13}),g=e.moreButtonWidth*u,b=d.visible.length*c+l+(g+4);h(b),m(e.containerWidth-b<c);const f=d.visible.length*c+u*c-4,v=e.containerWidth-f;return _((!p||v>0&&v<c)&&0!==b),d}),[s,t]),v=(0,n.useCallback)((()=>{r.current=i.current?(0,Pt.outerWidth)(i.current,!0):0,a.current=o.current?(0,Pt.outerWidth)(o.current,!0):0}),[]),{containerRefCallback:w,moreButtonRef:C,innerContainerRefCallback:y,itemsRefs:S,setItemRef:E,hiddenItems:x,visibleItems:F}=(0,Tt.useCollapsibleCommon)({itemsList:s,getItemId:It,calcVisibleAndHiddenItems:f,shouldKeepItemVisible:b,onMeasureCallback:v,forceUpdate:c});return{numbers:s,containerRefCallback:w,innerContainerRefCallback:y,itemsRefs:S,setItemRef:E,dotsRef:C,arrowButtonRef:i,endSlotRef:o,visible:F,hidden:x,contentWidth:d,shouldStretch:p,isReadyToShow:g}}function It(e){return"number"}var Dt=s(612554);function Rt(e){const{className:t,lastPage:s,currentPage:i,withArrows:o,prevPageAriaLabel:r,nextPageAriaLabel:l,paginationAriaLabel:c,renderComponent:u,getHref:d,getNumberAriaLabel:h,onNumberClick:p,onPrevClick:m,onNextClick:g,endSlot:_,isCompact:b,bottomSlot:f,size:v,position:w}=e,{visible:C,numbers:y,containerRefCallback:S,innerContainerRefCallback:E,setItemRef:x,dotsRef:F,arrowButtonRef:T,endSlotRef:P,contentWidth:k,shouldStretch:I,isReadyToShow:D}=kt({lastPage:s,currentPage:i}),R=b&&I,M=ft(v),A=(0,Dt.useFadeInContext)();return(0,n.useEffect)((()=>{D&&A()}),[D,A]),n.createElement("div",{className:a()(Et()["numbers-wrapper"],t)},n.createElement("nav",{className:a()(Et().numbers,Et()[`size-${v}`],b&&Et().numbersOnTop,R&&Et().compact,Et()[`position-${w}`]),"aria-label":c},o&&n.createElement(yt,{onClick:m,ariaLabel:r,disabled:1===i,direction:"prev",size:M}),n.createElement("div",{className:a()(Et().numbersRow)},C.map(((e,t)=>n.createElement(n.Fragment,{key:e},1===t&&C[1]!==y[1]&&n.createElement(Mt,{size:v}),n.createElement(xt,{pageNumber:e,renderComponent:u,currentPage:i,getHref:d,onClick:p,getNumberAriaLabel:h,fallbackToDummyHref:!0,size:v}),t===C.length-2&&C[t]!==y[y.length-2]&&n.createElement(Mt,{size:v}))))),o&&n.createElement(yt,{onClick:g,ariaLabel:l,disabled:i===s,direction:"next",size:M}),n.createElement("div",{ref:P,className:Et()["numbers-end-slot"]},_)),n.createElement("div",{"aria-hidden":!0,className:Et()["fake-numbers"],ref:S},n.createElement("div",{className:Et()["fake-numbers-inner"],ref:E},n.createElement(Mt,{reference:F,size:v}),n.createElement(xt,{pageNumber:999,renderComponent:u,currentPage:i,reference:x("number"),tabIndex:-1,size:v}),o&&n.createElement(yt,{direction:"prev",reference:T,tabIndex:-1,size:M}))),n.createElement("div",{style:{width:`${k}px`},className:Et()[`description-position-${w}`]},f))}function Mt(e){return n.createElement("span",{"aria-hidden":!0,
className:a()(Et().dots,Et()[`size-${e.size}`]),ref:e.reference},"…")}var At=s(878569),Ut=s.n(At);function Ot(e){const{getDescriptionAriaLabel:t,getDescriptionChunks:s,itemsPerPage:i=0,totalAmountOfItems:o=0,currentPage:r,size:l,withSelect:c,isCompact:u}=e;if(!s)return null;const d=(r-1)*i+1;let h=d+i-1;h>o&&(h=o);const p=s(d,h,o),m=t?t(d,h,o):void 0;return n.createElement("div",{className:a()(Ut().description,Ut()[`size-${l}`],(c||!u)&&Ut()["with-select"]),"aria-label":m},p.map(((e,t)=>n.createElement(Nt,{...e,key:t}))))}function Nt(e){return e.isHighlighted?n.createElement("strong",{className:Ut()["description-strong"]},e.text):n.createElement("span",null,e.text)}var Bt=s(685463),Vt=s.n(Bt);function Lt(e){const{select:t,getDescriptionAriaLabel:s,getDescriptionChunks:i,itemsPerPage:o,totalAmountOfItems:r,isCompact:l,className:c,size:u="medium",position:d="left",...h}=e,p={getDescriptionAriaLabel:s,getDescriptionChunks:i,itemsPerPage:o,totalAmountOfItems:r,currentPage:e.currentPage,size:u,withSelect:Boolean(t),isCompact:l},m=Boolean(i&&i(0,0,0).length),g=(0,z.useSafeMatchMedia)(ht["media-phone-vertical"]),_=(0,z.useSafeMatchMedia)(ht["media-extreme-thin"]),b=l??g,f=Boolean(b&&(t||m||_)),v=!b&&t,w=f&&t;return n.createElement("div",{className:a()(Vt().pagination,c)},n.createElement("div",{className:Vt()["pagination-group"]},n.createElement(Rt,{...h,withArrows:!f,isCompact:f,endSlot:v?n.createElement("div",{className:Vt().select},t):void 0,bottomSlot:f?void 0:n.createElement(Ot,{...p}),size:u,position:d})),f&&n.createElement("div",{className:Vt()["pagination-group"]},n.createElement(yt,{onClick:e.onPrevClick,ariaLabel:e.prevPageAriaLabel,disabled:1===e.currentPage,direction:"prev",size:ft(u)}),n.createElement("div",{className:Vt()["compact-middle-slot"]},t||n.createElement(Ot,{...p})),n.createElement(yt,{onClick:e.onNextClick,ariaLabel:e.nextPageAriaLabel,disabled:e.currentPage===e.lastPage,direction:"next",size:ft(u)})),w&&n.createElement(Ot,{...p}))}var Wt,Ht,zt,qt,Kt,Gt=s(930202),jt=s(232295),$t=s(515916),Qt=s(269103),Zt=s(628726),Jt=(s(420114),s(284170)),Yt=s(662941);!function(e){e[e.Mobile=0]="Mobile",e[e.Desktop=1]="Desktop"}(Wt||(Wt={})),function(e){e[e.Asc=0]="Asc",e[e.Desc=1]="Desc"}(Ht||(Ht={})),function(e){e.Settings="settings"}(zt||(zt={})),function(e){e.Head="head"}(qt||(qt={})),function(e){e.Right="right",e.Left="left",e.Up="up",e.Down="down"}(Kt||(Kt={}));const Xt="data-is-setting-button-focused",es="data-head-informer";var ts=s(909450),ss=s(273388),is=s(595943),ns=s(152601),os=s(778240),rs=s(248606),as=s(963632),ls=s(297265),cs=s(753327),us=s(413530),ds=s(935495),hs=s(516698);const ps=new as.WatchedValue(null).readonly(),ms=i.t(null,void 0,s(156194));function gs(e){const{items:t,tabIndex:s,onCheck:i,overlapManagerWV:o,reference:r}=e,a=(0,n.useRef)(null),l=(0,ls.useWatchedValueReadonly)({watchedValue:o??ps}),{anchorProps:c,popoverProps:d}=(0,rs.useMenuAnchorProps)(),h=(0,n.useMemo)((()=>t.filter((e=>e.visible))),[t]);return(0,n.useImperativeHandle)(r,(()=>({focus:()=>{d.isOpen||a.current?.focus()}}))),
n.createElement(cs.SlotContext.Provider,{value:l},n.createElement(is.Tooltip,{content:ms,isRtl:(0,L.isRtl)(),trigger:J.mobiletouch?[is.Trigger.Focus]:[is.Trigger.Hover,is.Trigger.Focus]},n.createElement(pt.LightButton,{...c,role:"button",reference:(0,ss.mergeRefs)([c.reference,a]),className:us.button,startSlot:n.createElement(vt.Icon,{icon:ds}),"aria-label":ms,title:ms,onClick:function(e){e.stopPropagation(),c.onClick(e)},"data-name":"columns-filter-button",tabIndex:s,size:"xsmall",variant:"ghost",color:"gray",iconOnly:!0})),n.createElement(ns.PopoverKeyboardNavigator,{role:"menu",anchored:{type:"element",at:d.anchorButtonRef},isOpen:d.isOpen,onClose:d.onClose,ariaLabelledby:d.anchorId,idOfContentWrapperElement:d.contentId,closeOnScrollOutside:!1,"data-name":"popup-menu-container",mobileBreakpoint:u.CheckMobile.any()?hs.ALWAYS_DRAWER_POPOVER_BREAKPOINT:hs.ALWAYS_DROPDOWN_POPOVER_BREAKPOINT},t.map(((e,t)=>n.createElement(os.CheckboxPopoverItem,{key:`checkbox-${t}:${e.id}`,title:e.title,onClick:()=>i(e.id),checked:e.visible,ariaChecked:e.visible,disabled:1===h.length&&h[0].id===e.id,"data-name":`${e.id}-menu-item`,role:"menuitemcheckbox"})))))}var _s=s(542795);function bs(e){const{isSticky:t,...s}=e;return n.createElement("div",{className:a()(_s.container,t&&_s.sticky)},n.createElement(gs,{...s}))}var fs=s(298314),vs=s(116812),ws=s(469690),Cs=s(128231),ys=s.n(Cs),Ss=s(436455),Es=s(762370);const xs="HeadCell",Fs=.4,Ts={"--head-cell-wrapper-tooltip-size":`${16}px`,"--head-cell-wrapper-tooltip-gap":`${5}px`};function Ps(e){const{column:t,alignment:s,dispatch:i,onColumnsReordered:o,canBeReordered:r,informerText:l,focusedCell:c}=e,u=(0,n.useRef)(null),[{isDragging:d},h,p]=(0,vs.useDrag)((()=>({type:xs,item:{id:t.key},canDrag:()=>r,collect:e=>({isDragging:e.isDragging()})}))),[,m]=(0,ws.useDrop)((()=>({accept:xs,hover:(e,s)=>{if(e.id===t.key)return;const n=u.current?.getBoundingClientRect(),o=s.getClientOffset(),r=s.getDifferenceFromInitialOffset();void 0!==n&&null!==o&&null!==r&&function(e,t,s,i){const n=t-s,o=.4*(i-s);return e>0?n>o:n<o}(r.x,o.x,n.left,n.right)&&i({type:Zt.ActionType.ReorderColumns,columnKey:e.id,targetColumnKey:t.key})},drop:()=>{o()},canDrop:()=>r})));(0,n.useEffect)((()=>{r&&h(m(u)),p((0,fs.getEmptyImage)(),{captureDraggingState:!0})}),[t]);const g=c?.columnKey===t.key&&"head"===c?.rowKeyValue;return n.createElement("div",{ref:u,className:a()(Es.wrapper,Ss.wrapper,"right"===s&&Ss.rightAligned),style:{...Ts,opacity:d?Fs:1},onClick:function(){i({type:Zt.ActionType.UpdateSortDirection,columnKey:t.key},!0)}},n.createElement(ys(),{...e}),l&&n.createElement(K.IconQuestionInformation,{...ee(l),icon:"info",className:Ss.tooltipIcon,tabIndex:g?0:-1,[es]:"true"}))}var ks=s(327066),Is=s.n(ks);function Ds(e){const{visibilityHandler:t,...s}=e;return(0,n.useLayoutEffect)((()=>(t(s.rowKeyValue,!0),()=>t(s.rowKeyValue,!1))),[]),n.createElement(Is(),{...s})}function Rs(e,t){if(0===e.length)return[[t],[t.prevValue]];const[s,i]=e.reduce(((e,s)=>(e[0].push(t[s]),e[1].push(t.prevValue?.[s]),e)),[[],[]]);return[s,i]}
const Ms=(0,s(993545).memoize)(et);var As=s(908932);function Us(e){const{label:t,children:s,informerText:i}=e,o=void 0!==t;return n.createElement("div",{className:a()(As.wrapper,!o&&As.hiddenLabel)},o&&n.createElement("span",{className:As.labelWrapper},n.createElement("span",{className:As.label},t),i&&n.createElement(K.IconQuestionInformation,{...ee(i),icon:"info",className:As.tooltipIcon})),s&&n.createElement("span",{className:As.contentWrapper},n.createElement("span",{className:a()(As.content,o&&As.withPadding)},s)))}var Os,Ns=s(394212),Bs=s(10170),Vs=s(73288),Ls=s(139043);!function(e){e.Edit="edit",e.Close="close"}(Os||(Os={}));const Ws=(0,n.createContext)({lastActiveButtonIndex:null,setLastActiveButtonIndex:()=>{},moveCellFocus:()=>{}});function Hs(e){const{moveCellFocus:t,focusedCell:s,children:i}=e,[o,r]=(0,n.useState)(null);return n.createElement(Ws.Provider,{value:{lastActiveButtonIndex:o,setLastActiveButtonIndex:r,moveCellFocus:t,focusedCell:s}},i)}var zs=s(104432);function qs(e){const{columnsFilterItems:t,columnsFilterProps:s,tableProps:i,updateTableProps:o,tableWrapperAttributes:r,isMobile:a,moveCellFocus:l}=e,[c,u,d,h]=(0,Ls.useOverlayScroll)(),[p,m]=(0,n.useState)(0),g=(0,n.useRef)(null),_=(0,n.useCallback)((()=>({...r,...u,ref:d})),[r,d]);(0,n.useEffect)((()=>{const e=d.current;if(null!==e)return e.addEventListener("scroll",h),()=>e.removeEventListener("scroll",h)}),[r,h]);const b=(0,n.useMemo)((()=>n.createElement($t.Table,{...i,childComponents:{...i.childComponents,tableWrapper:{elementAttributes:_}},dispatch:o})),[_,o,i,a]);(0,n.useEffect)((()=>{if(null===g.current||null===d.current)return;const e=g.current.getBoundingClientRect().bottom-d.current.getBoundingClientRect().bottom|0;m(e)}),[i.paging]);const f={"--table-wrapper-scroll-bottom-offset":`${p}px`},v="settings"===i.focused?.cell?.columnKey&&"head"===i.focused?.cell?.rowKeyValue?0:-1;return n.createElement(n.Fragment,null,0!==t.length&&n.createElement(bs,{...s,tabIndex:v,items:t}),n.createElement("div",{className:zs.scrollWrapper,ref:g,style:f},n.createElement(Ns.DndProvider,{backend:Bs.HTML5Backend},n.createElement(Hs,{moveCellFocus:l,focusedCell:i.focused?.cell},n.createElement(Vs.OverlayScrollContainer,{...c,className:zs.scrollContainer}),b))))}const Ks={0:Zt.SortDirection.Ascend,1:Zt.SortDirection.Descend},Gs=i.t(null,void 0,s(146018)),js=h.enabled("show_symbol_logos")&&h.enabled("show_symbol_logo_in_account_manager");class $s{constructor(e=0){this._mode=e}value(){return this._mode}next(){switch(this._mode){case 0:this._mode=1;break;case 1:this._mode=null;break;case null:this._mode=0}return this._mode}reset(){this._mode=0}}function Qs({values:e}){return e.map((e=>null!=e?String(e):"")).join(" ").replace(/&nbsp;/g," ")}const Zs=new U.PriceFormatter;function Js(e){return`Column ${e} metainfo`}function Ys(e,t){return!1===e.showZeroValues&&t.every((e=>0===e))}function Xs(e){return i.t(null,{replace:{pageNumber:String(e)}},s(678158))}jt.default.fieldDelimiter="";class ei{constructor(e){this.onTableVisibilityChange=new T.Delegate,
this.onBottomVisibilityChange=new T.Delegate,this.onSizeChange=new T.Delegate,this.onSortingChange=new T.Delegate,this._animationFrameId=0,this._isVisible=!1,this._rowsElements=new Map,this._rowsDisplayOptions=new Map,this._highlightTimeoutIds=new Map,this._formatters=new Map,this._visibleColumns=new Set,this._cellContentCaches=new WeakMap,this._hiddenFilterColumns=new Set,this._visibleRows=new Set,this._isScrolled=!1,this._isPaginationShown=!1,this._columnsFilterReference=null,this.clearFocused=()=>{this._updateTableProps((0,Qt.clearFocused)(),!0)},this._goToNextPage=()=>{void 0!==this._tableProps.paging?.pageIndex&&this._updateTableProps((0,Qt.updatePageIndex)(this._tableProps.paging.pageIndex+1),!0)},this._goToPrevPage=()=>{void 0!==this._tableProps.paging?.pageIndex&&this._updateTableProps((0,Qt.updatePageIndex)(this._tableProps.paging.pageIndex-1),!0)},this._handlePageNumberClick=(e,t)=>{this._updateTableProps((0,Qt.updatePageIndex)(t-1),!0)},this._makeHeadCellAttributes=({column:{key:e}})=>{const t={columnKey:e,rowKeyValue:"head"},s="settings"===e,i=e===this._fixedTitleColumnId,n=!this._columnsMetainfo.get(e)?.notSortable,o=null!==document.activeElement?.closest(`.${Es.root}`)&&this._isCellFocused(t),r=this._makeTabIndex(t),l={className:a()(Es.headCell,n&&Es.sortable,s&&!this._isMobile&&Es.rightFixedColumn,i&&!this._isMobile&&Es.leftFixedColumn),tabIndex:r,"data-name":`${e}-column`,ref:e=>{if(!(o&&e&&e instanceof HTMLElement))return;if(s)return void this._columnsFilterReference?.focus();const t=e.querySelector(`[${es}]`),i=document.activeElement;i!==t&&(t instanceof HTMLElement?t.focus():i!==e&&e.focus())},onFocus:()=>{o||this._setCellFocus(t)},onKeyDown:n=>{switch((0,Gt.hashFromEvent)(n)){case 39:i&&n.preventDefault(),this._moveCellFocus(t,"right");break;case 37:s&&n.preventDefault(),this._moveCellFocus(t,"left");break;case 38:n.preventDefault();break;case 40:{n.preventDefault();const{data:t}=this._tableProps;if(void 0===t||0===t.length)break;const s=t[0].id;this._setCellFocus({columnKey:e,rowKeyValue:s});break}case 13:case 32:n.preventDefault(),this._delayedUpdateTableProps({type:Zt.ActionType.UpdateSortDirection,columnKey:e},!0)}}};return this._isMobile||(!s&&this._fixedColumns&&(l.width="50%"),s&&this._noSettingsColumn&&0===this._getAvailableColumnsFilterItems().length&&(l.style={display:"none"})),l},this._updateTableProps=(e,t)=>{switch(e.type){case Zt.ActionType.UpdateSortDirection:const t=this._columnsMetainfo.get(e.columnKey);if(void 0===t||t.notSortable||void 0===ot(t))return;this._handleSortingUpdate(e.columnKey);break;case Zt.ActionType.UpdatePageIndex:this._resetTableScrollState()}this._tableProps=(0,$t.kaReducer)(this._tableProps,e),t?this._render(!0):this._update()},this._makeHeadCellContent=e=>{const{column:t}=e;if("settings"===t.key){const e=this._getAvailableColumnsFilterItems();if(0!==e.length){const t=this._isCellFocused({columnKey:"settings",rowKeyValue:"head"})?0:-1;return n.createElement(bs,{...this._columnsFilterProps,items:e,tabIndex:t})}}const s=this._columnsMetainfo.get(t.key)
;return void 0!==s?.help?n.createElement("span",{className:"apply-common-tooltip",title:s.help},t.title):t.title},this._makeTextContent=async e=>{const{row:t,columnId:s}=e,i=this._columnsMetainfo.get(s);if(void 0===i)return"";const[n,o]=Rs(i.dataFields,t);if(Ys(i,n))return"";const r=void 0!==i.formatter?this._formatters.get(i.formatter)?.formatRaw??this._formatters.get(i.formatter)?.formatText??Qs:Qs;return await this._model.resolvePriceFormatter(t[this._idProperty]),r({values:n,prevValues:i.highlightDiff?o:void 0,priceFormatter:t.priceFormatter??Zs})},this._makeCellContent=e=>{const{row:t,rowKeyValue:s,columnId:i}=e,o=this._columnsMetainfo.get(i);if(void 0===o)return;const[r,a]=Rs(o.dataFields,t);if(Ys(o,r))return n.createElement(n.Fragment,null);let l=Qs,c=!1;if(void 0!==o.formatter){const e=this._formatters.get(o.formatter);l=e?.formatElement??e?.formatText??l,c=Boolean(e?.isPriceFormatterNeeded)}const u=this._getCellContentCaches(t),d=u.get(o.id),h=t.priceFormatter??Zs;if(0!==o.dataFields.length&&void 0!==d&&d.priceFormatter===h&&this._isMobile===d.isMobile&&(0,M.deepEquals)(r,d.values)[0])return d.content;c&&this._model.resolvePriceFormatter(t[this._idProperty]);const p=l({values:r,prevValues:o.highlightDiff?a:void 0,priceFormatter:h}),m={columnKey:i,rowKeyValue:s},g="settings"===i&&void 0!==p&&"string"!=typeof p?n.cloneElement(p,{cell:m}):p;let _;if(this._isMobile){const e=js&&"symbol"===o.formatter;_=n.createElement(Us,{label:!1===o.showLabelOnMobile||e?void 0:o.label,informerText:o.info},g)}else _=n.createElement(n.Fragment,null,g);return u.set(o.id,{values:r,content:_,priceFormatter:h,isMobile:this._isMobile}),_},this._makeRowContent=e=>n.createElement(Ds,{...e,visibilityHandler:this._handleRowVisibilityChange}),this._handleRowVisibilityChange=(e,t)=>{t?this._visibleRows.add(e):this._visibleRows.delete(e)},this._makeRowAttributes=({rowKeyValue:e,rowData:t})=>{const s=this._rowsDisplayOptions.get(e);return{className:a()(Es.row,s?.isInactive&&Es.inactiveRow,this._isFirstRow(e)&&Es.withMargin),"data-row-id":e,"data-row-linked":s?.isLinked,ref:t=>this._setRowElement(e,t),onClick:(e,t)=>{this._rowEventsHandlers?.onClick?.(t.childProps.rowData)},onMouseEnter:(e,t)=>{this._rowEventsHandlers?.onMouseEnter?.(t.childProps.rowData)},onMouseLeave:(e,t)=>{this._rowEventsHandlers?.onMouseLeave?.(t.childProps.rowData)}}},this._setRowElement=(e,t)=>{this._rowsElements.set(e,t)},this._makeCellAttributes=({column:e,rowKeyValue:t,rowData:s})=>{const{title:i,key:n}=e,o={columnKey:n,rowKeyValue:t},r=(0,l.ensureDefined)(this._columnsMetainfo.get(n),Js(n)),c="settings"===n,u=n===this._fixedTitleColumnId,d=function(e,t){if(!1===e.showOnMobile)return!0;const[s]=Rs(e.dataFields,t),i=Ms(e.formatter),n=t=>!1===e.showZeroValues&&0===t||""===t||null==t;return void 0!==i.requiredFieldsIndexes&&0!==i.requiredFieldsIndexes.length?i.requiredFieldsIndexes.some((s=>void 0===e.dataFields[s]||n(t[e.dataFields[s]]))):s.every(n)}(r,s),h=this._makeTabIndex(o),p=null!==document.activeElement?.closest(`.${Es.root}`)&&this._isCellFocused(o);return{
className:a()(Es.cell,!1===r?.showLabelOnMobile&&!1,d&&Es.hideCellOnMobile,c&&!this._isMobile&&Es.rightFixedColumn,u&&!this._isMobile&&Es.leftFixedColumn),"data-label":i,tabIndex:h,ref:e=>{if(!(p&&e&&e instanceof HTMLElement))return;const t=document.activeElement;if(c){const s=e.querySelector(`[${Xt}=true]`);if(t===s)return;if(s instanceof HTMLElement)return void s.focus()}t!==e&&e.focus()},onFocus:()=>{p||this._setCellFocus(o)},onKeyDown:e=>{switch((0,Gt.hashFromEvent)(e)){case 39:if(c){e.preventDefault();break}u&&e.preventDefault(),this._moveCellFocus(o,"right");break;case 37:if(c){e.preventDefault();if(e.currentTarget.querySelector(`[${Xt}=true]`))break}this._moveCellFocus(o,"left");break;case 38:const i=this._tableProps.data?.findIndex((e=>e.id===t));if(0===i){this._setCellFocus({columnKey:n,rowKeyValue:"head"});break}this._moveCellFocusUp();break;case 40:this._moveCellFocusDown();break;case 13:case 32:if(c)break;e.preventDefault(),this._rowEventsHandlers?.onClick?.(s)}}}},this._makeCellContentAttributes=({column:e,rowData:t})=>{const{key:s}=e,i=(0,l.ensureDefined)(this._columnsMetainfo.get(s),Js(s)),n=void 0!==i?.tooltipProperty?t[i.tooltipProperty]?.[i.id]:void 0;return{className:a()(Es.cellContent,"right"===i?.alignment&&!this._isMobile&&Es.rightAlignedCellContent,void 0!==n&&"apply-common-tooltip common-tooltip-html",!1!==i?.isCapitalize&&Es.capitalize),title:n}},this._makeTableWrapperAttributes=()=>({className:this._makeTableWrapperClassNames(),onScroll:this._onTableScroll,key:(0,Jt.randomHashN)(5)}),this._onTableScroll=e=>{const t=Math.abs(e.currentTarget.scrollLeft)>0;t!==this._isScrolled&&(this._isScrolled=t,this._tableWrapperAttributes={...this._tableWrapperAttributes,className:this._makeTableWrapperClassNames()},this._render()),this._isSupportPagination&&this._checkBottomIsVisible(e.currentTarget)},this._resizeHandler=()=>{cancelAnimationFrame(this._animationFrameId),this._animationFrameId=requestAnimationFrame((()=>{const e=this._checkIsMobile();e!==this._isMobile&&(this._isMobile=e,this._visibleColumns.clear(),this._columnsVisibilityInfo=this._makeColumnsVisibilityInfo(),this._columnsFilterProps=this._makeColumnsFilterProps(),this._tableProps.columns=this._makeColumns(),this.onSizeChange.fire(),this._update.cancel(),this._render(!0))}))},this._updatePaginationShowingState=()=>{const e=this._checkIsPaginationShown();e!==this._isPaginationShown&&(this._isPaginationShown=e,e?this._tableProps.paging={enabled:!0,pageSize:this._pageSize,pageIndex:0}:delete this._tableProps.paging)},this._saveColumnsOrder=()=>{this._trackEvent(this._id,"Reorder columns");const e=this._tableProps.columns.map((e=>e.key));this._getSettingsStorage()?.setTableColumnsOrder(this._id,e)},this._onRowsChanged=()=>{this._updatePaginationShowingState();const e=this._model.rows(),t=0===e.length;t&&this._resetTableScrollState();const s=this._tableProps?.focused?.cell;if(s&&"head"!==s.rowKeyValue){e.some((e=>e[this._idProperty]===s.rowKeyValue))||(void 0!==this._fixedTitleColumnId?this._setCellFocus({columnKey:this._fixedTitleColumnId,
rowKeyValue:"head"}):this.clearFocused())}this._updateTableProps((0,Qt.updateData)(e),t)},this._moveCellFocus=(e,t)=>{const{columnKey:s,rowKeyValue:i}=e,{columns:n}=this._tableProps,o=n.findIndex((e=>e.key===s));let r;switch(t){case"right":for(let e=o+1;e<n.length;e++)if(n[e].visible){r=n[e];break}break;case"left":for(let e=o-1;e>=0;e--)if(n[e].visible){r=n[e];break}}void 0!==r&&this._setCellFocus({columnKey:r.key,rowKeyValue:i})},this._moveCellFocusUp=()=>{this._updateTableProps((0,Qt.moveFocusedUp)({}),!0)},this._moveCellFocusDown=()=>{this._updateTableProps((0,Qt.moveFocusedDown)({}),!0)},this._setCellFocus=e=>{this._handleCellFocused?.(),this._updateTableProps((0,Qt.setFocused)({cell:e}),!0)},this._makeTabIndex=e=>{const{columnKey:t,rowKeyValue:s}=e;if(void 0===this._tableProps.focused)return this._tableProps.columns[0].key===t?0:-1;const i=this._isCellFocused(e)?0:-1;if("settings"===t){const e=this._rowElementById(s),t=e?.querySelector(`[${Xt}=true]`);return t||"head"===s?-1:i}if("head"===s){const e=this._columnsMetainfo.get(t)?.info;return e?-1:i}return i};const{id:t,model:o,title:r,className:c,container:u,columns:d,stickyMobileColumnsFilter:h,idProperty:p,overlapManager:m,fixedColumns:g,getSettingsStorage:_,rowEventsHandlers:b,trackEvent:f,fixedTitleColumnId:v,supportPagination:w,pageSize:C,isScrollBouncingEnabled:y=!1,cellFocusedHandler:S,shouldResetScrollWhenHidden:E=!0,customEmptyStateGetter:F}=e;this._id=t,this._title=r,this._model=o,this._fixedTitleColumnId=v,this._fixedColumns=g,this._pageSize=C,this._isScrollBouncingEnabled=y,this._shouldResetScrollWhenHidden=E,this._sortingColumnKey=`${this._id}.sort.column`,this._sortingModeKey=`${this._id}.sort.mode`,this._container=u,this._idProperty=p,this._overlapManager=m,this._isStickyMobileColumnsFilter=h,this._isSupportPagination=w,this._columnsMetainfo=new Map(d.map((e=>[e.id,e]))),this._getSettingsStorage=_,this._trackEvent=f,this._rowEventsHandlers=b,this._handleCellFocused=S,this._customEmptyStateGetter=()=>F?.()??Gs,w&&(this._checkBottomIsVisible=(0,x.default)(this._checkBottomIsVisible,100)),this._update=(0,nt.default)(this._render,1e3),this._delayedUpdateTableProps=(0,x.default)(this._updateTableProps,100);const P=this._getSavedSortingParameters();this._sortingColumn=P?.columnId,this._sortingModeSwitcher=new $s(void 0===P?null:P.mode),this._isMobile=this._checkIsMobile(),window.addEventListener("resize",this._resizeHandler);const k="IntersectionObserver"in window;k||(this._isVisible=!0),this._containerVisibilityObserver=k?new IntersectionObserver((e=>{e.forEach((({intersectionRatio:e})=>{this._isVisible=0!==e;const t=!this._isVisible&&this._shouldResetScrollWhenHidden;t&&this._resetTableScrollState(),this._render(t),this.onTableVisibilityChange.fire(this._isVisible)}))})):null,this._containerVisibilityObserver?.observe(this._container),this._columnsVisibilityInfo=this._makeColumnsVisibilityInfo(),this._columnsFilterProps=this._makeColumnsFilterProps(),this._tableWrapperAttributes=this._makeTableWrapperAttributes(),this._tableProps={
data:this._model.rows(),columns:this._makeColumns(),dispatch:this._updateTableProps,rowKeyField:this._idProperty,sortingMode:Zt.SortingMode.SingleTripleStateRemote,childComponents:{rootDiv:{elementAttributes:()=>({className:Es.root})},pagingPages:{content:e=>{const{pageIndex:t,pagesCount:o}=e;var r;if(this._isPaginationShown&&void 0!==t&&void 0!==o)return n.createElement(Lt,{size:"xsmall",currentPage:t+1,onPrevClick:this._goToPrevPage,onNextClick:this._goToNextPage,onNumberClick:this._handlePageNumberClick,lastPage:o,paginationAriaLabel:(r=this._title,r?i.t(null,{replace:{tableName:r}},s(978152)):i.t(null,void 0,s(347498))),nextPageAriaLabel:i.t(null,void 0,s(941916)),prevPageAriaLabel:i.t(null,void 0,s(115557)),getNumberAriaLabel:Xs})},elementAttributes:()=>({className:Es.paginationWrapper})},table:{elementAttributes:e=>({className:a()(Es.table,c),"data-selector":"table","data-name":`${t}-table`,role:"grid",tabIndex:-1,style:{borderCollapse:"separate",height:0===e.data?.length?"100%":void 0}})},tableBody:{elementAttributes:()=>({className:Es.tableBody}),content:e=>{const t=0===e.data.length,s=t?this._customEmptyStateGetter():void 0,i=void 0!==s?(0,ts.parseMarkup)(s):void 0;return t?n.createElement("tr",{className:Es.emptyStateRow},n.createElement("td",{colSpan:this._getEmptyStateColspan(),className:Es.emptyStateCell},n.createElement(Yt.EmptyStateBlock,{className:Es.emptyStateBlock,iconClass:"",text:i}))):void 0}},tableHead:{elementAttributes:()=>({className:Es.tableHead})},headRow:{elementAttributes:()=>({className:Es.headRow})},headCell:{elementAttributes:this._makeHeadCellAttributes,content:e=>{const t=this._columnsMetainfo.get(e.column.key);return n.createElement(Ps,{...e,alignment:t?.alignment??"left",dispatch:this._delayedUpdateTableProps,onColumnsReordered:this._saveColumnsOrder,canBeReordered:!this._isMobile&&"settings"!==e.column.key&&e.column.key!==this._fixedTitleColumnId,informerText:t?.info,focusedCell:this._tableProps.focused?.cell})}},cell:{elementAttributes:this._makeCellAttributes},dataRow:{content:this._makeRowContent,elementAttributes:this._makeRowAttributes},cellText:{content:({column:e,rowKeyValue:t,rowData:s})=>this._makeCellContent({columnId:e.key,row:s,rowKeyValue:t}),elementAttributes:this._makeCellContentAttributes},headCellContent:{elementAttributes:()=>({className:Es.headCellContent}),content:this._makeHeadCellContent}}},this._render(),this._subscribeModel()}rowIdAtEvent(e){return function(e){if(void 0!==e.dataset.rowId)return e.dataset.rowId;let t=e.parentElement;for(;null!==t;){if(void 0!==t.dataset.rowId)return t.dataset.rowId;t=t.parentElement}}(e.target)}isRowInViewport(e){return this._visibleRows.has(e)}sortingColumn(){return this._sortingColumn}sortingMode(){return this._sortingModeSwitcher.value()}size(){return this._isMobile?0:1}highlightRowById(e){const t=this._rowElementById(e);void 0!==t&&(clearTimeout(this._highlightTimeoutIds.get(e)),t.classList.remove(Es.highlightedRow),t.classList.add(Es.highlightedRow),this._highlightTimeoutIds.set(e,setTimeout((()=>{
t.classList.remove(Es.highlightedRow)}),700)))}addFormatter(e){this._formatters.set(e.name,e)}setColumnAvailable(e,t){if(this._setColumnAvailableInFilter(e,t),t){const t=this._isMobile?".invisibleMobileColumns":".invisibleColumns";if(dt.getJSON(`${this._id}${t}`,[]).includes(e))return}this._setColumnVisibility(e,t)}setRowInactiveById(e,t){this._rowsDisplayOptions.get(e)?.isInactive!==t&&(this._setRowInactiveById(e,t),this._updateTableProps((0,Qt.updateRow)(this._model.data().get(e))))}setRowInactiveByFilter(e){this._model.data().forEach(((t,s)=>this._setRowInactiveById(s,e(t)))),this._updateTableProps((0,Qt.updateData)(this._model.rows()),!0)}setRowLinkedById(e,t){this._rowsDisplayOptions.get(e)?.isLinked!==t&&(this._setRowLinkedById(e,t),this._updateTableProps((0,Qt.updateRow)(this._model.data().get(e))))}setRowLinkedByFilter(e){this._model.data().forEach(((t,s)=>this._setRowLinkedById(s,e(t)))),this._updateTableProps((0,Qt.updateData)(this._model.rows()),!0)}destroy(){window.removeEventListener("resize",this._resizeHandler),cancelAnimationFrame(this._animationFrameId),this._unsubscribeModel(),this._containerVisibilityObserver?.disconnect(),o.unmountComponentAtNode(this._container)}async exportData(){const e=[...this._columnsVisibilityInfo.values()];return Promise.all(this._model.rows().map((async t=>{const s={};for(const{isVisible:i,label:n,id:o}of e){if(!i||"settings"===o)continue;const e=await this._makeTextContent({columnId:o,row:t}),r=e=>{s[n+(e.title?` (${e.title})`:"")]=e.value};Array.isArray(e)?e.forEach(r):e instanceof Object?r(e):s[n]=e||""}return s})))}_checkIsPaginationShown(){return void 0!==this._pageSize&&this._model.rows().length>this._pageSize}_setRowInactiveById(e,t){this._updateRowDisplayOptions(e,{isInactive:t})}_setRowLinkedById(e,t){this._updateRowDisplayOptions(e,{isLinked:t})}_rowElementById(e){return this._rowsElements.get(e)??void 0}_getEmptyStateColspan(){return this._noSettingsColumn&&0!==this._getAvailableColumnsFilterItems().length?this._visibleColumns.has("settings")?this._visibleColumns.size:this._visibleColumns.size+1:this._visibleColumns.size}_makeColumns(){const e=new Map;for(const[t,s]of this._columnsMetainfo){const{isVisible:i,isVisibleOnMobile:n,forceInvisible:o}=(0,l.ensureDefined)(this._columnsVisibilityInfo.get(t),Js(t)),r={key:t,title:s.label,visible:(this._isMobile?n:i)&&!o,style:{minWidth:this._isMobile?void 0:80,maxWidth:this._isMobile?void 0:300}},a=this._sortingModeSwitcher.value();t===this._sortingColumn&&null!==a&&(r.sortDirection=Ks[a]),e.set(r.key,r)}const t=this._getSavedColumnsOrder();return this._columnsMetainfo.has("settings")||(this._noSettingsColumn=!0,e.set("settings",{key:"settings",title:"",visible:!0}),this._columnsMetainfo.set("settings",{label:"",id:"settings",alignment:"right",dataFields:[],formatter:"empty",notSortable:!0,showOnMobile:!1})),this._isMobile||void 0===t?[...e.values()]:this._reorderColumns(t,e)}_resetTableScrollState(){this._isScrolled=!1,this._tableWrapperAttributes=this._makeTableWrapperAttributes()}_render(e=!1){
if(!e&&!this._isVisible)return;let t=[];this._isMobile&&0!==this._tableProps.data?.length&&(t=this._getAvailableColumnsFilterItems()),o.render(n.createElement(qs,{tableProps:this._tableProps,updateTableProps:this._updateTableProps,columnsFilterItems:t,columnsFilterProps:this._columnsFilterProps,tableWrapperAttributes:this._tableWrapperAttributes,isMobile:this._isMobile,moveCellFocus:this._moveCellFocus}),this._container)}_updateRowDisplayOptions(e,t){const s=this._rowsDisplayOptions.get(e);this._rowsDisplayOptions.set(e,{...s,...t})}_handleSortingUpdate(e){e===this._sortingColumn?this._sortingModeSwitcher.next():(this._sortingColumn=e,this._sortingModeSwitcher.reset()),this._updateSortingColumnSettings(),this.onSortingChange.fire({column:e,mode:this._sortingModeSwitcher.value()})}_updateSortingColumnSettings(){const e=this._sortingModeSwitcher.value();if(null===e)return dt.remove(this._sortingColumnKey),void dt.remove(this._sortingModeKey);dt.setValue(this._sortingColumnKey,this._sortingColumn),dt.setValue(this._sortingModeKey,e)}_getSavedSortingParameters(){const e=dt.getValue(this._sortingColumnKey);if(void 0===e)return;return{columnId:e,mode:dt.getInt(this._sortingModeKey)??1}}_setColumnAvailableInFilter(e,t){t?this._hiddenFilterColumns.delete(e):this._hiddenFilterColumns.add(e)}_getCellContentCaches(e){let t=this._cellContentCaches.get(e);return void 0===t&&(t=new Map,this._cellContentCaches.set(e,t)),t}_makeColumnsVisibilityInfo(){const e=new Map,t=[...this._columnsMetainfo.values()].filter((e=>e.hideByDefault)).map((e=>e.id)),s=dt.getJSON(`${this._id}.invisibleColumns`,t),i=dt.getJSON(`${this._id}.invisibleMobileColumns`,t);return this._columnsMetainfo.forEach((t=>{const n=t.id===this._fixedTitleColumnId,o=s.includes(t.id)&&!n,r=i.includes(t.id)&&!n;(this._isMobile?r:o)?this._visibleColumns.delete(t.id):this._visibleColumns.add(t.id),e.set(t.id,{isVisible:!o,isVisibleOnMobile:!r,isAlwaysVisible:t.notHideable||n,id:t.id,label:t.label})})),e}_isFirstRow(e){return e===this._model.rows()[0]?.[this._idProperty]}_makeTableWrapperClassNames(){return a()(Es.tableWrapper,this._isScrolled&&!this._isMobile&&Es.isScrolled,!this._isScrollBouncingEnabled&&Es.noBouncingScroll)}_checkBottomIsVisible(e){const t=e.querySelector('[data-selector="table"]');if(null===t)return;const{bottom:s}=t.getBoundingClientRect(),i=window.innerHeight-s>=-100;this.onBottomVisibilityChange.fire(i)}_makeColumnsFilterProps(){const e=this._isCellFocused({columnKey:"settings",rowKeyValue:"head"})?0:-1;return{items:[...this._columnsVisibilityInfo.values()].filter((e=>"settings"!==e.id&&!e.isAlwaysVisible)).map((e=>({id:e.id,title:e.label,visible:(this._isMobile?e.isVisibleOnMobile:e.isVisible)&&!e.forceInvisible}))),onCheck:e=>this._toggleColumnVisibility(e),reference:e=>this._columnsFilterReference=e,overlapManagerWV:this._overlapManager,isSticky:this._isStickyMobileColumnsFilter,tabIndex:e}}_toggleColumnVisibility(e){const t=!this._visibleColumns.has(e);this._setColumnVisibility(e,t)
;const s=`${this._id}${this._isMobile?".invisibleMobileColumns":".invisibleColumns"}`,i=new Set(dt.getJSON(s,[]));t?i.delete(e):i.add(e),dt.setJSON(s,[...i])}_setColumnVisibility(e,t){t?this._visibleColumns.add(e):this._visibleColumns.delete(e);const s=this._columnsVisibilityInfo.get(e);void 0!==s&&(this._isMobile?this._columnsVisibilityInfo.set(e,{...s,isVisibleOnMobile:t&&!s.forceInvisible}):this._columnsVisibilityInfo.set(e,{...s,isVisible:t&&!s.forceInvisible}),this._columnsFilterProps=this._makeColumnsFilterProps()),this._updateTableProps({type:t?Zt.ActionType.ShowColumn:Zt.ActionType.HideColumn,columnKey:e},!0)}_getAvailableColumnsFilterItems(){return this._columnsFilterProps.items.filter((e=>!this._hiddenFilterColumns.has(e.id)))}_checkIsMobile(){return window.matchMedia(q.TradingLayoutBreakpoint.Mobile).matches}_subscribeModel(){this._model.onRowsChanged.subscribe(this,this._onRowsChanged)}_unsubscribeModel(){this._model.onRowsChanged.unsubscribe(this,this._onRowsChanged)}_reorderColumns(e,t){const s=new Map(t),i=s.get("settings");s.delete("settings");const n=[],o=void 0!==this._fixedTitleColumnId?s.get(this._fixedTitleColumnId):void 0;void 0!==o&&(n.push(o),s.delete(o.key));for(const t of e){const e=s.get(t);void 0!==e&&(n.push(e),s.delete(t))}return n.push(...s.values()),void 0!==i&&n.push(i),n}_getSavedColumnsOrder(){return this._getSettingsStorage()?.tableColumnsOrder(this._id)}_isCellFocused(e){return this._tableProps?.focused?.cell?.columnKey===e?.columnKey&&this._tableProps?.focused?.cell?.rowKeyValue===e?.rowKeyValue}}var ti=s(634506);class si extends E{constructor(e){const t=it(),s=[],i=[],n=[],o=[],r=1===e.tables.length,a=[];e.tables.forEach((l=>{const c=it({stretch:r}),u=it({stretch:r}),d=new at({options:l.options,priceFormatterGetter:l.priceFormatterFn,reverse:l.flags?.reverse,columns:l.columns}),h=new ei({id:l.id,model:d,container:u,columns:l.columns,idProperty:l.options.idProperty,className:l.options.className,stickyMobileColumnsFilter:!0,overlapManager:e.overlapManager,fixedColumns:l.flags?.fixedColumns,getSettingsStorage:e.getTableSettingsStorage,rowEventsHandlers:l.rowEventsHandlers,trackEvent:e.trackEvent,supportPagination:l.flags?.supportPagination,isScrollBouncingEnabled:!r,shouldResetScrollWhenHidden:r,cellFocusedHandler:()=>this._handleCellFocused(h),customEmptyStateGetter:e.customEmptyStateGetter});if(l.title){const e=function(e){const t=document.createElement("h3");return t.classList.add(ti.title,ti.hidden),t.textContent=e,t}(l.title);c.appendChild(e),o.push(e)}c.appendChild(u),t.appendChild(c);const p=new C({idProperty:l.options.idProperty,name:l.title||void 0,model:d,view:h,source:l.source,subscriptions:l.subscriptions,supportPagination:l.flags?.supportPagination});if(i.push(d),n.push(h),s.push(p),p.addFormatters(l.formatters.concat(Ye)),p.start(),e.displayCounterInTab){const e=new P(l.source,l.subscriptions.rowUpdateDelegate);a.push(e)}}));const l={id:e.id,name:e.title};super(t,l,s),this._tableCounters=[],this._tableViewModels=i,this._tableViews=n,this._titleElements=o,
e.displayCounterInTab&&(this._tableCounters=a,this._subscribeUpdates())}destroy(){this._unsubscribeUpdates(),this._tableViewModels.forEach((e=>e.destroy())),this._tableViews.forEach((e=>e.destroy())),super.destroy()}_onActiveChanged(e){super._onActiveChanged(e),e&&setTimeout((()=>{for(const e of this._titleElements)e.classList.remove(ti.hidden)}))}_handleCellFocused(e){this._tableViews.forEach((t=>{t!==e&&t.clearFocused()}))}_onCountChanged(e){this._setCount(e)}_subscribeUpdates(){this._tableCounters.forEach((e=>{e.start(),e.countChanged().subscribe(this,this._onCountChanged)}))}_unsubscribeUpdates(){this._tableCounters.forEach((e=>{e.stop(),e.countChanged().unsubscribe(this,this._onCountChanged)}))}}var ii,ni=s(588714),oi=s(798603),ri=s(610600),ai=s(552019);!function(e){e[e.Delay=0]="Delay",e[e.Informer=1]="Informer",e[e.Edit=2]="Edit",e[e.Close=3]="Close"}(ii||(ii={}));hi((function(e){return n.createElement(DelayedDataStatus,{...e,role:"button"})}));const li=hi((function(e){return n.createElement(ue,{...e})})),ci=hi((function(e){const{reference:t,closeFn:o,closeTitle:r,...a}=e;return n.createElement(ni.ClickableIconButton,{...a,ref:t,colorClassName:oi.button,title:r??i.t(null,{context:"position"},s(744074)),icon:ai,onClick:e=>{e.stopPropagation(),o()},"data-name":"close-settings-cell-button"})})),ui=hi((function(e){const{reference:t,editFn:o,editTitle:r,...l}=e;return n.createElement(ni.ClickableIconButton,{...l,ref:t,colorClassName:a()(oi.button,oi.editButton),title:r??i.t(null,void 0,s(223912)),icon:ri,onClick:e=>{e.stopPropagation(),o()},"data-name":"edit-settings-cell-button"})}));function di(e){const{closeFn:t,closeTitle:s,editFn:i,editTitle:o,message:r,symbol:a,showDelayButton:l,showCloseButton:c,showEditButton:u,cell:d}=e,h=void 0!==r,p=!1,[m,g]=(0,n.useState)(-1),[_,b]=(0,n.useState)(!1),f=(0,$.useIsMounted)(),v=(0,n.useRef)([]),{lastActiveButtonIndex:w,setLastActiveButtonIndex:C,moveCellFocus:y,focusedCell:S}=(0,n.useContext)(Ws);(0,n.useEffect)((()=>{if(-1!==m)return;const e=v.current.findIndex((e=>void 0!==e));-1!==e&&g(e)}),[p,h,u,c]),(0,n.useEffect)((()=>{null!==w&&w!==m&&void 0!==v.current[w]&&g(w)}),[w]);const E=S?.columnKey===d?.columnKey&&S?.rowKeyValue===d?.rowKeyValue,x=void 0!==t,F=void 0!==i,T=!x||_;function P(e){void 0!==v.current[e]&&(v.current[e]?.focus(),g(e),C(e))}const k=(0,n.useCallback)(((e,t,s)=>{v.current[t]=s&&null!==e?e:void 0}),[]);const I={isCellFocused:E,focusedButtonIndex:m,setFocusedButtonIndex:g,setLastActiveButtonIndex:C};return n.createElement("span",{className:oi.wrapper,onKeyDown:function(e){const t=v.current;switch((0,Gt.hashFromEvent)(e)){case 39:e.preventDefault();for(let e=m+1;e<t.length;e++)if(void 0!==t[e]){P(e);break}break;case 37:{e.preventDefault();let s=!1;for(let e=m-1;e>=0;e--)if(void 0!==t[e]){P(e),s=!0;break}s||void 0===d||y(d,"left");break}case 32:1===m&&e.preventDefault()}}},p,h&&n.createElement(li,{...I,...r,reference:e=>k(e,1,!0),buttonIndex:1}),(c||u)&&n.createElement("div",{className:oi.buttons},u&&n.createElement(ui,{...I,reference:e=>k(e,2,F),
disabled:!F||_,editFn:F?async function(){try{b(!0),await(i?.())}finally{f.current&&(b(!1),P(m))}}:()=>{},editTitle:o,buttonIndex:2}),c&&n.createElement(ci,{...I,reference:e=>k(e,3,x),"aria-disabled":T,disabled:T,closeFn:T?()=>{}:async function(){try{b(!0),await(t?.())}finally{f.current&&(b(!1),P(m))}},closeTitle:s,buttonIndex:3})))}function hi(e){return t=>{const{buttonIndex:s,isCellFocused:i,focusedButtonIndex:o,setFocusedButtonIndex:r,setLastActiveButtonIndex:a,...l}=t,c=i&&o===s?0:-1;return n.createElement(e,{...l,tabIndex:c,onFocus:function(){a(s)},[Xt]:`${o===s}`})}}const pi={2:"orderstatus-filled",1:"orderstatus-cancelled",6:"orderstatus-working",3:"orderstatus-inactive",4:"orderstatus-placing",5:"orderstatus-rejected"};function mi(e){return pi[e]}class gi{constructor(e,t,s,i){this._calculateCounts=async e=>{if(e?.aborted)return;const t=await this._source();if(e?.aborted)return;const s=new Set,i={};for(const{id:e}of this._ordersFilterTabs)i[e]=0;for(const e of t){if(s.has(e.id))continue;s.add(e.id),i["orderstatustatus-all"]=(0,l.ensureDefined)(i["orderstatustatus-all"])+1;const t=mi(e.status);void 0!==i[t]&&(i[t]=(0,l.ensureDefined)(i[t])+1)}this._countChanged.fire(i);for(const{id:e,count:t}of this._ordersFilterTabs)t.setValue(i[e])},this._source=e,this._orderUpdateDelegate=t,this._fullUpdateDelegate=s,this._ordersFilterTabs=i,this._abortController=new AbortController,this._countChanged=new T.Delegate,this._calculateCounts=(0,F.respectLatest)(this._calculateCounts),this._calculateCountsDebounced=(0,x.default)((()=>this._calculateCounts(this._abortController.signal)),100)}countChanged(){return this._countChanged}start(){this._abortController=new AbortController,this._orderUpdateDelegate.subscribe(this,this._calculateCountsDebounced),this._fullUpdateDelegate.subscribe(this,this._calculateCountsDebounced),this._calculateCounts(this._abortController.signal)}stop(){this._abortController.abort(),this._ordersFilterTabs.forEach((({count:e})=>e.setValue(0))),this._orderUpdateDelegate.unsubscribe(this,this._calculateCountsDebounced),this._fullUpdateDelegate.unsubscribe(this,this._calculateCountsDebounced)}}class _i{constructor(e,t,s,i){this.filterFullUpdateDelegate=new T.Delegate,this.filterObjectUpdateDelegate=new T.Delegate,this.filterObjectDeleteDelegate=new T.Delegate,this._filteredObjects=[],this._requestsCount=0,this._started=!1,this._objectsRequest=null,this._source=e,this._objectUpdateDelegate=t,this._objectDeleteDelegate=s,this._fullUpdateDelegate=i}start(){this._requestsCount++;const e=this._source,t=this._objectsRequest||Promise.resolve([]);this._objectsRequest=t.then((()=>e())).then((e=>{const t=e.filter((e=>this._satisfy(e)));return this._requestsCount--,this._requestsCount||(this.stop(),this._filteredObjects=t,this._objectsRequest=null,this._objectUpdateDelegate.subscribe(this,this._onObjectUpdated),this._objectDeleteDelegate&&this._objectDeleteDelegate.subscribe(this,this._onObjectDeleted),this._fullUpdateDelegate.subscribe(this,this._onFullUpdate),this._started=!0),t.slice(0)}))}stop(){
this._objectUpdateDelegate.unsubscribe(this,this._onObjectUpdated),this._fullUpdateDelegate.unsubscribe(this,this._onFullUpdate),this._objectDeleteDelegate&&this._objectDeleteDelegate.unsubscribe(this,this._onObjectDeleted),this._filteredObjects=[],this._started=!1}isStarted(){return this._started}filterSource(){return this._objectsRequest?this._objectsRequest:Promise.resolve(this._filteredObjects.slice(0))}_satisfy(e){throw new Error("should be implemented")}_onFullUpdate(){this.stop(),this.start(),this.filterFullUpdateDelegate.fire()}_onObjectDeleted(e){const t=this._filteredObjects.find((t=>t.id===e));t&&this.filterObjectDeleteDelegate.fire(t.id)}_onObjectUpdated(e){const t=this._filteredObjects.find((t=>t.id===e.id)),s=t?this._filteredObjects.indexOf(t):-1;this._satisfy(e)?(t?this._filteredObjects[s]=e:this._filteredObjects.push(e),this.filterObjectUpdateDelegate.fire(e)):t&&(this.filterObjectDeleteDelegate.fire(t.id),this._filteredObjects.splice(s,1))}}class bi extends _i{constructor(e,t,s,i){super(e,t,s,i),this._filterStatus=null}setFilterStatus(e){this._filterStatus=e,this.isStarted()&&(this.stop(),this.start())}filterStatus(){return this._filterStatus}_satisfy(e){return!this._filterStatus||e.status===this._filterStatus}}class fi extends _i{constructor(e,t,s,i,n){super(e,t,s,i),this._filter=n}_satisfy(e){return this._filter(e)}}class vi{constructor(e,t,s){this._orders=[],this._source=e,this._rowUpdateDelegate=t,this._fullUpdateDelegate=s,this._orders=[],this._statusChanged=new T.Delegate}statusChanged(){return this._statusChanged}start(){this._source().then((e=>{this._orders=e.map((e=>Object.assign({},e))),this._rowUpdateDelegate.subscribe(this,this._onRowUpdated),this._fullUpdateDelegate.subscribe(this,this._onFullUpdate)}))}stop(){this._fullUpdateDelegate.unsubscribe(this,this._onFullUpdate),this._rowUpdateDelegate.unsubscribe(this,this._onRowUpdated),this._orders=[]}_onFullUpdate(){this.stop(),this.start()}_onRowUpdated(e){const t=this._orders.find((({id:t})=>t===e.id));t?.status!==e.status&&(void 0!==t?t.status=e.status:this._orders.push(Object.assign({},e)),this._statusChanged.fire(e))}}class wi extends C{constructor(e){super(e),this._onLinkingBound=this._onLinking.bind(this),c.linking.proSymbol.subscribe(this._onLinkingBound)}destroy(){c.linking.proSymbol.unsubscribe(this._onLinkingBound),super.destroy()}_update(e){if(!super._update(e))return!1;const t=c.linking.proSymbol.value();return this.setRowLinkedById(e.id,t===e.symbol),!0}_onCreated(){this.setRowLinkedByFilter((e=>e.symbol===c.linking.proSymbol.value()))}_onLinking(e){this.setRowLinkedByFilter((t=>t.symbol===e))}}class Ci extends wi{constructor(e){super(e),this._title=e.title,this._getFilterStatus=e.filterStatusGetter,this._isAlwaysActive=e.isAlwaysActive}fullUpdate(){return this._fullUpdate()}getDataExporter(){const e=super.getDataExporter(),t=this._getFilterStatus(),n=null!==t?(0,p.orderStatusToText)(t):i.t(null,void 0,s(580066));return e.name=`${this._title} ${n}`,e}_update(e){
return!!super._update(e)&&(this.setRowInactiveById(e.id,!this._filterByStatus(e.status)),!0)}_onCreated(){super._onCreated(),this.setRowInactiveByFilter((e=>!this._filterByStatus(e.status)))}_filterByStatus(e){return this._isAlwaysActive||null!==this._getFilterStatus()||(0,p.isOrderActive)(e)}}const yi=["formatPrice","formatPriceForexSup"],Si="orderSettings",Ei="Orders Page";function xi(e,t){return{id:e,label:t,count:new y.WatchedValue(0)}}class Fi extends E{constructor(e){const t=e.formatters||[],o=new fi(e.source,e.subscriptions.rowUpdateDelegate,null,e.subscriptions.fullUpdateDelegate,e.filter),r=function(e){const t=[xi("orderstatustatus-all",i.t(null,void 0,s(580066)))],n=e.map((e=>xi(mi(e),(0,W.capitalizeFirstLetter)((0,p.orderStatusToText)(e)))));return t.concat(n)}(e.possibleOrderStatuses),a=new gi(o.filterSource.bind(o),o.filterObjectUpdateDelegate,o.filterFullUpdateDelegate,r),l=new bi(o.filterSource.bind(o),o.filterObjectUpdateDelegate,o.filterObjectDeleteDelegate,o.filterFullUpdateDelegate),c=e.subscriptions.fullUpdateDelegate;e.source=l.filterSource.bind(l),e.subscriptions.rowUpdateDelegate=l.filterObjectUpdateDelegate,e.subscriptions.rowDeleteDelegate=l.filterObjectDeleteDelegate,e.subscriptions.fullUpdateDelegate=l.filterFullUpdateDelegate;const u=it(),d="id",h={group:e=>+(0,p.isOrderActive)(e.status),idProperty:d,defaultSortingParameters:e.initialSorting},m=e.columns.map((e=>yi.includes(e.formatter)?{...e,showZeroValues:!1}:e)),g=[...m,{label:"",id:"settings",alignment:"right",dataFields:[],formatter:Si,notSortable:!0,showOnMobile:!1}],_=new at({columns:g,priceFormatterGetter:e.priceFormatterFn,options:h}),b=new ei({id:e.tableId,title:e.title,model:_,className:"orders",container:u,columns:g,idProperty:d,overlapManager:e.overlapManager,getSettingsStorage:e.getTableSettingsStorage,rowEventsHandlers:e.tableRowEventsHandlers,trackEvent:e.trackEvent,fixedTitleColumnId:"symbol",pageSize:void 0===e.overlapManager?100:20,customEmptyStateGetter:e.customEmptyStateGetter}),v={id:e.id,name:e.title},w=new Ci({idProperty:d,title:e.title,model:_,view:b,source:e.source,subscriptions:e.subscriptions,filterStatusGetter:()=>this._ordersFilter.filterStatus(),isAlwaysActive:e.isAlwaysActive});super(u,v,[w]),this._tableViewModel=_,this._tableView=b,this._tableController=w,this._globalFullUpdateDelegate=c,this._statusWatcher=new vi(o.filterSource.bind(o),o.filterObjectUpdateDelegate,o.filterFullUpdateDelegate),this._orderPreFilter=o,this._ordersFilter=l,this._ordersFilterCountsUpdater=a,this._possibleOrderStatuses=e.possibleOrderStatuses,this._columns=m,this._pendingOrdersByStatuses={},this._configFlags=e.configFlags,this._trackEvent=e.trackEvent,this._closeFn=t=>(e.trackEvent(Ei,"Cancel Order"),e.cancelFn(t)),this._editFn=(t,s,i,n)=>(e.trackEvent(Ei,"Edit Order"),e.modifyFn(t,s,i,n));const C={name:Si,formatElement:({values:[t]})=>{const o=""!==t.symbol,r=this._isPlacingOrderCancellingDisabled(t.status),a=(0,p.isOrderActive)(t.status),l=!o||!a,c=l&&r?void 0:()=>this._closeFn(t.id),u=l||!(0,
p.isModifyOrderSupported)(t,this._configFlags)||t.flags?.isReadOnly?void 0:()=>this._editFn(t),d=o?t.message:ne(t.message);return n.createElement(di,{closeFn:c,closeTitle:i.t(null,void 0,s(904543)),editFn:u,editTitle:(0,f.appendEllipsis)(i.t(null,void 0,s(567710))),message:d,symbol:t.symbol,showDelayButton:o&&t.isDelayed,showCloseButton:!e.isAlwaysActive&&(a||!r),showEditButton:!e.isAlwaysActive&&(0,p.isBrokerSupportOrderModification)(this._configFlags)&&a})},formatText:()=>""};w.addFormatters([...Ye,C,...t]),this._filterTabs=r,this._subscribeUpdates()}destroy(){this._unsubscribeUpdates(),this._tableViewModel.destroy(),this._tableView.destroy(),super.destroy()}async contextItems(e){const t=this._tableController.rowIdAtEvent(e);if(void 0===t)return[];const n=this._tableController.rowById(t);if(void 0===n||""===n.symbol)return[];const o=[];return(0,p.isModifyOrderSupported)(n,this._configFlags)&&(0,p.isOrderActive)(n.status)&&o.push({text:(0,f.appendEllipsis)(i.t(null,void 0,s(567710))),action:()=>this._editFn(n)}),!(0,p.isOrderActive)(n.status)&&this._isPlacingOrderCancellingDisabled(n.status)||o.push({text:i.t(null,void 0,s(895931)),action:()=>this._closeFn(t)}),o}contextRow(e){return this._tableController.rowAtEvent(e)}activateFilterTab(e){if(this._activeFilterTabId===e)return;const t=void 0===this._activeFilterTabId;super.activateFilterTab(e);const s=function(e){return Ti[e]}(e);this._ordersFilter.setFilterStatus(s),this._columns.forEach((e=>{void 0!==e.supportedStatusFilters&&this._tableController.setColumnAvailable(e.id,e.supportedStatusFilters.includes(s??0))})),t||(this._trackEvent(Ei,"Order status filter",null!==s?(0,p.orderStatusToText)(s):void 0),this._tableController.fullUpdate().then((()=>{if(null===s)return void(this._pendingOrdersByStatuses={});const e=this._pendingOrdersByStatuses[s];void 0!==e&&(e.forEach((e=>this._tableController.highlightRowById(e))),e.clear())})))}_subscribeUpdates(){this._tableController.start(),this._orderPreFilter.start(),this._ordersFilter.start(),this._statusWatcher.start(),this._statusWatcher.statusChanged().subscribe(this,this._onStatusChange),this._ordersFilterCountsUpdater.start(),this._ordersFilterCountsUpdater.countChanged().subscribe(this,this._onCountChanged),this._globalFullUpdateDelegate.subscribe(this,this._onGlobalFullUpdate)}_unsubscribeUpdates(){this._tableController.stop(),this._orderPreFilter.stop(),this._ordersFilter.stop(),this._statusWatcher.stop(),this._statusWatcher.statusChanged().unsubscribe(this,this._onStatusChange),this._ordersFilterCountsUpdater.stop(),this._ordersFilterCountsUpdater.countChanged().unsubscribe(this,this._onCountChanged),this._globalFullUpdateDelegate.unsubscribe(this,this._onGlobalFullUpdate)}_onGlobalFullUpdate(){this._pendingOrdersByStatuses={}}_onCountChanged(e){const t=(e[mi(6)]??0)+(e[mi(3)]??0);this._setCount(t)}_onStatusChange(e){null!==this._ordersFilter.filterStatus()&&4!==e.status&&(this._possibleOrderStatuses.forEach((t=>{this._pendingOrdersByStatuses[t]?.delete(e.id)})),
this._pendingOrdersByStatuses[e.status]||(this._pendingOrdersByStatuses[e.status]=new Set),this._pendingOrdersByStatuses[e.status]?.add(e.id),setTimeout((()=>{this._ordersFilter.filterStatus()===e.status&&this._tableController.isRowInViewport(e.id)&&this._tableController.highlightRowById(e.id)}),0))}_isPlacingOrderCancellingDisabled(e){return!this._configFlags.supportPlacingOrderCancelling||4!==e}}const Ti={"orderstatus-filled":2,"orderstatus-cancelled":1,"orderstatus-working":6,"orderstatus-inactive":3,"orderstatus-placing":4,"orderstatus-rejected":5,"orderstatustatus-all":null};var Pi,ki,Ii=s(92065);class Di{constructor(e,t,s){this._calculateCounts=async e=>{if(e?.aborted)return;const t=await this._source();if(e?.aborted)return;const s=t.filter(v).length;s!==this._count&&(this._count=s,this._countChanged.fire(s))},this._source=e,this._rowUpdateDelegate=t,this._fullUpdateDelegate=s,this._countChanged=new T.Delegate,this._abortController=new AbortController,this._calculateCounts=(0,F.respectLatest)(this._calculateCounts),this._calculateCountsDebounced=(0,x.default)((()=>this._calculateCounts(this._abortController.signal)),100)}countChanged(){return this._countChanged}start(){this._abortController=new AbortController,this._rowUpdateDelegate.subscribe(this,this._calculateCountsDebounced),this._fullUpdateDelegate.subscribe(this,this._calculateCountsDebounced),this._calculateCounts(this._abortController.signal)}stop(){this._abortController.abort(),this._count=void 0,this._rowUpdateDelegate.unsubscribe(this,this._calculateCountsDebounced),this._fullUpdateDelegate.unsubscribe(this,this._calculateCountsDebounced)}}!function(e){e[e.IndividualPositions=0]="IndividualPositions",e[e.NetPositions=1]="NetPositions"}(Pi||(Pi={})),function(e){e.IndividualPositions="individual-positions",e.NetPositions="net-positions"}(ki||(ki={}));const Ri="Trading.PositionsTable.Filter",Mi=["formatPrice","formatPriceForexSup"],Ai=i.t(null,void 0,s(563654)),Ui=i.t(null,void 0,s(394948)),Oi=i.t(null,void 0,s(568355)),Ni=i.t(null,void 0,s(685581)),Bi="positionSettings",Vi="individualPositionSettings",Li={1:"net-positions",0:"individual-positions"};function Wi(e){const{id:t,name:s,content:i,source:n,subscriptions:o,columns:r,priceFormatterFn:a,rowEventsHandlers:l,overlapManager:c,getTableSettingsStorage:u,trackEvent:d,customEmptyStateGetter:h}=e,p="id",m=new at({priceFormatterGetter:a,columns:r,options:{idProperty:p}}),g=new ei({id:t,model:m,title:s,className:"positions",container:i,columns:r,idProperty:p,getSettingsStorage:u,overlapManager:c,fixedTitleColumnId:"symbol",rowEventsHandlers:l,trackEvent:d,customEmptyStateGetter:()=>h?.()??Ni,pageSize:void 0===c?100:20});return{model:m,view:g,controller:new Hi({idProperty:p,name:s,model:m,view:g,source:n,subscriptions:o})}}class Hi extends wi{_update(e){return v(e)?super._update(e):(this._deleteRow(e.id),!0)}}class zi extends E{constructor(e){const t=function(){const e=document.createElement("div");return e.classList.add(Ii.pageContainer),e}(),o={id:"positions",name:Ai
},r=it(),a=e.positions.columns.map((e=>Mi.includes(e.formatter)?{...e,showZeroValues:!1}:e));a.push({label:"",id:"settings",alignment:"right",dataFields:["id","message","symbol","isDelayed"],formatter:Bi,notSortable:!0,showOnMobile:!1});const c=Wi({id:e.brokerId+".positions",name:e.individualPositions?Ui:Ai,content:r,source:e.positions.source,subscriptions:Object.assign({},e.positions.subscriptions,{fullUpdateDelegate:e.fullUpdateDelegate}),columns:a,priceFormatterFn:e.priceFormatterFn,overlapManager:e.overlapManager,getTableSettingsStorage:e.getTableSettingsStorage,rowEventsHandlers:e.tableRowEventsHandlers,trackEvent:e.trackEvent,customEmptyStateGetter:e.customEmptyStateGetter});t.appendChild(r);const u=[c.controller];let d,h=null;if(e.individualPositions){const s=e.individualPositions.columns.map((e=>Mi.includes(e.formatter)?{...e,showZeroValues:!1}:e));s.push({label:"",id:"settings",alignment:"right",dataFields:["id","message","canBeClosed","symbol","isDelayed"],formatter:Vi,notSortable:!0,showOnMobile:!1}),h=it(),d=Wi({id:e.brokerId+".individualPositions",name:Oi,content:h,source:e.individualPositions.source,subscriptions:Object.assign({},e.individualPositions.subscriptions,{fullUpdateDelegate:e.fullUpdateDelegate}),columns:s,priceFormatterFn:e.priceFormatterFn,overlapManager:e.overlapManager,getTableSettingsStorage:e.getTableSettingsStorage,rowEventsHandlers:e.tableRowEventsHandlers,trackEvent:e.trackEvent,customEmptyStateGetter:e.customEmptyStateGetter}),t.appendChild(h),u.push(d.controller)}super(t,o,u),this._positionsTableContainer=r,this._individualPositionsTableContainer=h,this._positionsTableController=c.controller,this._positionsTableViewModel=c.model,this._positionsTableView=c.view,this._individualPositionsTableController=d?.controller,this._individualPositionsTableViewModel=d?.model,this._individualPositionsTableView=d?.view,null!==e.individualPositions&&(this._filterTabs=[],this._filterTabs[0]={id:"individual-positions",label:Oi,count:new y.WatchedValue(0)},this._filterTabs[1]={id:"net-positions",label:Ui,count:new y.WatchedValue(0)});const m=e.formatters||[];this._fullUpdateDelegate=e.fullUpdateDelegate,this._posSubscriptions=e.positions.subscriptions,this._checkSupportIndividualPositions=e.checkSupportIndividualPositions,this._checkPositionReverseSupport=e.checkPositionReverseSupport,this._trackEvent=e.trackEvent,this._storeFunctions(e);const g={name:Bi,formatElement:({values:[t,o,r,a]})=>{const l=""===r,c=l||null===this._closePositionFn?void 0:this._closePositionFn.bind(null,t),u=l||null===this._editPositionFn||!1===(0,p.isModifyPositionBracketsSupported)(e.configFlags)?void 0:this._editPositionFn.bind(null,t),d=l?ne(o):o;return n.createElement(di,{closeFn:c,closeTitle:i.t(null,{context:"position"},s(744074)),editFn:u,editTitle:(0,f.appendEllipsis)(i.t(null,void 0,s(324927))),message:d,symbol:r,showDelayButton:!l&&a,showCloseButton:null!==this._closePositionFn,showEditButton:null!==this._editPositionFn})},formatText:()=>""};if(this._positionsTableController.addFormatters([g,...Ye,...m]),
e.individualPositions){const t={name:Vi,formatElement:({values:[e,t,o,r,a]})=>{const l=""===r,c=l||null===this._closeIndividualPositionFn||!o?void 0:this._closeIndividualPositionFn.bind(null,e),u=l||null===this._editIndividualPositionFn?void 0:this._editIndividualPositionFn.bind(null,e);return n.createElement(di,{closeFn:c,closeTitle:i.t(null,{context:"position"},s(744074)),editFn:u,editTitle:(0,f.appendEllipsis)(i.t(null,void 0,s(324927))),message:t,symbol:r,showDelayButton:!l&&a,showEditButton:null!==this._editIndividualPositionFn,showCloseButton:null!==this._closeIndividualPositionFn})},formatText:()=>""};(0,l.ensure)(this._individualPositionsTableController).addFormatters([t,...Ye,...m]),this._individualPositionsFilterCounter=new Di(e.individualPositions.source,e.individualPositions.subscriptions.countUpdateDelegate,this._fullUpdateDelegate)}else this._individualPositionsFilterCounter=null;this._positionsFilterCounter=new Di(e.positions.source,this._posSubscriptions.countUpdateDelegate,this._fullUpdateDelegate),this._subscribeUpdates();const _=dt.getInt(Ri,0);this._activeFilterTabId=this._checkSupportIndividualPositions()?Li[_]:"net-positions",this._selectPage(this._activeFilterTabId)}async contextItems(e){const t=this._activeTableController(),n=t.rowIdAtEvent(e);if(void 0===n)return[];const o=(0,l.ensureDefined)(t.rowById(n));if(""===o.symbol)return[];const r=[];if("individual-positions"===this._activeFilterTabId)return this._editIndividualPositionFn&&r.push({text:(0,f.appendEllipsis)(i.t(null,void 0,s(324927))),action:this._editIndividualPositionFn.bind(null,n)}),this._closeIndividualPositionFn&&o.canBeClosed&&r.push({text:i.t(null,void 0,s(759783)),action:this._closeIndividualPositionFn.bind(null,n)}),r;this._editPositionFn&&r.push({text:(0,f.appendEllipsis)(i.t(null,void 0,s(324927))),action:this._editPositionFn.bind(null,n)}),this._closePositionFn&&r.push({text:i.t(null,void 0,s(759783)),action:this._closePositionFn.bind(null,n)});const a=await this._checkPositionReverseSupport(o.symbol);return this._reversePositionFn&&a&&r.push({text:i.t(null,void 0,s(898818)),action:this._reversePositionFn.bind(null,n)}),r}contextRow(e){return this._activeTableController().rowAtEvent(e)}destroy(){this._unsubscribeUpdates(),this._positionsTableViewModel.destroy(),this._positionsTableView.destroy(),this._individualPositionsTableViewModel?.destroy(),this._individualPositionsTableView?.destroy(),super.destroy()}activateFilterTab(e){super.activateFilterTab(e),this._selectPage(e)}_onActiveChanged(e){e?this._activeTableController().setActive(!0):(this._positionsTableController.setActive(!1),this._individualPositionsTableController&&this._individualPositionsTableController.setActive(!1))}_onPositionsCountChanged(e){this._setCount(e),this._filterTabs[1]?.count.setValue(e)}_onIndividualPositionsCountChanged(e){this._filterTabs[0]?.count.setValue(e)}_activeTableController(){return this._checkSupportIndividualPositions()&&"individual-positions"===this._activeFilterTabId?(0,
l.ensure)(this._individualPositionsTableController):this._positionsTableController}_subscribeUpdates(){this._positionsFilterCounter.start(),this._positionsFilterCounter.countChanged().subscribe(this,this._onPositionsCountChanged),this._individualPositionsFilterCounter&&(this._individualPositionsFilterCounter.start(),this._individualPositionsFilterCounter.countChanged().subscribe(this,this._onIndividualPositionsCountChanged)),this._fullUpdateDelegate.subscribe(this,this._stopIndividualPositionsControllerIfNeeded)}_unsubscribeUpdates(){this._positionsFilterCounter.stop(),this._positionsFilterCounter.countChanged().unsubscribe(this,this._onPositionsCountChanged),this._individualPositionsFilterCounter&&(this._individualPositionsFilterCounter.stop(),this._individualPositionsFilterCounter.countChanged().unsubscribe(this,this._onIndividualPositionsCountChanged)),this._fullUpdateDelegate.unsubscribe(this,this._stopIndividualPositionsControllerIfNeeded)}_stopIndividualPositionsControllerIfNeeded(){this.isActive()&&this._checkSupportIndividualPositions()||this._individualPositionsTableController?.stop()}_selectPage(e){const t="net-positions"===e;t?this._positionsTableController.start():this._individualPositionsTableController?.start(),this._positionsTableContainer.classList.toggle("js-hidden",!t),this._individualPositionsTableContainer?.classList.toggle("js-hidden",t),this._positionsTableController.setActive(t),this._individualPositionsTableController?.setActive(!t),dt.setValue(Ri,t?1:0)}_storeFunctions(e){const t="Positions Page",s=e.positions.closeFn;this._closePositionFn=s?e=>(this._trackEvent(t,"Close Position"),s(e)):null;const i=e.positions.editFn;this._editPositionFn=i?e=>(this._trackEvent(t,"Edit Position"),i(e)):null;const n=e.positions.reverseFn;this._reversePositionFn=n?e=>(this._trackEvent(t,"Reverse Position"),n(e)):null;const o=e.individualPositions;if(o){const e=o.closeFn;this._closeIndividualPositionFn=e?s=>(this._trackEvent(t,"Close Individual position"),e(s)):null;const s=o.editFn;this._editIndividualPositionFn=s?e=>(this._trackEvent(t,"Edit Individual position"),s(e)):null}}}var qi=s(661851),Ki=s(842865),Gi=s(612658);function ji(e){const{wValue:t,formatter:s,text:i,informerMessage:o}=e,r=(0,ls.useWatchedValueReadonly)({watchedValue:t}),a=(0,n.useMemo)((()=>{const e=et(s??"fixed");return e.isPriceFormatterNeeded?Xe:e}),[s]),l=(0,n.useMemo)((()=>function(e,t){const s=(e.formatElement??e.formatText)({values:Array.isArray(t)?t:[t]});return"string"!=typeof s?s:s.replace(/&nbsp;/g," ")}(a,r)),[a,r]);return void 0===l?n.createElement(n.Fragment,null):n.createElement("div",{className:Gi.accountSummaryField},n.createElement("div",{className:Gi.titleContainer},n.createElement("span",{className:Gi.title},i),o&&n.createElement(Ki.TradingInformer,{informerMessage:o})),n.createElement("div",{className:Gi.value},l))}var $i=s(234682);function Qi(e){const{summaryFields:t,displayMode:s}=e;return 0===t.length?n.createElement(n.Fragment,null):n.createElement("div",{className:r(0===s&&$i.addMargin,$i.accountSummaryRow)
},t.map((e=>n.createElement(ji,{...e,key:e.text}))))}var Zi=s(331632),Ji=s(440782);function Yi(e){const{brokerDropdownProps:t,accountDropdownProps:s,commonDropdownProps:i,summaryFieldsVisibilityManager:o,summaryFields:a,displayMode:l,isBetaBroker:c}=e,u=(0,qi.useObservable)(o.fieldsVisibilityInfo$,o.fieldsVisibilityInfo()),d=a.flatMap((e=>u.get(e.text)?.visible?e:[])),h=void 0!==s&&void 0!==i,p=0!==d.length;return h||p?n.createElement("div",{className:r(Ji.headerWrapper,!h&&Ji.withoutDropdowns)},h&&n.createElement("div",{className:Ji.brokerBlock},n.createElement(Zi.AccountManagerHeaderDropdowns,{brokerDropdownProps:t,accountDropdownProps:s,commonDropdownProps:i}),!1),p&&n.createElement(Qi,{summaryFields:d,displayMode:l})):n.createElement(n.Fragment,null)}var Xi=s(502395),en=s(171812);function tn(e){const{element:t}=e;return n.createElement("div",{ref:e=>{null!==e&&(e.contains(t)||(null!==e.firstChild&&e.removeChild(e.firstChild),e.append(t)))}})}var sn=s(414823),nn=s(488831),on=s(266031);const rn=on.tabs;function an(e){const{id:t,label:s,count:i,isActive:o}=e,r=(0,ls.useWatchedValueReadonly)({watchedValue:i}),l=0!==r&&void 0!==r?` ${r}`:"";return n.createElement("span",{"data-account-manager-tab-id":t},s,n.createElement("span",{className:a()(!o&&on.count)},l))}function ln(e){const{pages:t,onActivate:s,defaultActiveTabId:i}=e,[o,r]=(0,n.useState)(i);return(0,n.useEffect)((()=>{s({id:o})}),[o,s]),n.createElement(nn.UnderlineButtonTabs,{id:(0,sn.createDomId)("account-manager-tabs"),className:rn,overflowBehaviour:"scroll",size:"xsmall",isActive:({id:e})=>e===o,items:t.map((e=>function(e,t){const s=e.id();return{id:s,label:n.createElement(an,{id:s,label:e.name(),count:e.count(),isActive:s===t})}}(e,o))),onActivate:({id:e})=>r(e)})}var cn,un=s(540801),dn=s(865679),hn=s(234539);!function(e){e.XSmall="xsmall",e.Small="small",e.Medium="medium",e.XLarge="xlarge"}(cn||(cn={}));const pn=(0,n.createContext)("small");var mn=s(737402),gn=s(756160),_n=s(601198),bn=s(661067);function fn({startSlot:e,endSlot:t,children:s,className:i,"aria-hidden":o,isVertical:r,endUpperSlot:l,iconOnlyOnAdaptive:c,overflowAdaptive:u="media-mf-phone-landscape",size:d}){const h=!!u&&!(0,mn.useSafeMatchMedia)(ht[u]),p=e&&n.createElement("span",{className:a()(bn.startSlotWrap,h&&bn.startSlotWrapIconOnly)},e),m=s&&!(c&&r&&h)&&n.createElement("span",{className:a()(bn.content,r&&bn.verticalContent)},s),g=(0,n.useMemo)((()=>{if(c&&r&&h&&n.isValidElement(t)){const e=t.props?.count;return e?n.createElement("span",{className:bn.endUpperSlot},(0,gn.getTabCounter)({count:e,size:d})):null}return n.createElement(n.Fragment,null,t&&n.createElement("span",{className:bn.endSlotWrap},t),l&&n.createElement("span",{className:bn.endUpperSlot},l))}),[c,r,h,t,l,d]);return n.createElement("span",{"aria-hidden":o,className:a()(i,"apply-overflow-tooltip","apply-overflow-tooltip--allow-text","apply-overflow-tooltip--check-children"),"data-overflow-tooltip-text":(0,_n.getTextForTooltip)(s)},p,m,g)}function vn(e){const{overflowBehaviour:t}=e
;return a()(bn.scrollWrap,"scroll"===t&&bn.overflowScroll,"wrap"===t&&bn.overflowWrap)}var wn=s(950485);const Cn=(0,n.forwardRef)(((e,t)=>{const s=n.useContext(pn),i=(0,n.useContext)(hn.CustomBehaviourContext),{id:o,active:a,fake:l,theme:c=wn,enableActiveStateStyles:u=i.enableActiveStateStyles,hideFocusOutline:d=!1,endSlot:h,startSlot:p,children:m,isVertical:g,disabled:_,highlighted:b,endUpperSlot:f,iconOnlyOnAdaptive:v,overflowAdaptive:w,...C}=e,y=e=>n.createElement(fn,{"aria-hidden":e,endSlot:h,startSlot:p,endUpperSlot:f,className:e?wn.tabHiddenContent:wn.tabContent,isVertical:g,disabled:_,iconOnlyOnAdaptive:v,overflowAdaptive:w,size:s},m);return n.createElement("button",{...C,id:o,ref:t,className:r(c.squareTabButton,a&&c.selected,c[s],l&&c.fake,!u&&c.disableActiveStateStyles,d&&c.disableFocusOutline,g&&c.verticalButton,_&&c.disabled)},y(!1),y(!0))}));Cn.displayName="SquareTabButton";const yn=(0,n.forwardRef)(((e,t)=>{const{item:s,handleItemRef:i,onClick:o,...r}=e,a=(0,n.useCallback)((()=>{o&&o(s)}),[o,s]),l=(0,n.useCallback)((e=>{i&&i(s,e),(0,ss.isomorphicRef)(t)(e)}),[s,i,t]);return n.createElement(Cn,{...r,id:s.id,onClick:a,ref:l,endSlot:s.endSlot,startSlot:s.startSlot,endUpperSlot:s.endUpperSlot,"aria-label":"radio"===r.role?s.label:void 0},s.label)}));yn.displayName="SquareTab";var Sn=s(525388),En=s(904925),xn=s(192063),Fn=s(602948),Tn=s(57173);function Pn(e){const{isDropped:t=!1}=e;return n.createElement(vt.Icon,{icon:Fn,className:r(Tn.arrowIcon,t&&Tn.dropped)})}function kn(e){const{disabled:t,isOpened:s,hideFocusOutline:i,fake:o,items:r,buttonContent:a,buttonRef:l,buttonTheme:c,isHighlighted:u,onButtonClick:d,onItemClick:h,onClose:p}=e,m=(0,n.useRef)(null),g=(0,Sn.useMergedRefs)([l,m]);return n.createElement(En.PopupMenuDisclosureView,{buttonRef:m,listboxTabIndex:-1,isOpened:s,onClose:p,listboxAria:{"aria-hidden":!0},button:n.createElement(Cn,{"aria-hidden":!0,disabled:t,active:s,onClick:d,ref:g,tabIndex:-1,theme:c,hideFocusOutline:i,fake:o},a,n.createElement(Pn,{isDropped:s})),popupChildren:r.map((e=>n.createElement(xn.PopupMenuItem,{key:e.id,onClick:h,onClickArg:e,isActive:u(e),label:e.label,isDisabled:e.disabled||t,startSlot:e.startSlot,toolbox:e.endUpperSlot?n.createElement("span",{className:c.endSlotInDisclosure},e.endUpperSlot):e.endSlot,dontClosePopup:!0})))})}const In=(0,s(493173).mergeThemes)(wn,bn);var Dn=s(153666);function Rn(e){const{disabled:t,moreButtonContent:o=()=>i.t(null,void 0,s(437117)),size:a="small",theme:l=In,className:c,style:u,"data-name":d,"aria-controls":h,isRadioGroup:p}=e,m=parseInt(Dn[`css-value-square-tabs-${a}-gap`]),{enableActiveStateStyles:g,moreButtonRef:_,setItemRef:b,getBindings:f,handleMoreButtonClick:v,handleCollapsedItemClick:w,scrollWrapBinding:C,overflowBehaviour:y,tablistBinding:S,visibleTabs:E,hiddenTabs:x,handleActivate:F,isMobileTouch:T,getItemId:P,isDisclosureOpened:k,isHighlighted:I,closeDisclosure:D}=(0,dn.useTabsMainHandlers)(un.TabNames.SquareButtonTabs,e,{isRtl:L.isRtl,scrollIntoViewOptions:{additionalScroll:m},isRadioGroup:p,gap:m})
;return n.createElement(pn.Provider,{value:a},n.createElement("div",{...C,className:r(vn({overflowBehaviour:y}),c),style:{...u,"--ui-lib-private-squareTabs-gap":`${m}px`},"data-name":d},n.createElement("div",{...S,className:r(l.squareTabs,l[a])},E.map((e=>n.createElement(yn,{...f(e)??{},key:e.id,item:e,onClick:()=>F(e),theme:l,enableActiveStateStyles:g,hideFocusOutline:T,ref:b(P(e)),...e.dataId&&{"data-id":e.dataId},"aria-controls":h}))),x.map((e=>n.createElement(yn,{...f(e)??{},key:e.id,item:e,theme:l,enableActiveStateStyles:g,fake:!0,"aria-controls":h}))),n.createElement(kn,{disabled:t,isOpened:k,items:x,buttonContent:o({hiddenTabs:x}),buttonRef:_,buttonTheme:l,isHighlighted:I,onButtonClick:v,onItemClick:w,onClose:D,hideFocusOutline:T,fake:0===x.length}))))}function Mn(e){const{"data-name":t="square-tabs-buttons",...s}=e;return n.createElement(Rn,{...s,"data-name":t})}function An(e){const{id:t,items:s,onActivate:i,defaultActiveFilterTabId:o}=e,[r,a]=(0,n.useState)(o??(0,l.ensureDefined)(s[0]?.id,"AccountManagerPageFilterTabs item"));return(0,n.useEffect)((()=>{i({id:r})}),[r,i]),n.createElement(Mn,{id:(0,sn.createDomId)("account-manager-page-filter-tabs",t),className:rn,onActivate:e=>a(e.id),isActive:e=>e.id===r,size:"xsmall",overflowBehaviour:"scroll",items:s.map((e=>({id:e.id,label:n.createElement(an,{...e,isActive:e.id===r})})))})}class Un extends E{constructor(e,t,s){super(e,t,s),s.forEach((e=>e.addFormatters(t.formatters.concat(Ye))))}}class On extends Un{constructor(e){const t=it(),s="id",i=new at({options:{idProperty:s,defaultSortingParameters:e.initialSorting},priceFormatterGetter:e.priceFormatterFn,columns:e.columns}),n=new ei({id:e.id,title:e.title,model:i,container:t,columns:e.columns,idProperty:s,overlapManager:e.overlapManager,getSettingsStorage:e.getTableSettingsStorage,rowEventsHandlers:e.tableRowEventsHandlers,trackEvent:e.trackEvent,fixedTitleColumnId:e.fixedTitleColumnId,pageSize:void 0===e.overlapManager?100:20}),o=new(e.tableController??C)({idProperty:s,model:i,view:n,source:e.source,subscriptions:e.subscriptions});super(t,{id:e.id,name:e.title,formatters:e.formatters},[o]),this._tableViewModel=i,this._tableView=n,o.start()}destroy(){this._tableViewModel.destroy(),this._tableView.destroy(),super.destroy()}}const Nn={1:ye.red,0:ye.green};function Bn(e){const{text:t,notificationType:s}=e,i=void 0!==s?Nn[s]:void 0;return n.createElement("span",{className:i},t)}const Vn="notificationType",Ln={name:Vn,formatText:Xe.formatText,formatElement:({values:[e,t]})=>n.createElement(Bn,{text:e,notificationType:t})},Wn="notificationSymbol",Hn={name:Wn,formatElement:({values:[e,t]})=>e&&t?n.createElement(Ce,{brokerSymbol:e,symbol:t}):n.createElement(n.Fragment,null),formatText:({values:[e]})=>e?(0,p.getSymbolNameOverFullname)(e):""},zn=[{label:i.t(null,void 0,s(595481)),formatter:Wn,showLabelOnMobile:!1,id:"symbol",dataFields:["displaySymbol","symbol"]},{label:i.t(null,void 0,s(312806)),id:"time",dataFields:["time"],formatter:"localDate"},{label:i.t(null,void 0,s(570198)),id:"title",dataFields:["title","type"],
formatter:Vn,isCapitalize:!1},{label:i.t(null,void 0,s(770320)),id:"text",dataFields:["text"],isCapitalize:!1}];class qn extends On{constructor(e){super({...e,tableController:wi,columns:zn,formatters:[Ln,Hn]})}contextRow(e){return this._tableControllers[0].rowAtEvent(e)}}var Kn=s(685014),Gn=s(634369),jn=s(785948);const $n=[6,3,2,1,5],Qn=[2,1,5],Zn="data-account-manager-page-id";function Jn(e){return`[${Zn}="${e}"]`}class Yn{constructor(e){this._showContextMenu=async e=>{e.preventDefault();let t=await this._contextItems(e);void 0!==t&&(h.enabled("property_pages")||(t=t.slice(0,-1)),m.ContextMenuManager.showMenu((0,p.convertActionDescriptionsToActions)(t),function(e){const t=e instanceof MouseEvent?e:e.touches[0];return{clientX:t.clientX,clientY:t.clientY}}(e),void 0,{menuName:"AccountManagerContextMenu"}))},this._activateTab=({id:e})=>{if(e===this._currentTabId)return;if(void 0!==this._currentTabId){const e=this._container.querySelector(Jn(this._currentTabId));e?.classList.remove(jn.active)}(0,l.ensureNotNull)(this._container.querySelector(Jn(e)),"Page to activate").classList.add(jn.active),this._currentTabId=e,this._attachFilter(),this._trading.trackEvent("Bottom Panel",`Select ${e} page`),this._updatePagesActiveStatuses()};const{broker:t,bridge:s,mode:i,summaryFieldsVisibilityManager:n,overlapManager:o}=e;this._adapter=(0,l.ensureNotNull)(t),this._bridge=s,this._container=s.container,this._mode=i,this._overlapManager=o,this._summaryFieldsVisibilityManager=n,this._pages=[],this._trading=(0,l.ensureNotNull)((0,_.tradingService)()),this._info=this._adapter.accountManagerInfo(),this._dispatch=this.bindContextMenu(),this._renderTemplate()}async priceFormatter(e){return e.symbol?this._trading.formatter(e.symbol):null}remove(){for(this._unmountComponentBySelector(".js-account-manager-header"),this._unmountComponentBySelector(".js-top-panel"),this._unmountComponentBySelector(".js-secondary-panel"),this._unsubscribe(),this._pages.forEach((e=>e.destroy())),this.unbindContextMenu();this._container.firstChild;)this._container.removeChild(this._container.firstChild)}bindContextMenu(){return u.CheckMobile.isIPad()?this._bindLongPressMenu():0===this._mode?this._bindTapMenu():this._bindContextMenu()}unbindContextMenu(){null!==this._dispatch&&(this._dispatch(),this._dispatch=null)}static async create(e){const t=new Yn(e);return await t._create(),t._subscribe(),t._fullUpdate(),t}_bindContextMenu(){return this._container.addEventListener("contextmenu",this._showContextMenu),()=>this._container.removeEventListener("contextmenu",this._showContextMenu)}_bindLongPressMenu(){let e;const t=t=>{clearTimeout(e),e=setTimeout((()=>this._showContextMenu(t)),400)},s=()=>clearTimeout(e);return this._container.addEventListener("touchstart",t),this._container.addEventListener("touchend",s),this._container.addEventListener("touchmove",s),()=>{clearTimeout(e),this._container.removeEventListener("touchstart",t),this._container.removeEventListener("touchend",s),this._container.removeEventListener("touchmove",s)}}_bindTapMenu(){const e=e=>{
void 0!==this._currentPage().contextRow(e)&&this._showContextMenu(e)},t=e=>{e.preventDefault()};return this._container.addEventListener("click",e),this._container.addEventListener("contextmenu",t),()=>{this._container.removeEventListener("click",e),this._container.removeEventListener("contextmenu",t)}}_unmountComponentBySelector(e){const t=this._container.querySelector(e);null!==t&&o.unmountComponentAtNode(t)}_ensuredCurrentTabId(){return(0,l.ensureDefined)(this._currentTabId,"Current tab id")}_initializeTabs(){this._activateTab({id:this._pages[0].id()}),o.render(n.createElement(ln,{pages:this._pages,defaultActiveTabId:this._ensuredCurrentTabId(),onActivate:this._activateTab}),(0,l.ensureNotNull)(this._container.querySelector(".js-top-panel"),"AccountManagerTabs container"))}_linkTableRowSymbol(e){0!==this._mode&&void 0!==e.symbol&&""!==e.symbol&&c.linking.setSymbolAndLogInitiator(e.symbol,"account manager")}_onTableRowClick(e,t,s){const i=e;0!==this._mode&&""!==i.symbol&&void 0!==i.symbol&&(c.linking.proSymbol.value()!==i.symbol?c.linking.setSymbolAndLogInitiator(i.symbol,"account manager"):t.setSelectedItem({id:i.id,type:s}))}_onTableRowMouseEnter(e,t,s){const i=e;0!==this._mode&&c.linking.proSymbol.value()===i.symbol&&t.setHoveredItem({id:i.id,type:s})}_onTableRowMouseLeave(e,t){const s=e;0!==this._mode&&c.linking.proSymbol.value()===s.symbol&&t.dropHoveredItem()}_makeTableRowEventsHandlers(e,t){return{onClick:s=>this._onTableRowClick(s,e,t),onMouseEnter:s=>this._onTableRowMouseEnter(s,e,t),onMouseLeave:t=>this._onTableRowMouseLeave(t,e)}}async _getPages(){const e=this._adapter.metainfo().id,t=this._adapter.accountManagerInfo(),o=this._adapter.metainfo().configFlags,r=this._getPagesAvailabilityInfo(),a=(0,l.ensureNotNull)(this._trading.brokerCommandsUI()),c={},u=await this._trading.tradedItemsChartCollectionFacade(),d=void 0!==t.customFormatters?t.customFormatters.map((({name:e,formatText:t,formatElement:s,isPriceFormatterNeeded:i})=>void 0===s?{name:e,formatText:t}:{name:e,formatText:t,formatElement:e=>{const t=s(e);return t instanceof window.parent.Element?n.createElement(tn,{element:t}):t},isPriceFormatterNeeded:i})):[];if(r.positions){const s=this._makeTableRowEventsHandlers(u,en.TradedItemType.Position),i=async e=>{const t=await this._adapter.getSymbolSpecificTradingOptions(e);return Boolean(t?.supportReversePosition)};c.positionPage={ctor:zi,ctorArguments:{brokerId:e,formatters:d,tableRowEventsHandlers:s,priceFormatterFn:this.priceFormatter.bind(this),checkSupportIndividualPositions:()=>!0===o.supportPositionNetting,checkPositionReverseSupport:i,positions:{source:()=>this._adapter.positions().then((e=>e.filter((e=>v(e))))),closeFn:a.closePosition.bind(a),editFn:o.supportPositionBrackets?a.editPositionBrackets.bind(a):null,reverseFn:o.supportReversePosition?a.reversePosition.bind(a):null,columns:(0,l.ensureDefined)(t.positionColumns),subscriptions:{rowUpdateDelegate:new g([this._adapter.positionPartialUpdate,this._adapter.positionUpdate]),countUpdateDelegate:this._adapter.positionUpdate,
plSubscription:this._adapter.subscribePL.bind(this._adapter)}},individualPositions:o.supportPositionNetting?{source:()=>this._adapter.individualPositions().then((e=>e.filter((e=>0!==e.qty)))),closeFn:o.supportCloseIndividualPosition?a.closeIndividualPosition.bind(a):null,editFn:o.supportIndividualPositionBrackets?(0,l.ensureDefined)(a.editIndividualPositionBrackets).bind(a):null,reverseFn:null,columns:(0,l.ensureDefined)(t.individualPositionColumns||t.positionColumns),subscriptions:{rowUpdateDelegate:new g([this._adapter.individualPositionPartialUpdate,this._adapter.individualPositionUpdate]),countUpdateDelegate:this._adapter.individualPositionUpdate,plSubscription:this._adapter.subscribePL.bind(this._adapter)}}:null,fullUpdateDelegate:new g([this._adapter.currentAccountUpdate,this._adapter.positionsFullUpdate,this._adapter.individualPositionsFullUpdate]),overlapManager:this._overlapManager,getTableSettingsStorage:this._trading.getBrokerTradingSettingsStorage,trackEvent:this._trading.trackEvent,configFlags:o,customEmptyStateGetter:t.customEmptyStateGetter}}}const h=this._adapter.orders.bind(this._adapter),p=this._makeTableRowEventsHandlers(u,en.TradedItemType.Order);c.orderPage={ctor:Fi,ctorArguments:{id:"orders",title:i.t(null,void 0,s(652280)),source:h,cancelFn:a.cancelOrder.bind(a),modifyFn:a.modifyOrder.bind(a),columns:t.orderColumns,tableId:e+".orders",tableRowEventsHandlers:p,formatters:d,priceFormatterFn:this.priceFormatter.bind(this),subscriptions:{fullUpdateDelegate:new g([this._adapter.currentAccountUpdate,this._adapter.ordersFullUpdate]),rowUpdateDelegate:new g([this._adapter.orderPartialUpdate,this._adapter.orderUpdate]),orderUpdateDelegate:this._adapter.orderUpdate},possibleOrderStatuses:$n.filter((e=>!t.possibleOrderStatuses||-1!==t.possibleOrderStatuses.indexOf(e))),filter:()=>!0,initialSorting:t.orderColumnsSorting,configFlags:o,overlapManager:this._overlapManager,getTableSettingsStorage:this._trading.getBrokerTradingSettingsStorage,trackEvent:this._trading.trackEvent,customEmptyStateGetter:t.customEmptyStateGetter}};const m=this._adapter.ordersHistory.bind(this._adapter);return r.history&&(c.historyPage={ctor:Fi,ctorArguments:{id:"history",title:i.t(null,void 0,s(641249)),source:()=>Promise.all([h(),m()]).then((e=>[].concat(...e))),cancelFn:a.cancelOrder.bind(a),modifyFn:a.modifyOrder.bind(a),columns:(0,l.ensureDefined)(t.historyColumns),tableId:e+".history",tableRowEventsHandlers:p,formatters:d,priceFormatterFn:this.priceFormatter.bind(this),subscriptions:{fullUpdateDelegate:this._adapter.currentAccountUpdate,rowUpdateDelegate:new g([this._adapter.orderPartialUpdate,this._adapter.orderUpdate]),orderUpdateDelegate:this._adapter.orderUpdate},possibleOrderStatuses:Qn.filter((e=>!t.possibleOrderStatuses||-1!==t.possibleOrderStatuses.indexOf(e))),filter:e=>![3,4,6].includes(e.status),initialSorting:t.historyColumnsSorting,isAlwaysActive:!0,configFlags:o,overlapManager:this._overlapManager,getTableSettingsStorage:this._trading.getBrokerTradingSettingsStorage,trackEvent:this._trading.trackEvent,
customEmptyStateGetter:t.customEmptyStateGetter}}),c.customPages=t.pages.map((s=>{const i=s.tables.map((t=>({id:`${e}.${s.id}.${t.id}`,title:t.title||"",columns:t.columns,source:t.getData,options:{className:"balances",idProperty:"id",defaultSortingParameters:t.initialSorting},formatters:d,priceFormatterFn:this.priceFormatter.bind(this),subscriptions:{fullUpdateDelegate:this._adapter.currentAccountUpdate,rowUpdateDelegate:t.changeDelegate,rowDeleteDelegate:t.deleteDelegate},flags:t.flags,rowEventsHandlers:t.flags?.supportLinking?{onClick:this._linkTableRowSymbol}:void 0})));return{ctor:si,ctorArguments:{id:s.id,title:s.title,tables:i,displayMode:this._mode,overlapManager:this._overlapManager,getTableSettingsStorage:this._trading.getBrokerTradingSettingsStorage,trackEvent:this._trading.trackEvent,displayCounterInTab:s.displayCounterInTab,customEmptyStateGetter:t.customEmptyStateGetter}}})),r.notifications&&(c.notificationsPage={ctor:qn,ctorArguments:{id:"notifications-log",title:i.t(null,void 0,s(371250)),source:()=>Promise.resolve(this._trading.getNotifications()),tableRowEventsHandlers:this._makeTableRowEventsHandlers(u,en.TradedItemType.Order),priceFormatterFn:this.priceFormatter.bind(this),subscriptions:{fullUpdateDelegate:this._trading.onNotificationsChanged,rowUpdateDelegate:this._trading.onNewNotification},overlapManager:this._overlapManager,initialSorting:{property:"time",asc:!1},getTableSettingsStorage:this._trading.getBrokerTradingSettingsStorage,trackEvent:this._trading.trackEvent}}),c}_getPagesAvailabilityInfo(){const e=this._adapter.metainfo().configFlags;return{positions:Boolean(e.supportPositions),orders:!0,history:Boolean(e.supportOrdersHistory),tradeHistory:Boolean(e.supportTradeHistoryTabInAccountManager),notifications:Boolean(h.enabled("show_trading_notifications_history")&&e.showNotificationsLog)}}_renderTemplate(){const e=this._getPagesAvailabilityInfo(),t=Object.values(e).filter((e=>e)).length+this._adapter.accountManagerInfo().pages.length,n=(0,l.ensureNotNull)((0,b.parseHtmlElement)(((e=0,t)=>`<div class="${a()(jn.accountManager,0===t&&jn.popup)}" aria-label="${i.t(null,void 0,s(219486))}">\n\t\t\t\t<div class="js-account-manager-header"></div>\n\t\t\t\t<div class="${jn.topPanel} js-top-panel"></div>\n\t\t\t\t<div class="${jn.secondaryPanel} js-secondary-panel"></div>\n\t\t\t\t<div class="${jn.content}">\n\t\t\t\t\t${`<div class="${a()(jn.page,(0,d.isOnMobileAppPage)("any")&&jn.mobile)} js-page"></div>`.repeat(e)}\n\t\t\t\t</div>\n\t\t\t</div>`)(t,this._mode)));this._container.appendChild(n)}async _create(){const e=await this._getPages();for(const t of Object.values(e))if(Array.isArray(t)){const e=t.map((e=>new e.ctor(e.ctorArguments)));this._pages.push(...e)}else this._pages.push(new t.ctor(t.ctorArguments));const t=this._container.querySelectorAll(".js-page");this._pages.forEach(((e,s)=>{t[s].innerHTML="",t[s].appendChild(e.content()),t[s].setAttribute(Zn,e.id())})),this._initializeTabs(),this._render()}async _render(){let e;1===this._mode&&(e=await(0,
Xi.makeAccountManagerHeaderDropdownsProps)(this._trading,this._summaryFieldsVisibilityManager,1,(()=>this._getDataExporters()))),o.render(n.createElement(Yi,{...e,summaryFields:this._info.summary,summaryFieldsVisibilityManager:this._summaryFieldsVisibilityManager,isBetaBroker:this._adapter.metainfo().isBeta,displayMode:this._mode}),this._container.querySelector(".js-account-manager-header"))}_getDataExporters(){const e=new Map;for(const t of this._pages){const s=t.getExporters();e.set(s.title,s)}return e}_subscribe(){const e=e=>{e?this._updatePagesActiveStatuses():this._pages.forEach((e=>e.setActive(!1)))};this._bridge.visible.subscribe(e,{callWithLast:!0}),this._dispatchVisibilityHandler=()=>this._bridge.visible.unsubscribe(e)}_updatePagesActiveStatuses(){const e=this._currentPage().id();for(const t of this._pages)t.setActive(1===this._adapter.connectionStatus()&&t.id()===e)}_attachFilter(){const e=this._currentPage(),t=e.filterTabs(),s=(0,l.ensureNotNull)(this._container.querySelector(".js-secondary-panel"),"Filter container");0===t.length?o.unmountComponentAtNode(s):o.render(n.createElement(An,{key:e.id(),id:e.id(),onActivate:({id:t})=>e.activateFilterTab(t),defaultActiveFilterTabId:e.activeFilterTabId(),items:t}),s)}_fullUpdate(){this._pages.forEach((e=>e.reset()))}_unsubscribe(){this._dispatchVisibilityHandler&&(this._dispatchVisibilityHandler(),delete this._dispatchVisibilityHandler)}_currentPage(){const e=this._ensuredCurrentTabId();return(0,l.ensureDefined)(this._pages.find((t=>t.id()===e)),"Current page")}async _contextItems(e){const t=this._currentPage().contextRow(e);if(void 0===t)return;const n="Bottom Panel Context Menu",o=await this._currentPage().contextItems(e);if(this._info&&this._info.contextMenuActions)return this._info.contextMenuActions(e,o);const r={separator:!0},a=[],l=t.symbol;if(l)if(1===this._mode){0!==o.length&&a.push(r);const e=await this._trading.makeNewOrderContextMenuAction(l,n);a.push(e)}else 0!==o.length&&a.push(r),a.push({text:i.t(null,void 0,s(469435)).replace("{symbol}",l),icon:Kn,action:()=>{this._trading.trackEvent(n,"Open chart"),c.linking.setSymbolAndLogInitiator(l,"account manager"),this._trading.tradingPanelPopup.hide()}});else;return h.enabled("property_pages")&&(0!==o.length&&a.push(r),a.push({text:(0,f.appendEllipsis)(i.t(null,void 0,s(855527))),icon:Gn,action:()=>{this._trading.trackEvent(n,"Trading Properties"),this._trading.showTradingProperties()}})),o.concat(a)}}},578758:(e,t,s)=>{"use strict";s.d(t,{useSymbolLogoAndDescription:()=>o});s(868333);var i=s(50959),n=s(333250);function o(e){{let t=[];const s=function(e,t=!0){const[s,o]=(0,i.useState)(null===e?{completed:!0,invalid:!0,quotes:null,symbol:e}:{completed:!1,invalid:!1,quotes:null,symbol:e});return(0,i.useEffect)((()=>{if(null===e)return void o({completed:!0,invalid:!0,quotes:null,symbol:e});o({completed:!1,invalid:!1,quotes:null,symbol:e});const s=(0,n.getQuoteSessionInstance)("full"),i=()=>{s.unsubscribe("useSymbolQuotes",e,r)},r=s=>{const{values:n,complete:r,status:a}=s;o({invalid:"error"===a,quotes:{...n},
completed:void 0!==r||"error"===a,symbol:e}),void 0===r&&"error"!==a||t&&i()};return s.subscribe("useSymbolQuotes",e,r),()=>{i()}}),[e]),s}(e,!1),o=s.quotes;return o&&(o.logoid?t=[o.logoid]:o["currency-logoid"]&&o["base-currency-logoid"]&&(t=[o["base-currency-logoid"],o["currency-logoid"]])),{logoUrls:t,description:o?.description}}}},171812:(e,t,s)=>{"use strict";var i;s.d(t,{TradedItemType:()=>i}),function(e){e[e.Position=0]="Position",e[e.Order=1]="Order"}(i||(i={}))},935495:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18" fill="none"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="m4 4h-2v10h2zm-2-1c-.55228 0-1 .44772-1 1v10c0 .5523.44772 1 1 1h2c.55228 0 1-.4477 1-1v-10c0-.55228-.44772-1-1-1zm8 1h-2v10h2zm-2-1c-.55228 0-1 .44772-1 1v10c0 .5523.44772 1 1 1h2c.5523 0 1-.4477 1-1v-10c0-.55228-.4477-1-1-1zm6 1h2v10h-2zm-1 0c0-.55228.4477-1 1-1h2c.5523 0 1 .44772 1 1v10c0 .5523-.4477 1-1 1h-2c-.5523 0-1-.4477-1-1z"/></svg>'},552019:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="M13.35 5.35a.5.5 0 0 0-.7-.7L9 8.29 5.35 4.65a.5.5 0 1 0-.7.7L8.29 9l-3.64 3.65a.5.5 0 0 0 .7.7L9 9.71l3.65 3.64a.5.5 0 0 0 .7-.7L9.71 9l3.64-3.65z"/></svg>'},290556:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="m3.83 8.51.28.34 3.5 4 .76-.66L5.6 9.02H14v-1H5.6l2.78-3.17-.76-.66-3.5 4-.28.33Z"/></svg>'},281670:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18" width="18" height="18"><path fill="currentColor" d="m14.16 8.5-.28.34-3.5 4-.76-.66L12.4 9H4V8h8.4L9.62 4.84l.76-.66 3.5 4 .28.33Z"/></svg>'},317140:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="m16.47 7.47 1.06 1.06L12.06 14l5.47 5.47-1.06 1.06L9.94 14l6.53-6.53Z"/></svg>'},685014:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" fill-rule="evenodd" d="M8 5.5h12A2.5 2.5 0 0 1 22.5 8v12a2.5 2.5 0 0 1-2.5 2.5H8A2.5 2.5 0 0 1 5.5 20V8A2.5 2.5 0 0 1 8 5.5zM4 8a4 4 0 0 1 4-4h12a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4H8a4 4 0 0 1-4-4V8zm15.49 5.07a.75.75 0 1 0-.98-1.14l-2.97 2.55-2.51-2.51a.75.75 0 0 0-1.02-.04l-3.5 3a.75.75 0 1 0 .98 1.14l2.97-2.55 2.51 2.51c.28.28.72.3 1.02.04l3.5-3z"/></svg>'},87523:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="M11.42 7.52 6.02 14l5.4 6.48 1.16-.96-3.98-4.77H21v-1.5H8.6l3.98-4.77-1.16-.96Z"/></svg>'},505357:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28"><path fill="currentColor" d="m16.58 7.52 5.4 6.48-5.4 6.48-1.16-.96 3.98-4.77H7v-1.5h12.4l-3.98-4.77 1.16-.96Z"/></svg>'},465890:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 9" width="11" height="9" fill="none"><path stroke="currentColor" stroke-width="2" d="M0.999878 4L3.99988 7L9.99988 1"/></svg>'}}]);